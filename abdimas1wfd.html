<div class="container">
  <h2>Daftar Penerima Sertifikat World Pharmacists Day 2025</h2>
  <input id="searchInput" type="text" />

  <table id="dataTable">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama Lengkap</th>
        <th>Tempat Kerja</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<style>
.container{max-width:1150px;margin:auto;font-family:Arial}
input{width:100%;padding:10px;margin-bottom:15px}
table{width:100%;border-collapse:collapse}
th,td{border:1px solid #ddd;padding:10px;text-align:left}
th{background:#f2f2f2}
mark{background:#ffe066;padding:2px 4px;border-radius:3px}
a{margin-right:10px;font-weight:bold;color:#1e88e5;text-decoration:none}
</style>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxct_VNCMqblIKe7KGAdjNnua3d6BcgE24ZdOKlzJrS7wl8xJIdMCRmlNFiKWlGjZC0/exec";
const tbody = document.querySelector("#dataTable tbody");
let dataGlobal = [];

fetch(API_URL)
  .then(r => r.json())
  .then(data => {
    dataGlobal = data;
    render(data);
  });

function render(data){
  tbody.innerHTML = "";
  data.forEach((d,i) => {
    tbody.innerHTML += `
      <tr data-nama="${d.nama.toLowerCase()}">
        <td>${i+1}</td>
        <td class="nama">${d.nama}</td>
        <td>${d.tempat}</td>
        <td>
          <a href="${d.preview}" target="_blank">Preview</a>
          <a href="${d.download}" target="_blank">Download</a>
        </td>
      </tr>`;
  });
}

document.getElementById("searchInput").addEventListener("keyup", function(){
  const q = this.value.toLowerCase();
  document.querySelectorAll("#dataTable tbody tr").forEach(tr => {
    const namaCell = tr.querySelector(".nama");
    const text = namaCell.textContent.toLowerCase();

    if(text.includes(q)){
      tr.style.display = "";
      namaCell.innerHTML = namaCell.textContent.replace(
        new RegExp(`(${q})`,"gi"),"<mark>$1</mark>"
      );
    } else {
      tr.style.display = "none";
    }
  });
});
</script>
