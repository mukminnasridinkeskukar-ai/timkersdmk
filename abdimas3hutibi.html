<div class="container">
  <h2>Daftar Penerima Sertifikat Pelayanan KB Serentak HUT IBI Tahun 2025</h2>

  <div class="search-box">
    <input id="searchInput" type="text" placeholder="Cari nama penerima..." />
    <button id="searchBtn">üîç Cari</button>
  </div>

  <table id="dataTable">
    <thead>
      <tr>
        <th>No</th>
        <th>Nama Lengkap</th>
        <th>Tempat Kerja</th>
        <th>Aksi</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<style>
/* === CONTAINER === */
.container{
  max-width:1150px;
  margin:auto;
  font-family:Arial, Helvetica, sans-serif;
}

/* === JUDUL === */
h2{
  margin-bottom:15px;
  border-left:5px solid #0d6efd;
  padding-left:10px;
}

/* === SEARCH BOX === */
.search-box{
  display:flex;
  gap:8px;
  align-items:center;
  margin-bottom:15px;
}

.search-box input{
  width:260px;
  padding:8px 12px;
  border:1px solid #ccc;
  border-radius:6px;
  font-size:14px;
}

.search-box button{
  padding:8px 16px;
  background:#0d6efd;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer;
  font-weight:bold;
}

.search-box button:hover{
  background:#0b5ed7;
}

/* === TABLE === */
table{
  width:100%;
  border-collapse:collapse;
}

th,td{
  border:1px solid #ddd;
  padding:10px;
  text-align:left;
}

th{
  background:#f2f2f2;
}

/* === LINK === */
a{
  margin-right:10px;
  font-weight:bold;
  color:#1e88e5;
  text-decoration:none;
}

a:hover{
  text-decoration:underline;
}

/* === HIGHLIGHT === */
mark{
  background:#ffe066;
  padding:2px 4px;
  border-radius:3px;
}

/* === RESPONSIVE === */
@media(max-width:600px){
  .search-box{
    flex-direction:column;
    align-items:flex-start;
  }

  .search-box input{
    width:100%;
  }
}
</style>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwcJqWsy9olgysC7D_iQv_PXjRoDmYY4eWvGsovpaVbzScSU1SxKV8-FFqB9_aRELjt/exec";
const tbody = document.querySelector("#dataTable tbody");
const input = document.getElementById("searchInput");
const btn = document.getElementById("searchBtn");

let dataGlobal = [];

fetch(API_URL)
  .then(r => r.json())
  .then(data => {
    dataGlobal = data;
    render(data);
  });

function render(data){
  tbody.innerHTML = "";
  data.forEach((d,i) => {
    tbody.innerHTML += `
      <tr>
        <td>${i+1}</td>
        <td class="nama">${d.nama}</td>
        <td>${d.tempat}</td>
        <td>
          <a href="${d.preview}" target="_blank">Preview</a>
          <a href="${d.download}" target="_blank">Download</a>
        </td>
      </tr>`;
  });
}

function doSearch(){
  const q = input.value.toLowerCase();
  document.querySelectorAll("#dataTable tbody tr").forEach(tr => {
    const namaCell = tr.querySelector(".nama");
    const text = namaCell.textContent.toLowerCase();

    if(text.includes(q)){
      tr.style.display = "";
      namaCell.innerHTML = namaCell.textContent.replace(
        new RegExp(`(${q})`,"gi"), "<mark>$1</mark>"
      );
    } else {
      tr.style.display = "none";
    }
  });
}

input.addEventListener("keyup", doSearch);
btn.addEventListener("click", doSearch);
</script>
