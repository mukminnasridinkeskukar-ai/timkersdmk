<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIPANDAI-ASN | Sistem Pengembangan Mutu dan Peningkatan Kompetensi ASN Kesehatan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #0066cc;
            --secondary-color: #004d99;
            --accent-color: #00a651;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --light-bg: #f8f9fa;
            --dark-text: #212529;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
        }
        
        .header-top {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 15px 0;
        }
        
        .logo-section {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .logo-section img {
            width: 70px;
            height: 70px;
        }
        
        .logo-section h1 {
            font-size: 1.5rem;
            margin: 0;
            font-weight: 700;
        }
        
        .logo-section p {
            font-size: 0.85rem;
            margin: 0;
            opacity: 0.9;
        }
        
        .nav-menu {
            background-color: var(--secondary-color);
            padding: 0;
        }
        
        .nav-menu .navbar {
            padding: 0;
        }
        
        .nav-menu .nav-link {
            color: white !important;
            padding: 15px 20px !important;
            font-weight: 500;
            transition: all 0.3s ease;
            border-bottom: 3px solid transparent;
        }
        
        .nav-menu .nav-link:hover, .nav-menu .nav-link.active {
            background-color: rgba(255,255,255,0.1);
            border-bottom-color: var(--warning-color);
        }
        
        .hero-section {
            background: linear-gradient(135deg, #0066cc, #00a651);
            color: white;
            padding: 60px 0;
            text-align: center;
        }
        
        .hero-section h2 {
            font-size: 2.5rem;
            margin-bottom: 20px;
            font-weight: 700;
        }
        
        .hero-section p {
            font-size: 1.2rem;
            opacity: 0.9;
            max-width: 800px;
            margin: 0 auto 30px;
        }
        
        .btn-custom {
            padding: 12px 30px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-primary-custom {
            background-color: white;
            color: var(--primary-color);
            border: 2px solid white;
        }
        
        .btn-primary-custom:hover {
            background-color: transparent;
            color: white;
        }
        
        .btn-admin {
            background-color: var(--warning-color);
            color: var(--dark-text);
        }
        
        .btn-admin:hover {
            background-color: #e0a800;
            color: var(--dark-text);
        }
        
        .stat-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card i {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .stat-card h3 {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
        }
        
        .stat-card p {
            color: #666;
            margin: 10px 0 0;
        }
        
        .section-title {
            text-align: center;
            margin-bottom: 50px;
        }
        
        .section-title h2 {
            font-size: 2rem;
            font-weight: 700;
            color: var(--dark-text);
            margin-bottom: 15px;
        }
        
        .section-title p {
            color: #666;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .activity-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .activity-card:hover {
            transform: translateY(-5px);
        }
        
        .activity-card .card-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            font-weight: 600;
        }
        
        .activity-card .card-body {
            padding: 20px;
        }
        
        .activity-card .card-body i {
            color: var(--primary-color);
            margin-right: 10px;
        }
        
        .activity-card .card-body p {
            margin: 10px 0;
            color: #555;
        }
        
        .activity-card .status {
            display: inline-block;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }
        
        .status-active {
            background-color: #d4edda;
            color: #155724;
        }
        
        .status-upcoming {
            background-color: #fff3cd;
            color: #856404;
        }
        
        .status-completed {
            background-color: #f8d7da;
            color: #721c24;
        }
        
        .download-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .download-card:hover {
            transform: translateY(-3px);
        }
        
        .download-icon {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            border-radius: 15px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }
        
        .download-info h5 {
            margin: 0 0 5px;
            color: var(--dark-text);
        }
        
        .download-info p {
            color: #666;
            margin: 0;
            font-size: 0.9rem;
        }
        
        .btn-download {
            background: linear-gradient(135deg, var(--primary-color), var(--accent-color));
            color: white;
            border: none;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .btn-download:hover {
            color: white;
            opacity: 0.9;
            transform: scale(1.05);
        }
        
        .contact-form {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
        }
        
        .footer {
            background: linear-gradient(135deg, var(--secondary-color), var(--dark-text));
            color: white;
            padding: 50px 0 20px;
        }
        
        .footer h5 {
            font-weight: 700;
            margin-bottom: 20px;
        }
        
        .footer p, .footer a {
            color: rgba(255,255,255,0.8);
            text-decoration: none;
        }
        
        .footer a:hover {
            color: white;
        }
        
        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,0.1);
            padding-top: 20px;
            margin-top: 30px;
        }
        
        /* Admin Section Styles */
        .admin-container {
            display: none;
        }
        
        .admin-login {
            min-height: 100vh;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .login-card {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 450px;
            width: 100%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
        }
        
        .login-card h3 {
            text-align: center;
            margin-bottom: 30px;
            color: var(--dark-text);
        }
        
        .admin-sidebar {
            background: var(--dark-text);
            min-height: 100vh;
            padding: 0;
        }
        
        .admin-sidebar .sidebar-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            padding: 30px 20px;
            text-align: center;
            color: white;
        }
        
        .admin-sidebar .nav-link {
            color: rgba(255,255,255,0.8);
            padding: 15px 20px;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        
        .admin-sidebar .nav-link:hover, .admin-sidebar .nav-link.active {
            background-color: rgba(255,255,255,0.1);
            color: white;
            border-left-color: var(--warning-color);
        }
        
        .admin-sidebar .nav-link i {
            width: 25px;
            text-align: center;
        }
        
        .admin-content {
            padding: 30px;
            background: var(--light-bg);
            min-height: 100vh;
        }
        
        .admin-header {
            background: white;
            padding: 20px 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .admin-header h3 {
            margin: 0;
            color: var(--dark-text);
        }
        
        .data-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .data-table .table {
            margin: 0;
        }
        
        .data-table .table thead {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        .data-table .table th, .data-table .table td {
            padding: 15px 20px;
        }
        
        .data-table .table tbody tr:hover {
            background-color: rgba(0,102,204,0.05);
        }
        
        .btn-action {
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }
        
        .btn-action-edit {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .btn-action-delete {
            background-color: var(--danger-color);
            color: white;
            border: none;
        }
        
        .btn-action:hover {
            opacity: 0.8;
        }
        
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }
        
        .form-control:focus, .form-select:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(0,102,204,0.25);
        }
        
        .alert-custom {
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 20px;
        }
        
        @media (max-width: 768px) {
            .hero-section h2 {
                font-size: 1.8rem;
            }
            
            .stat-card {
                margin-bottom: 20px;
            }
            
            .logo-section h1 {
                font-size: 1.2rem;
            }
        }
    </style>
</head>
<body>
    <!-- Main Website Section -->
    <div id="main-website">
        <!-- Header -->
        <header class="header-top">
            <div class="container">
                <div class="row align-items-center">
                    <div class="col-lg-8">
                        <div class="logo-section">
                            <img src="https://upload.wikimedia.org/wikipedia/commons/9/99/Logo_of_Ministry_of_Health_of_the_Republic_of_Indonesia.svg" alt="Logo Kemenkes" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect fill=%22%230066cc%22 width=%22100%22 height=%22100%22/><text x=%2250%22 y=%2255%22 text-anchor=%22middle%22 fill=%22white%22 font-size=%2240%22>K</text></svg>'">
                            <div>
                                <h1>SIPANDAI-ASN</h1>
                                <p>Sistem Pengembangan Mutu dan Peningkatan Kompetensi ASN Kesehatan</p>
                                <p>Dinas Kesehatan Kabupaten Kutai Kartanegara</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 text-end">
                        <button class="btn btn-admin btn-custom" onclick="showAdminLogin()">
                            <i class="fas fa-user-shield me-2"></i>Login Admin
                        </button>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Navigation Menu -->
        <nav class="nav-menu">
            <div class="container">
                <nav class="navbar navbar-expand-lg navbar-dark">
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                        <span class="navbar-toggler-icon"></span>
                    </button>
                    <div class="collapse navbar-collapse" id="navbarNav">
                        <ul class="navbar-nav">
                            <li class="nav-item">
                                <a class="nav-link active" href="#dashboard"><i class="fas fa-home me-2"></i>Beranda</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#jadwal"><i class="fas fa-calendar-alt me-2"></i>Jadwal Kegiatan</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#galeri"><i class="fas fa-images me-2"></i>Galeri Foto</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="downloadsertifikatsipandaiasn.html"><i class="fas fa-certificate me-2"></i>Download Sertifikat</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="#saran"><i class="fas fa-comments me-2"></i>Saran/Komplain</a>
                            </li>
                        </ul>
                    </div>
                </nav>
            </div>
        </nav>
        
        <!-- Hero Section -->
        <section class="hero-section" id="dashboard">
            <div class="container">
                <h2>Selamat Datang di SIPANDAI-ASN</h2>
                <p>Sistem Pengembangan Mutu dan Peningkatan Kompetensi ASN Kesehatan untuk mewujudkan ASN Kesehatan yang profesional, kompeten, dan berintegritas.</p>
                <button class="btn btn-primary-custom btn-custom me-3" onclick="scrollToSection('jadwal')">
                    <i class="fas fa-calendar me-2"></i>Lihat Jadwal
                </button>
                <button class="btn btn-admin btn-custom me-3" onclick="openPendaftaranUrl()">
                    <i class="fas fa-edit me-2"></i>Formulir Pendaftaran
                </button>
                <button class="btn btn-admin btn-custom" onclick="scrollToSection('galeri')">
                    <i class="fas fa-images me-2"></i>Galeri Foto
                </button>
            </div>
        </section>
        
        <!-- Dashboard Statistics -->
        <section class="py-5">
            <div class="container">
                <div class="section-title">
                    <h2>Dashboard Data</h2>
                    <p>Statistik kepesertaan dan kegiatan pengembangan kompetensi ASN Kesehatan</p>
                </div>
                <div class="row g-4">
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <i class="fas fa-users"></i>
                            <h3>12,458</h3>
                            <p>Total Peserta Terdaftar</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <h3>856</h3>
                            <p>Total Narasumber</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <i class="fas fa-calendar-check"></i>
                            <h3>342</h3>
                            <p>Kegiatan Diselenggarkan</p>
                        </div>
                    </div>
                    <div class="col-md-3 col-sm-6">
                        <div class="stat-card">
                            <i class="fas fa-certificate"></i>
                            <h3>28,765</h3>
                            <p>Sertifikat Diterbitkan</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Jadwal Kegiatan -->
        <section class="py-5 bg-light" id="jadwal">
            <div class="container">
                <div class="section-title">
                    <h2>Jadwal Kegiatan</h2>
                    <p>Jadwal kegiatan pengembangan kompetensi ASN Kesehatan periode ini</p>
                </div>
                <div class="row g-4">
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-user-md me-2"></i>Pelatihan klinis
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 15-17 Februari 2026</p>
                                <p><i class="far fa-clock"></i> 08:00 - 16:00 WIB</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang A, Gedung A</p>
                                <p><i class="fas fa-users"></i> Kuota: 50 Peserta</p>
                                <span class="status status-upcoming">Akan Datang</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-notes-medical me-2"></i>SeminAR "Mutu Layanan Kesehatan"
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 20 Februari 2026</p>
                                <p><i class="far fa-clock"></i> 09:00 - 12:00 WIB</p>
                                <p><i class="fas fa-map-marker-alt"></i> Hybrid (Zoom & Offline)</p>
                                <p><i class="fas fa-users"></i> Kuota: 200 Peserta</p>
                                <span class="status status-active">Pendaftaran Terbuka</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-laptop-medical me-2"></i>Workshop Digital Health
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 22-24 Februari 2026</p>
                                <p><i class="far fa-clock"></i> 09:00 - 15:00 WIB</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang Seminar Utama</p>
                                <p><i class="fas fa-users"></i> Kuota: 75 Peserta</p>
                                <span class="status status-upcoming">Akan Datang</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-heartbeat me-2"></i>Pelatihan Kegawatdaruratan
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 25-28 Februari 2026</p>
                                <p><i class="far fa-clock"></i> 08:00 - 17:00 WIB</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang Simulasi</p>
                                <p><i class="fas fa-users"></i> Kuota: 30 Peserta</p>
                                <span class="status status-upcoming">Akan Datang</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-clipboard-check me-2"></i>Pelatihan Audit Mutu
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 10-12 Februari 2026</p>
                                <p><i class="far fa-clock"></i> 09:00 - 16:00 WIB</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang Meeting A</p>
                                <p><i class="fas fa-users"></i> Kuota: 40 Peserta</p>
                                <span class="status status-completed">Selesai</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-briefcase-medical me-2"></i>Manajemen Fasilitas Kesehatan
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 1-5 Maret 2026</p>
                                <p><i class="far fa-clock"></i> 08:00 - 16:00 WIB</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang Auditorium</p>
                                <p><i class="fas fa-users"></i> Kuota: 100 Peserta</p>
                                <span class="status status-upcoming">Akan Datang</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Galeri Foto -->
        <section class="py-5" id="galeri">
            <div class="container">
                <div class="section-title">
                    <h2>Galeri Foto Kegiatan</h2>
                    <p>Dokumentasi kegiatan pengembangan kompetensi ASN Kesehatan</p>
                </div>
                <div class="row g-4" id="galeriContainer">
                    <!-- Galeri items akan dimuat dari JavaScript -->
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-camera me-2"></i>Pelatihan Klinis
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 15-17 Februari 2026</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang A, Gedung A</p>
                                <a href="#" onclick="openGaleriPopup('FOLDER_ID_1', 'Pelatihan Klinis', '15-17 Februari 2026', 'https://maps.google.com/?q=RuangA,GedungA')" class="btn btn-primary-custom btn-custom w-100" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;">
                                    <i class="fas fa-images me-2"></i>Lihat Foto
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-camera me-2"></i>Seminar Mutu Layanan Kesehatan
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 20 Februari 2026</p>
                                <p><i class="fas fa-map-marker-alt"></i> Zoom & Offline</p>
                                <a href="#" onclick="openGaleriPopup('FOLDER_ID_2', 'Seminar Mutu Layanan Kesehatan', '20 Februari 2026', 'https://maps.google.com/?q=Hybrid')" class="btn btn-primary-custom btn-custom w-100" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;">
                                    <i class="fas fa-images me-2"></i>Lihat Foto
                                </a>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-4 col-md-6">
                        <div class="activity-card">
                            <div class="card-header">
                                <i class="fas fa-camera me-2"></i>Workshop Digital Health
                            </div>
                            <div class="card-body">
                                <p><i class="far fa-calendar"></i> 22-24 Februari 2026</p>
                                <p><i class="fas fa-map-marker-alt"></i> Ruang Seminar Utama</p>
                                <a href="#" onclick="openGaleriPopup('FOLDER_ID_3', 'Workshop Digital Health', '22-24 Februari 2026', 'https://maps.google.com/?q=RuangSeminarUtama')" class="btn btn-primary-custom btn-custom w-100" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;">
                                    <i class="fas fa-images me-2"></i>Lihat Foto
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Download Sertifikat -->
        <section class="py-5" id="sertifikat">
            <div class="container">
                <div class="section-title">
                    <h2>Download Sertifikat</h2>
                    <p>Unduh sertifikat kompetensi ASN Kesehatan setelah menyelesaikan kegiatan</p>
                </div>
                <div class="row g-4">
                    <div class="col-lg-6">
                        <div class="download-card">
                            <div class="download-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="download-info flex-grow-1">
                                <h5>Sertifikat Pelatihan Klinis</h5>
                                <p>Format: PDF | Ukuran: 245 KB</p>
                            </div>
                            <button class="btn btn-download" onclick="showSertifikatPopup('SERTIFIKAT_URL_1', 'downloadsertifikatsipandaiasn.html')">
                                <i class="fas fa-download me-2"></i>Download
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="download-card">
                            <div class="download-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="download-info flex-grow-1">
                                <h5>Sertifikat Seminar Mutu Layanan Kesehatan</h5>
                                <p>Format: PDF | Ukuran: 180 KB</p>
                            </div>
                            <button class="btn btn-download" onclick="showSertifikatPopup('SERTIFIKAT_URL_2', 'Sertifikat Seminar Mutu Layanan Kesehatan')">
                                <i class="fas fa-download me-2"></i>Download
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="download-card">
                            <div class="download-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="download-info flex-grow-1">
                                <h5>Sertifikat Workshop Digital Health</h5>
                                <p>Format: PDF | Ukuran: 320 KB</p>
                            </div>
                            <button class="btn btn-download" onclick="showSertifikatPopup('SERTIFIKAT_URL_3', 'Sertifikat Workshop Digital Health')">
                                <i class="fas fa-download me-2"></i>Download
                            </button>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="download-card">
                            <div class="download-icon">
                                <i class="fas fa-file-pdf"></i>
                            </div>
                            <div class="download-info flex-grow-1">
                                <h5>Sertifikat Pelatihan Kegawatdaruratan</h5>
                                <p>Format: PDF | Ukuran: 290 KB</p>
                            </div>
                            <button class="btn btn-download" onclick="showSertifikatPopup('SERTIFIKAT_URL_4', 'Sertifikat Pelatihan Kegawatdaruratan')">
                                <i class="fas fa-download me-2"></i>Download
                            </button>
                        </div>
                    </div>
                </div>
                
                <div class="text-center mt-4">
                    <button class="btn btn-primary-custom btn-custom">
                        <i class="fas fa-search me-2"></i>Cari Sertifikat Lainnya
                    </button>
                </div>
            </div>
        </section>
        
        <!-- Saran/Komplain -->
        <section class="py-5 bg-light" id="saran">
            <div class="container">
                <div class="section-title">
                    <h2>Saran dan Komplain</h2>
                    <p>Sampaikan saran, kritik, atau keluhan Anda untuk perbaikan layanan SIPANDAI-ASN</p>
                </div>
                <div class="row justify-content-center">
                    <div class="col-lg-8">
                        <div class="contact-form">
                            <form id="feedbackForm">
                                <div class="row g-3">
                                    <div class="col-md-6">
                                        <label class="form-label">Nama Lengkap</label>
                                        <input type="text" class="form-control" placeholder="Masukkan nama lengkap" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">NIP</label>
                                        <input type="text" class="form-control" placeholder="Masukkan NIP" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Email</label>
                                        <input type="email" class="form-control" placeholder="nama@email.com" required>
                                    </div>
                                    <div class="col-md-6">
                                        <label class="form-label">Kategori</label>
                                        <select class="form-select" required>
                                            <option value="">Pilih kategori...</option>
                                            <option value="saran">Saran</option>
                                            <option value="kritik">Kritik</option>
                                            <option value="komplain">Komplain</option>
                                            <option value="lainnya">Lainnya</option>
                                        </select>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Subjek</label>
                                        <input type="text" class="form-control" placeholder="Masukkan subjek pesan" required>
                                    </div>
                                    <div class="col-12">
                                        <label class="form-label">Pesan</label>
                                        <textarea class="form-control" rows="5" placeholder="Tuliskan saran, kritik, atau komplain Anda..." required></textarea>
                                    </div>
                                    <div class="col-12">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" id="agree" required>
                                            <label class="form-check-label" for="agree">
                                                Saya menyetujui bahwa data yang saya berikan adalah benar
                                            </label>
                                        </div>
                                    </div>
                                    <div class="col-12">
                                        <button type="submit" class="btn btn-primary-custom btn-custom w-100">
                                            <i class="fas fa-paper-plane me-2"></i>Kirim Pesan
                                        </button>
                                    </div>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Modal Popup Sertifikat -->
        <div class="modal fade" id="sertifikatModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white;">
                        <h5 class="modal-title"><i class="fas fa-certificate me-2"></i>Download Sertifikat</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body text-center py-4">
                        <i class="fas fa-file-pdf" style="font-size: 4rem; color: #dc3545; margin-bottom: 20px;"></i>
                        <h5 id="sertifikatTitle" class="mb-3">Sertifikat</h5>
                        <p class="text-muted mb-4">Klik tombol di bawah untuk mendownload sertifikat</p>
                        <div id="countdownContainer" style="display: none;">
                            <p class="mb-2">Mengalihkan dalam <span id="countdownTimer" style="font-weight: bold; font-size: 1.5rem;">5</span> detik...</p>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                        <a id="sertifikatDownloadLink" href="#" target="_blank" class="btn btn-primary" style="background: linear-gradient(135deg, #0066cc, #004d99); border: none;">
                            <i class="fas fa-download me-2"></i>Download Sekarang
                        </a>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Modal Popup Galeri Foto -->
        <div class="modal fade" id="galeriModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-lg">
                <div class="modal-content">
                    <div class="modal-header" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white;">
                        <h5 class="modal-title"><i class="fas fa-images me-2"></i><span id="galeriTitle">Galeri Foto</span></h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <p><i class="far fa-calendar me-2"></i><span id="galeriTanggal">-</span></p>
                            </div>
                            <div class="col-md-6">
                                <a id="galeriMaps" href="#" target="_blank" class="btn btn-success btn-sm">
                                    <i class="fas fa-map-marker-alt me-1"></i>Lihat di Maps
                                </a>
                            </div>
                        </div>
                        <div id="galeriIframeContainer" style="background: #f8f9fa; padding: 10px; border-radius: 10px;">
                            <div style="text-align: center; padding: 50px;">
                                <i class="fas fa-images" style="font-size: 3rem; color: #0066cc; margin-bottom: 15px;"></i>
                                <p class="text-muted">Foto akan ditampilkan dari Google Drive</p>
                                <p class="text-muted small">Folder ID: <span id="galeriFolderId">-</span></p>
                                <a id="galeriDriveLink" href="#" target="_blank" class="btn btn-primary" style="background: linear-gradient(135deg, #0066cc, #004d99); border: none;">
                                    <i class="fab fa-google-drive me-2"></i>Buka di Google Drive
                                </a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="row g-4">
                    <div class="col-lg-4">
                        <h5>SIPANDAI-ASN</h5>
                        <p>Sistem Pengembangan Mutu dan Peningkatan Kompetensi ASN Kesehatan Kementerian Kesehatan Republik Indonesia</p>
                        <p><i class="fas fa-map-marker-alt me-2"></i>Jl. H.R. Rasuna Said Blok X.5 Kav. 4-9, Jakarta Selatan 12950</p>
                    </div>
                    <div class="col-lg-4">
                        <h5>Tautan Cepat</h5>
                        <p><a href="#dashboard"><i class="fas fa-chevron-right me-2"></i>Beranda</a></p>
                        <p><a href="#jadwal"><i class="fas fa-chevron-right me-2"></i>Jadwal Kegiatan</a></p>
                        <p><a href="#galeri"><i class="fas fa-chevron-right me-2"></i>Galeri Foto</a></p>
                        <p><a href="#sertifikat"><i class="fas fa-chevron-right me-2"></i>Download Sertifikat</a></p>
                        <p><a href="#saran"><i class="fas fa-chevron-right me-2"></i>Saran/Komplain</a></p>
                    </div>
                    <div class="col-lg-4">
                        <h5>Kontak</h5>
                        <p><i class="fas fa-phone me-2"></i>(021) 5201590</p>
                        <p><i class="fas fa-envelope me-2"></i>sipandaiasn@kemkes.go.id</p>
                        <p><i class="fas fa-globe me-2"></i>www.kemkes.go.id</p>
                    </div>
                </div>
                <div class="footer-bottom text-center">
                    <p>&copy; 2026 SIPANDAI-ASN. All rights reserved. | Kementerian Kesehatan Republik Indonesia</p>
                </div>
            </div>
        </footer>
    </div>
    
    <!-- Admin Login Section -->
    <div id="admin-login" class="admin-login" style="display: none;">
        <div class="login-card">
            <h3><i class="fas fa-shield-alt me-2"></i>Admin SIPANDAI-ASN</h3>
            <form id="adminLoginForm">
                <div class="mb-3">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-control" id="adminUsername" placeholder="Masukkan username" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control" id="adminPassword" placeholder="Masukkan password" required>
                </div>
                <div class="mb-3">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="rememberMe">
                        <label class="form-check-label" for="rememberMe">Ingat saya</label>
                    </div>
                </div>
                <button type="submit" class="btn btn-primary-custom w-100 mb-3" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;">
                    <i class="fas fa-sign-in-alt me-2"></i>Masuk
                </button>
                <div class="text-center">
                    <a href="#" onclick="showMainWebsite()" style="color: #666;"><i class="fas fa-arrow-left me-2"></i>Kembali ke Beranda</a>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Admin Dashboard Section -->
    <div id="admin-dashboard" class="admin-container">
        <div class="row g-0">
            <!-- Sidebar -->
            <div class="col-md-3 col-lg-2 admin-sidebar">
                <div class="sidebar-header">
                    <h5><i class="fas fa-shield-alt me-2"></i>Admin Panel</h5>
                    <p style="font-size: 0.8rem; opacity: 0.9;">SIPANDAI-ASN</p>
                </div>
                <nav class="nav flex-column">
                    <a class="nav-link active" href="#" onclick="showAdminSection('dashboard', event)">
                        <i class="fas fa-tachometer-alt me-2"></i>Dashboard
                    </a>
                    <a class="nav-link" href="#" onclick="showAdminSection('kegiatan', event)">
                        <i class="fas fa-calendar-alt me-2"></i>Data Kegiatan
                    </a>
                    <a class="nav-link" href="#" onclick="showAdminSection('narasumber', event)">
                        <i class="fas fa-chalkboard-teacher me-2"></i>Data Narasumber
                    </a>
                    <a class="nav-link" href="#" onclick="showAdminSection('peserta', event)">
                        <i class="fas fa-users me-2"></i>Data Peserta
                    </a>
                    <a class="nav-link" href="#" onclick="showAdminSection('laporan', event)">
                        <i class="fas fa-chart-bar me-2"></i>Data Laporan
                    </a>
                    <hr style="border-color: rgba(255,255,255,0.2);">
                    <a class="nav-link" href="#" onclick="logoutAdmin()">
                        <i class="fas fa-sign-out-alt me-2"></i>Logout
                    </a>
                </nav>
            </div>
            
            <!-- Main Content -->
            <div class="col-md-9 col-lg-10 admin-content">
                <!-- Dashboard Section -->
                <div id="admin-section-dashboard">
                    <div class="admin-header">
                        <h3><i class="fas fa-tachometer-alt me-2"></i>Dashboard Peserta</h3>
                        <div>
                            <button class="btn btn-primary-custom btn-custom me-2" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;" onclick="exportData('peserta')">
                                <i class="fas fa-download me-2"></i>Export Data
                            </button>
                            <button class="btn btn-success btn-custom" style="background: #00a651; border: none;" onclick="showAddModal('peserta')">
                                <i class="fas fa-plus me-2"></i>Tambah Peserta
                            </button>
                        </div>
                    </div>
                    
                    <div class="row g-4 mb-4">
                        <div class="col-md-3 col-sm-6">
                            <div class="stat-card">
                                <i class="fas fa-users"></i>
                                <h3>12,458</h3>
                                <p>Total Peserta</p>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6">
                            <div class="stat-card">
                                <i class="fas fa-user-plus"></i>
                                <h3>156</h3>
                                <p>Peserta Baru (Bulan Ini)</p>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6">
                            <div class="stat-card">
                                <i class="fas fa-check-circle"></i>
                                <h3>8,234</h3>
                                <p>Peserta Selesai</p>
                            </div>
                        </div>
                        <div class="col-md-3 col-sm-6">
                            <div class="stat-card">
                                <i class="fas fa-clock"></i>
                                <h3>4,224</h3>
                                <p>Peserta Berlangsung</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="alert-custom" style="background: linear-gradient(135deg, #d4edda, #c3e6cb); color: #155724;">
                        <i class="fas fa-info-circle me-2"></i>
                        <strong>Informasi:</strong> Sistem SIPANDAI-ASN telah berjalan dengan baik. Data peserta diperbarui secara real-time.
                    </div>
                    
                    <div class="data-table">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>NIP</th>
                                        <th>Nama Lengkap</th>
                                        <th>Unit Kerja</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="dashboardTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Data Kegiatan Section -->
                <div id="admin-section-kegiatan" style="display: none;">
                    <div class="admin-header">
                        <h3><i class="fas fa-calendar-alt me-2"></i>Data Kegiatan</h3>
                        <button class="btn btn-primary-custom btn-custom" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;" onclick="showAddModal('kegiatan')">
                            <i class="fas fa-plus me-2"></i>Tambah Kegiatan
                        </button>
                    </div>
                    
                    <div class="alert-custom" style="background: linear-gradient(135deg, #e3f2fd, #bbdefb); color: #0d47a1;">
                        <i class="fas fa-link me-2"></i>
                        <strong>Terhubung ke Halaman Beranda:</strong> Data kegiatan di halaman ini akan otomatis ditampilkan pada jadwal kegiatan di halaman beranda utama.
                    </div>
                    
                    <div class="data-table">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>Nama Kegiatan</th>
                                        <th>Tanggal</th>
                                        <th>Kuota</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="kegiatanTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Data Narasumber Section -->
                <div id="admin-section-narasumber" style="display: none;">
                    <div class="admin-header">
                        <h3><i class="fas fa-chalkboard-teacher me-2"></i>Data Narasumber</h3>
                        <button class="btn btn-primary-custom btn-custom" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;" onclick="showAddModal('narasumber')">
                            <i class="fas fa-plus me-2"></i>Tambah Narasumber
                        </button>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>NIP</th>
                                        <th>Nama Lengkap</th>
                                        <th>Spesialisasi</th>
                                        <th>Institusi</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="narasumberTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                
                <!-- Data Peserta Section -->
                <div id="admin-section-peserta" style="display: none;">
                    <div class="admin-header">
                        <h3><i class="fas fa-users me-2"></i>Data Peserta</h3>
                        <div>
                            <button class="btn btn-primary-custom btn-custom me-2" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;" onclick="showAddModal('peserta')">
                                <i class="fas fa-plus me-2"></i>Tambah Peserta
                            </button>
                            <button class="btn btn-success btn-custom" style="background: #00a651; border: none;" onclick="importData()">
                                <i class="fas fa-file-import me-2"></i>Import Data
                            </button>
                        </div>
                    </div>
                    
                    <div class="alert-custom" style="background: linear-gradient(135deg, #fff3cd, #ffeeba); color: #856404;">
                        <i class="fas fa-exclamation-triangle me-2"></i>
                        <strong>Peringatan Validasi Data:</strong> Sistem SIPANDAI-ASN tidak mengizinkan duplikasi data peserta berdasarkan NIP. Setiap NIP hanya dapat terdaftar sekali dalam sistem.
                    </div>
                    
                    <!-- Search and Filter -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-4">
                            <input type="text" class="form-control" placeholder="Cari berdasarkan NIP..." id="searchNIP" onkeyup="searchPeserta()">
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="filterUnit" onchange="filterPeserta()">
                                <option value="">Semua Unit Kerja</option>
                                <option value="rsup">RSUP</option>
                                <option value="rsud">RSUD</option>
                                <option value="dinkes">Dinkes</option>
                                <option value="puskesmas">Puskesmas</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <select class="form-select" id="filterStatus" onchange="filterPeserta()">
                                <option value="">Semua Status</option>
                                <option value="aktif">Aktif</option>
                                <option value="proses">Proses</option>
                                <option value="nonaktif">Non-Aktif</option>
                            </select>
                        </div>
                        <div class="col-md-2">
                            <button class="btn btn-primary-custom w-100" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;" onclick="searchPeserta()">
                                <i class="fas fa-search"></i> Cari
                            </button>
                        </div>
                    </div>
                    
                    </div>
                    
                    <!-- Import Data Hidden Input -->
                    <input type="file" id="importFileInput" accept=".csv,.xlsx,.xls" style="display: none;" onchange="handleImportFile(this)">
                    
                    <div class="data-table">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>NIP</th>
                                        <th>Nama Lengkap</th>
                                        <th>Unit Kerja</th>
                                        <th>Jabatan</th>
                                        <th>Email</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="pesertaTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <nav aria-label="Page navigation" class="mt-4">
                        <ul class="pagination justify-content-center">
                            <li class="page-item disabled">
                                <a class="page-link" href="#" tabindex="-1">Previous</a>
                            </li>
                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                            <li class="page-item">
                                <a class="page-link" href="#">Next</a>
                            </li>
                        </ul>
                    </nav>
                </div>
                
                <!-- Data Laporan Section -->
                <div id="admin-section-laporan" style="display: none;">
                    <div class="admin-header">
                        <h3><i class="fas fa-chart-bar me-2"></i>Data Laporan</h3>
                        <button class="btn btn-primary-custom btn-custom" style="background: linear-gradient(135deg, #0066cc, #004d99); color: white; border: none;" onclick="showAddModal('laporan')">
                            <i class="fas fa-plus me-2"></i>Buat Laporan Baru
                        </button>
                    </div>
                    
                    <div class="row g-4 mb-4">
                        <div class="col-md-4">
                            <div class="stat-card">
                                <i class="fas fa-file-alt" style="color: #0066cc;"></i>
                                <h3>156</h3>
                                <p>Total Laporan</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card">
                                <i class="fas fa-check-circle" style="color: #00a651;"></i>
                                <h3>142</h3>
                                <p>Laporan Disetujui</p>
                            </div>
                        </div>
                        <div class="col-md-4">
                            <div class="stat-card">
                                <i class="fas fa-clock" style="color: #ffc107;"></i>
                                <h3>14</h3>
                                <p>Laporan Pending</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="data-table">
                        <div class="table-responsive">
                            <table class="table table-hover">
                                <thead>
                                    <tr>
                                        <th>No.</th>
                                        <th>Judul Laporan</th>
                                        <th>Jenis</th>
                                        <th>Tanggal Dibuat</th>
                                        <th>Status</th>
                                        <th>Aksi</th>
                                    </tr>
                                </thead>
                                <tbody id="laporanTableBody">
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Modal untuk Tambah Data -->
    <div class="modal fade" id="addModal" tabindex="-1" aria-hidden="true">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Tambah Data</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="addDataForm">
                        <input type="hidden" id="modalId">
                        <div class="row g-3">
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelNIP">NIP *</label>
                                <input type="text" class="form-control" id="modalNIP" placeholder="Masukkan NIP">
                                <div class="form-text text-danger" id="nipError" style="display: none;">NIP sudah terdaftar dalam sistem!</div>
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelNama">Nama Lengkap *</label>
                                <input type="text" class="form-control" id="modalNama" placeholder="Masukkan nama lengkap">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label">Email</label>
                                <input type="email" class="form-control" id="modalEmail" placeholder="nama@email.com">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelUnit">Unit Kerja</label>
                                <select class="form-select" id="modalUnit">
                                    <option value="">Pilih Unit Kerja...</option>
                                    <option value="rsup">RSUP</option>
                                    <option value="rsud">RSUD</option>
                                    <option value="dinkes">Dinkes</option>
                                    <option value="puskesmas">Puskesmas</option>
                                </select>
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelJabatan">Jabatan</label>
                                <input type="text" class="form-control" id="modalJabatan" placeholder="Masukkan jabatan">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelStatus">Status</label>
                                <select class="form-select" id="modalStatus">
                                    <option value="aktif">Aktif</option>
                                    <option value="proses">Proses</option>
                                    <option value="nonaktif">Non-Aktif</option>
                                </select>
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelTanggal">Tanggal</label>
                                <input type="text" class="form-control" id="modalTanggal" placeholder="Masukkan tanggal">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelKuota">Kuota</label>
                                <input type="number" class="form-control" id="modalKuota" placeholder="Jumlah kuota">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelSpesialisasi">Spesialisasi</label>
                                <input type="text" class="form-control" id="modalSpesialisasi" placeholder="Masukkan spesialisasi">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelInstitusi">Institusi</label>
                                <input type="text" class="form-control" id="modalInstitusi" placeholder="Masukkan institusi">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelJudul">Judul</label>
                                <input type="text" class="form-control" id="modalJudul" placeholder="Masukkan judul">
                            </div>
                            <div class="col-md-6" style="display: none;">
                                <label class="form-label" id="labelJenis">Jenis</label>
                                <select class="form-select" id="modalJenis">
                                    <option value="">Pilih Jenis...</option>
                                    <option value="Bulanan">Bulanan</option>
                                    <option value="Evaluasi">Evaluasi</option>
                                    <option value="Semester">Semester</option>
                                </select>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Batal</button>
                    <button type="button" class="btn btn-primary" style="background: linear-gradient(135deg, #0066cc, #004d99); border: none;" onclick="saveData()">
                        <i class="fas fa-save me-2"></i>Simpan
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/js/all.min.js"></script>
    <script>
        // Fungsi untuk menampilkan halaman utama
        function showMainWebsite() {
            document.getElementById('main-website').style.display = 'block';
            document.getElementById('admin-login').style.display = 'none';
            document.getElementById('admin-dashboard').style.display = 'none';
        }
        
        // Fungsi untuk menampilkan halaman login admin
        function showAdminLogin() {
            document.getElementById('main-website').style.display = 'none';
            document.getElementById('admin-login').style.display = 'flex';
            document.getElementById('admin-dashboard').style.display = 'none';
        }
        
        // Fungsi untuk menampilkan dashboard admin
        function showAdminDashboard() {
            document.getElementById('main-website').style.display = 'none';
            document.getElementById('admin-login').style.display = 'none';
            document.getElementById('admin-dashboard').style.display = 'block';
            // Load dashboard data
            loadDashboardStats();
        }
        
        // Fungsi untuk scroll ke section tertentu
        function scrollToSection(sectionId) {
            document.getElementById(sectionId).scrollIntoView({ behavior: 'smooth' });
        }
        
        // Fungsi untuk menampilkan section admin
        function showAdminSection(section, evt) {
            // Update nav active state
            document.querySelectorAll('.admin-sidebar .nav-link').forEach(link => {
                link.classList.remove('active');
            });
            
            if (evt && evt.target) {
                const navLink = evt.target.closest('.nav-link');
                if (navLink) navLink.classList.add('active');
            } else {
                // Find the nav-link that corresponds to this section
                const navLinks = document.querySelectorAll('.admin-sidebar .nav-link');
                const sectionMap = {
                    'dashboard': 0,
                    'kegiatan': 1,
                    'narasumber': 2,
                    'peserta': 3,
                    'laporan': 4
                };
                if (navLinks[sectionMap[section]]) {
                    navLinks[sectionMap[section]].classList.add('active');
                }
            }
            
            // Hide all sections
            document.getElementById('admin-section-dashboard').style.display = 'none';
            document.getElementById('admin-section-kegiatan').style.display = 'none';
            document.getElementById('admin-section-narasumber').style.display = 'none';
            document.getElementById('admin-section-peserta').style.display = 'none';
            document.getElementById('admin-section-laporan').style.display = 'none';
            
            // Show selected section
            document.getElementById('admin-section-' + section).style.display = 'block';
            
            // Load data for each section
            if (section === 'kegiatan') loadKegiatanData();
            if (section === 'narasumber') loadNarasumberData();
            if (section === 'peserta') loadPesertaData();
            if (section === 'laporan') loadLaporanData();
            if (section === 'dashboard') loadDashboardStats();
        }
        
        // ========== GOOGLE SHEETS INTEGRATION ==========
        
        // IMPORTANT: Replace with your Google Apps Script Web App URL
        const GOOGLE_SHEETS_URL = 'https://script.google.com/macros/s/AKfycbyHqcyNh3tfK66cSd1qRWP31-XRTyFt-ZIOLX8WdWJybAn2LadbVwDywp0R8hBvFhY5/exec'; // Example: 'https://script.google.com/macros/s/ABC123XYZ/exec'\n        \n        const SHEET_NAMES = {\n            'kegiatan': 'Kegiatan',\n            'narasumber': 'Narasumber',\n            'peserta': 'Peserta',\n            'laporan': 'Laporan'\n        };
        
        
        // Send data to Google Sheets
        function sendToGoogleSheets(sheetName, data, callback) {
            if (!GOOGLE_SHEETS_URL) {
                console.log('Google Sheets URL not configured. Data saved locally only.');
                if (callback) callback({ success: false, message: 'Google Sheets URL not configured' });
                return;
            }
            
            const url = GOOGLE_SHEETS_URL + '?sheetName=' + encodeURIComponent(sheetName) + '&data=' + encodeURIComponent(JSON.stringify(data));
            
            // Use JSONP approach for cross-domain requests
            const script = document.createElement('script');
            const timeout = setTimeout(function() {
                script.remove();
                if (callback) callback({ success: false, message: 'Request timeout' });
            }, 10000);
            
            window.googleSheetsCallback = function(response) {
                clearTimeout(timeout);
                script.remove();
                delete window.googleSheetsCallback;
                console.log('Google Sheets response:', response);
                if (callback) callback({ success: true, message: response });
            };
            
            script.src = url;
            script.onerror = function() {
                clearTimeout(timeout);
                script.remove();
                delete window.googleSheetsCallback;
                console.log('Google Sheets request failed - data saved locally only');
                if (callback) callback({ success: false, message: 'Request failed' });
            };
            document.head.appendChild(script);
        }
        
        // Send data to Google Sheets using fetch (modern approach)
        async function sendToGoogleSheetsAsync(sheetName, data) {
            if (!GOOGLE_SHEETS_URL) {
                console.log('Google Sheets URL not configured. Data saved locally only.');
                return { success: false, message: 'Google Sheets URL not configured' };
            }
            
            try {
                const formData = new FormData();
                formData.append('sheetName', sheetName);
                formData.append('data', JSON.stringify(data));
                
                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.text();
                console.log('Google Sheets response:', result);
                return { success: true, message: result };
            } catch (error) {
                console.log('Google Sheets request failed:', error);
                return { success: false, message: error.toString() };
            }
        }
        
        // Test Google Sheets connection
        async function testGoogleSheetsConnection() {
            if (!GOOGLE_SHEETS_URL) {
                alert('Google Sheets URL belum dikonfigurasi!\n\nSilakan:\n1. Deploy Google Apps Script sebagai Web App\n2. Copy URL Web App\n3. Paste ke variabel GOOGLE_SHEETS_URL di kode HTML');
                return false;
            }
            
            try {
                const testUrl = GOOGLE_SHEETS_URL + '?test=true';
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = testUrl;
                document.body.appendChild(iframe);
                
                setTimeout(function() {
                    iframe.remove();
                    alert('Koneksi ke Google Sheets aktif!\nData akan dikirim ke Google Sheets saat disimpan.');
                }, 2000);
                
                return true;
            } catch (error) {
                alert('Gagal terhubung ke Google Sheets: ' + error.message);
                return false;
            }
        }
        
        // ========== DATA MANAGEMENT - GOOGLE SHEETS ONLY ==========
        
        // Fetch data from Google Sheets
        async function fetchDataFromGoogleSheets(sheetName) {
            if (!GOOGLE_SHEETS_URL || GOOGLE_SHEETS_URL === 'YOUR_GOOGLE_APPS_SCRIPT_WEB_APP_URL') {
                console.log('Google Sheets URL not configured');
                return [];
            }
            
            try {
                const url = GOOGLE_SHEETS_URL + '?sheetName=' + encodeURIComponent(sheetName) + '&action=read';
                
                const response = await fetch(url, {
                    method: 'GET',
                    mode: 'cors'
                });
                
                if (response.ok) {
                    const text = await response.text();
                    // Parse the response - it should be JSON
                    try {
                        return JSON.parse(text);
                    } catch (e) {
                        console.log('Response is not JSON:', text);
                        return [];
                    }
                }
                return [];
            } catch (error) {
                console.log('Failed to fetch data from Google Sheets:', error);
                return [];
            }
        }
        
        // Save data to Google Sheets
        async function saveDataToGoogleSheets(type, data, callback) {
            if (!GOOGLE_SHEETS_URL || GOOGLE_SHEETS_URL === 'https://script.google.com/macros/s/AKfycbzZKh-L18tTQOR6BGWpbBm64Rrceu_1_KmgZZd6QdlXaNH44StwktJ3McHOUAQH2eLe/exec') {
                alert('Google Sheets belum dikonfigurasi! Silakan: 1. Edit google-apps-script.gs dan ganti SPREADSHEET_ID 2. Deploy sebagai Web App 3. Copy URL dan paste ke GOOGLE_SHEETS_URL di sipandaiasn.html');
                if (callback) callback({ success: false, message: 'URL not configured' });
                return;
            }
            
            const sheetName = SHEET_NAMES[type];
            
            try {
                const formData = new FormData();
                formData.append('sheetName', sheetName);
                formData.append('data', JSON.stringify(data));
                
                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    body: formData
                });
                
                if (response.ok) {
                    if (callback) callback({ success: true, message: 'Data saved' });
                } else {
                    if (callback) callback({ success: false, message: 'Failed to save' });
                }
            } catch (error) {
                console.log('Failed to save to Google Sheets:', error);
                if (callback) callback({ success: false, message: error.toString() });
            }
        }
        
        function generateId(prefix) {
            return prefix + '-' + Date.now().toString(36).toUpperCase();
        }
        
        // ========== KEGIATAN CRUD ==========
        async function loadKegiatanData() {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['kegiatan']);
            const tbody = document.getElementById('kegiatanTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center">Belum ada data kegiatan</td></tr>';
                return;
            }
            
            data.forEach((item, index) => {
                const statusBadge = getStatusBadge(item.status);
                tbody.innerHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.nama}</td>
                        <td>${item.tanggal}</td>
                        <td>${item.kuota}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-action btn-action-edit btn-sm" onclick="editKegiatan('${item.id}')"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-action btn-action-delete btn-sm" onclick="deleteKegiatan('${item.id}')"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
        }
        
        function getStatusBadge(status) {
            const badges = {
                'akan-datang': '<span class="badge bg-warning">Akan Datang</span>',
                'pendaftaran-terbuka': '<span class="badge bg-success">Pendaftaran Terbuka</span>',
                'selesai': '<span class="badge bg-secondary">Selesai</span>'
            };
            return badges[status] || '<span class="badge bg-secondary">-</span>';
        }
        
        async function editKegiatan(id) {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['kegiatan']);
            const item = data.find(d => d.id === id);
            if (!item) return;
            
            document.getElementById('modalId').value = item.id;
            document.getElementById('modalNama').value = item.nama;
            document.getElementById('modalTanggal').value = item.tanggal;
            document.getElementById('modalKuota').value = item.kuota;
            document.getElementById('modalStatus').value = item.status;
            
            document.getElementById('modalTitle').textContent = 'Edit Kegiatan';
            const modal = new bootstrap.Modal(document.getElementById('addModal'));
            modal.show();
        }
        
        async function deleteKegiatan(id) {
            if (confirm('Yakin ingin menghapus kegiatan ini?')) {
                const data = await fetchDataFromGoogleSheets(SHEET_NAMES['kegiatan']);
                const filtered = data.filter(d => d.id !== id);
                await saveDataToGoogleSheets('kegiatan', filtered);
                loadKegiatanData();
                alert('Kegiatan berhasil dihapus!');
            }
        }
        
        // ========== NARASUMBER CRUD ==========
        async function loadNarasumberData() {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['narasumber']);
            const tbody = document.getElementById('narasumberTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center">Belum ada data narasumber</td></tr>';
                return;
            }
            
            data.forEach((item, index) => {
                tbody.innerHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.nip}</td>
                        <td>${item.nama}</td>
                        <td>${item.spesialisasi}</td>
                        <td>${item.institusi}</td>
                        <td>
                            <button class="btn btn-action btn-action-edit btn-sm" onclick="editNarasumber('${item.id}')"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-action btn-action-delete btn-sm" onclick="deleteNarasumber('${item.id}')"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
        }
        
        async function editNarasumber(id) {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['narasumber']);
            const item = data.find(d => d.id === id);
            if (!item) return;
            
            document.getElementById('modalId').value = item.id;
            document.getElementById('modalNIP').value = item.nip;
            document.getElementById('modalNama').value = item.nama;
            document.getElementById('modalEmail').value = item.email || '';
            document.getElementById('modalSpesialisasi').value = item.spesialisasi;
            document.getElementById('modalInstitusi').value = item.institusi;
            
            document.getElementById('modalTitle').textContent = 'Edit Narasumber';
            const modal = new bootstrap.Modal(document.getElementById('addModal'));
            modal.show();
        }
        
        async function deleteNarasumber(id) {
            if (confirm('Yakin ingin menghapus narasumber ini?')) {
                const data = await fetchDataFromGoogleSheets(SHEET_NAMES['narasumber']);
                const filtered = data.filter(d => d.id !== id);
                await saveDataToGoogleSheets('narasumber', filtered);
                loadNarasumberData();
                alert('Narasumber berhasil dihapus!');
            }
        }
        
        // ========== PESERTA CRUD ==========
        async function loadPesertaData() {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
            const tbody = document.getElementById('pesertaTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="text-center">Belum ada data peserta</td></tr>';
                return;
            }
            
            data.forEach((item, index) => {
                const statusBadge = item.status === 'aktif' ? '<span class="badge bg-success">Aktif</span>' : 
                                    item.status === 'proses' ? '<span class="badge bg-warning">Proses</span>' : 
                                    '<span class="badge bg-secondary">Non-Aktif</span>';
                tbody.innerHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.nip}</td>
                        <td>${item.nama}</td>
                        <td>${item.unit}</td>
                        <td>${item.jabatan}</td>
                        <td>${item.email}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-action btn-action-edit btn-sm" onclick="editPeserta('${item.id}')"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-action btn-action-delete btn-sm" onclick="deletePeserta('${item.id}')"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
        }
        
        async function editPeserta(id) {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
            const item = data.find(d => d.id === id);
            if (!item) return;
            
            document.getElementById('modalId').value = item.id;
            document.getElementById('modalNIP').value = item.nip;
            document.getElementById('modalNama').value = item.nama;
            document.getElementById('modalEmail').value = item.email || '';
            document.getElementById('modalUnit').value = item.unit;
            document.getElementById('modalJabatan').value = item.jabatan;
            document.getElementById('modalStatus').value = item.status;
            
            document.getElementById('modalTitle').textContent = 'Edit Peserta';
            const modal = new bootstrap.Modal(document.getElementById('addModal'));
            modal.show();
        }
        
        async function deletePeserta(id) {
            if (confirm('Yakin ingin menghapus peserta ini?')) {
                const data = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
                const filtered = data.filter(d => d.id !== id);
                await saveDataToGoogleSheets('peserta', filtered);
                loadPesertaData();
                alert('Peserta berhasil dihapus!');
            }
        }
        
        // ========== LAPORAN CRUD ==========
        async function loadLaporanData() {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['laporan']);
            const tbody = document.getElementById('laporanTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6" class="text-center">Belum ada data laporan</td></tr>';
                return;
            }
            
            data.forEach((item, index) => {
                const statusBadge = item.status === 'disetujui' ? '<span class="badge bg-success">Disetujui</span>' : 
                                    item.status === 'pending' ? '<span class="badge bg-warning">Pending</span>' : 
                                    '<span class="badge bg-info">Draft</span>';
                tbody.innerHTML += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.judul}</td>
                        <td>${item.jenis}</td>
                        <td>${item.tanggal}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-action btn-action-edit btn-sm" onclick="viewLaporan('${item.id}')"><i class="fas fa-eye"></i></button>
                            <button class="btn btn-download btn-sm" style="background: #00a651; color: white; border: none;" onclick="downloadLaporan('${item.id}')"><i class="fas fa-download"></i></button>
                            <button class="btn btn-action btn-action-delete btn-sm" onclick="deleteLaporan('${item.id}')"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
        }
        
        async function viewLaporan(id) {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['laporan']);
            const item = data.find(d => d.id === id);
            if (!item) return;
            
            alert('Detail Laporan:\n\nJudul: ' + item.judul + '\nJenis: ' + item.jenis + '\nTanggal: ' + item.tanggal + '\nStatus: ' + item.status);
        }
        
        async function deleteLaporan(id) {
            if (confirm('Yakin ingin menghapus laporan ini?')) {
                const data = await fetchDataFromGoogleSheets(SHEET_NAMES['laporan']);
                const filtered = data.filter(d => d.id !== id);
                await saveDataToGoogleSheets('laporan', filtered);
                loadLaporanData();
                alert('Laporan berhasil dihapus!');
            }
        }
        
        async function downloadLaporan(id) {
            const data = await fetchDataFromGoogleSheets(SHEET_NAMES['laporan']);
            const item = data.find(d => d.id === id);
            if (!item) return;
            
            // Create downloadable content
            const content = `LAPORAN ${item.judul}
================================
Judul: ${item.judul}
Jenis: ${item.jenis}
Tanggal: ${item.tanggal}
Status: ${item.status}

Generated by SIPANDAI-ASN`;
            
            const blob = new Blob([content], { type: 'text/plain;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'laporan_' + item.judul.replace(/\s+/g, '_') + '.txt';
            link.click();
            
            alert('Laporan berhasil didownload!');
        }
        
        // ========== EXPORT DATA ==========
        async function exportData(type) {
            let data = await fetchDataFromGoogleSheets(SHEET_NAMES[type]);
            let filename = '';
            
            if (type === 'peserta') {
                filename = 'data_peserta_' + new Date().toISOString().slice(0,10) + '.csv';
            } else if (type === 'kegiatan') {
                filename = 'data_kegiatan_' + new Date().toISOString().slice(0,10) + '.csv';
            } else if (type === 'narasumber') {
                filename = 'data_narasumber_' + new Date().toISOString().slice(0,10) + '.csv';
            } else if (type === 'laporan') {
                filename = 'data_laporan_' + new Date().toISOString().slice(0,10) + '.csv';
            }
            
            if (data.length === 0) {
                alert('Tidak ada data untuk diexport!');
                return;
            }
            
            // Convert to CSV
            const headers = Object.keys(data[0]);
            const csvContent = [
                headers.join(','),
                ...data.map(row => headers.map(fieldName => JSON.stringify(row[fieldName] || '')).join(','))
            ].join('\n');
            
            // Download
            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = filename;
            link.click();
            
            alert('Data berhasil diexport ke ' + filename);
        }
        
        // ========== IMPORT DATA ==========
        function importData() {
            document.getElementById('importFileInput').click();
        }
        
        async function handleImportFile(input) {
            const file = input.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = async function(e) {
                const content = e.target.result;
                const lines = content.split('\n');
                const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                
                const importedData = [];
                for (let i = 1; i < lines.length; i++) {
                    if (lines[i].trim()) {
                        const values = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                        const row = {};
                        headers.forEach((h, idx) => {
                            row[h] = values[idx] || '';
                        });
                        row.id = generateId('PES');
                        importedData.push(row);
                    }
                }
                
                if (importedData.length > 0) {
                    const existingData = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
                    // Check for duplicates
                    importedData.forEach(newItem => {
                        if (!existingData.some(d => d.nip === newItem.nip)) {
                            existingData.push(newItem);
                        }
                    });
                    await saveDataToGoogleSheets('peserta', existingData);
                    loadPesertaData();
                    alert('Berhasil import ' + importedData.length + ' data peserta!');
                }
            };
            reader.readAsText(file);
            input.value = '';
        }
        
        // ========== SEARCH & FILTER ==========
        function searchPeserta() {
            loadPesertaData();
        }
        
        function filterPeserta() {
            loadPesertaData();
        }
        
        // ========== PAGINATION ==========
        let currentPage = 1;
        const itemsPerPage = 10;
        
        function renderPagination(totalItems) {
            const totalPages = Math.ceil(totalItems / itemsPerPage);
            const pagination = document.querySelector('#admin-section-peserta .pagination');
            
            let html = `
                <li class="page-item ${currentPage === 1 ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="changePage(${currentPage - 1}); return false;">Previous</a>
                </li>
            `;
            
            for (let i = 1; i <= totalPages; i++) {
                html += `
                    <li class="page-item ${currentPage === i ? 'active' : ''}">
                        <a class="page-link" href="#" onclick="changePage(${i}); return false;">${i}</a>
                    </li>
                `;
            }
            
            html += `
                <li class="page-item ${currentPage === totalPages ? 'disabled' : ''}">
                    <a class="page-link" href="#" onclick="changePage(${currentPage + 1}); return false;">Next</a>
                </li>
            `;
            
            pagination.innerHTML = html;
        }
        
        function changePage(page) {
            currentPage = page;
            loadPesertaData();
        }
        
        // Updated loadPesertaData with pagination, search & filter
        async function loadPesertaData() {
            const searchNIP = document.getElementById('searchNIP').value.toLowerCase();
            const filterUnit = document.getElementById('filterUnit').value;
            const filterStatus = document.getElementById('filterStatus').value;
            
            let data = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
            
            // Apply filters
            if (searchNIP) {
                data = data.filter(d => d.nip.toLowerCase().includes(searchNIP));
            }
            if (filterUnit) {
                data = data.filter(d => d.unit === filterUnit);
            }
            if (filterStatus) {
                data = data.filter(d => d.status === filterStatus);
            }
            
            const tbody = document.getElementById('pesertaTableBody');
            if (!tbody) return;
            
            tbody.innerHTML = '';
            
            if (data.length === 0) {
                tbody.innerHTML = '<tr><td colspan="8" class="text-center">Tidak ada data peserta yang sesuai dengan filter</td></tr>';
                return;
            }
            
            // Pagination
            const startIndex = (currentPage - 1) * itemsPerPage;
            const paginatedData = data.slice(startIndex, startIndex + itemsPerPage);
            
            paginatedData.forEach((item, index) => {
                const statusBadge = item.status === 'aktif' ? '<span class="badge bg-success">Aktif</span>' : 
                                    item.status === 'proses' ? '<span class="badge bg-warning">Proses</span>' : 
                                    '<span class="badge bg-secondary">Non-Aktif</span>';
                tbody.innerHTML += `
                    <tr>
                        <td>${startIndex + index + 1}</td>
                        <td>${item.nip}</td>
                        <td>${item.nama}</td>
                        <td>${item.unit}</td>
                        <td>${item.jabatan}</td>
                        <td>${item.email}</td>
                        <td>${statusBadge}</td>
                        <td>
                            <button class="btn btn-action btn-action-edit btn-sm" onclick="editPeserta('${item.id}')"><i class="fas fa-edit"></i></button>
                            <button class="btn btn-action btn-action-delete btn-sm" onclick="deletePeserta('${item.id}')"><i class="fas fa-trash"></i></button>
                        </td>
                    </tr>
                `;
            });
            
            renderPagination(data.length);
        }
        
        // Update loadDashboardStats to include dynamic stats
        async function loadDashboardStats() {
            const peserta = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
            const kegiatan = await fetchDataFromGoogleSheets(SHEET_NAMES['kegiatan']);
            const narasumber = await fetchDataFromGoogleSheets(SHEET_NAMES['narasumber']);
            const laporan = await fetchDataFromGoogleSheets(SHEET_NAMES['laporan']);
            
            const pesertaAktif = peserta.filter(p => p.status === 'aktif').length;
            const pesertaProses = peserta.filter(p => p.status === 'proses').length;
            
            document.querySelectorAll('#admin-section-dashboard .stat-card h3')[0].textContent = peserta.length || '0';
            document.querySelectorAll('#admin-section-dashboard .stat-card h3')[1].textContent = kegiatan.length || '0';
            document.querySelectorAll('#admin-section-dashboard .stat-card h3')[2].textContent = narasumber.length || '0';
            document.querySelectorAll('#admin-section-dashboard .stat-card h3')[3].textContent = laporan.length || '0';
            
            // Update dashboard table with first 5 peserta
            const dashboardTbody = document.getElementById('dashboardTableBody');
            if (dashboardTbody) {
                dashboardTbody.innerHTML = '';
                const dashboardPeserta = peserta.slice(0, 5);
                dashboardPeserta.forEach((item, index) => {
                    const statusBadge = item.status === 'aktif' ? '<span class="badge bg-success">Aktif</span>' : 
                                        item.status === 'proses' ? '<span class="badge bg-warning">Proses</span>' : 
                                        '<span class="badge bg-secondary">Non-Aktif</span>';
                    dashboardTbody.innerHTML += `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${item.nip}</td>
                            <td>${item.nama}</td>
                            <td>${item.unit}</td>
                            <td>${statusBadge}</td>
                            <td>
                                <button class="btn btn-action btn-action-edit btn-sm" onclick="editPeserta('${item.id}')"><i class="fas fa-edit"></i></button>
                                <button class="btn btn-action btn-action-delete btn-sm" onclick="deletePeserta('${item.id}')"><i class="fas fa-trash"></i></button>
                            </td>
                        </tr>
                    `;
                });
                
                if (peserta.length === 0) {
                    dashboardTbody.innerHTML = '<tr><td colspan="6" class="text-center">Belum ada data peserta. Tambahkan data peserta melalui menu Data Peserta.</td></tr>';
                }
            }
        }
        
        // ========== SAVE DATA WITH CRUD ==========
        
        // Login Admin Handler
        document.getElementById('adminLoginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const username = document.getElementById('adminUsername').value;
            const password = document.getElementById('adminPassword').value;
            
            // Admin credentials validation
            if (username === 'admin' && password === 'admin') {
                showAdminDashboard();
            } else {
                alert('Username atau password salah!');
            }
        });
        
        // Logout Admin
        function logoutAdmin() {
            showAdminLogin();
            document.getElementById('adminUsername').value = '';
            document.getElementById('adminPassword').value = '';
        }
        
        // Show Add Modal
        function showAddModal(type) {
            currentEditType = type;
            const modalElement = document.getElementById('addModal');
            const modal = new bootstrap.Modal(modalElement);
            const titleMap = {
                'kegiatan': 'Tambah Kegiatan',
                'narasumber': 'Tambah Narasumber',
                'peserta': 'Tambah Peserta',
                'laporan': 'Tambah Laporan'
            };
            
            document.getElementById('modalTitle').textContent = titleMap[type] || 'Tambah Data';
            document.getElementById('addDataForm').reset();
            document.getElementById('modalId').value = '';
            
            // Reset all fields first
            const allFields = ['modalNIP', 'modalNama', 'modalEmail', 'modalUnit', 'modalJabatan', 'modalStatus', 'modalTanggal', 'modalKuota', 'modalSpesialisasi', 'modalInstitusi', 'modalJudul', 'modalJenis'];
            allFields.forEach(id => {
                const el = document.getElementById(id);
                if (el) {
                    el.parentElement.style.display = 'block';
                    el.required = false;
                }
            });
            
            // Hide all fields
            document.querySelectorAll('#addDataForm .col-md-6').forEach(el => el.style.display = 'none');
            
            // Show relevant fields based on type
            if (type === 'kegiatan') {
                document.getElementById('modalNama').parentElement.style.display = 'block';
                document.getElementById('modalTanggal').parentElement.style.display = 'block';
                document.getElementById('modalTanggal').querySelector('label').textContent = 'Tanggal *';
                document.getElementById('modalTanggal').type = 'text';
                document.getElementById('modalTanggal').placeholder = 'Contoh: 15-17 Feb 2026';
                document.getElementById('modalKuota').parentElement.style.display = 'block';
                document.getElementById('modalStatus').parentElement.style.display = 'block';
                document.getElementById('modalStatus').innerHTML = `
                    <option value="akan-datang">Akan Datang</option>
                    <option value="pendaftaran-terbuka">Pendaftaran Terbuka</option>
                    <option value="selesai">Selesai</option>
                `;
            } else if (type === 'narasumber') {
                document.getElementById('modalNIP').parentElement.style.display = 'block';
                document.getElementById('modalNIP').querySelector('label').textContent = 'NIP *';
                document.getElementById('modalNama').parentElement.style.display = 'block';
                document.getElementById('modalEmail').parentElement.style.display = 'block';
                document.getElementById('modalSpesialisasi').parentElement.style.display = 'block';
                document.getElementById('modalSpesialisasi').querySelector('label').textContent = 'Spesialisasi *';
                document.getElementById('modalInstitusi').parentElement.style.display = 'block';
                document.getElementById('modalInstitusi').querySelector('label').textContent = 'Institusi *';
            } else if (type === 'peserta') {
                document.getElementById('modalNIP').parentElement.style.display = 'block';
                document.getElementById('modalNIP').querySelector('label').textContent = 'NIP *';
                document.getElementById('modalNama').parentElement.style.display = 'block';
                document.getElementById('modalEmail').parentElement.style.display = 'block';
                document.getElementById('modalUnit').parentElement.style.display = 'block';
                document.getElementById('modalJabatan').parentElement.style.display = 'block';
                document.getElementById('modalStatus').parentElement.style.display = 'block';
                document.getElementById('modalStatus').innerHTML = `
                    <option value="aktif">Aktif</option>
                    <option value="proses">Proses</option>
                    <option value="nonaktif">Non-Aktif</option>
                `;
            } else if (type === 'laporan') {
                document.getElementById('modalJudul').parentElement.style.display = 'block';
                document.getElementById('modalJudul').querySelector('label').textContent = 'Judul Laporan *';
                document.getElementById('modalJenis').parentElement.style.display = 'block';
                document.getElementById('modalJenis').querySelector('label').textContent = 'Jenis Laporan *';
                document.getElementById('modalJenis').innerHTML = `
                    <option value="">Pilih Jenis...</option>
                    <option value="Bulanan">Bulanan</option>
                    <option value="Evaluasi">Evaluasi</option>
                    <option value="Semester">Semester</option>
                    <option value="Tahunan">Tahunan</option>
                `;
            }
            
            modal.show();
        }
        
        async function saveData() {
            const editId = document.getElementById('modalId').value;
            let dataToSend = null;
            let saveCallback = null;
            
            if (currentEditType === 'kegiatan') {
                dataToSend = {
                    id: editId || 'NEW',
                    nama: document.getElementById('modalNama').value,
                    tanggal: document.getElementById('modalTanggal').value,
                    kuota: document.getElementById('modalKuota').value,
                    status: document.getElementById('modalStatus').value
                };
                
                if (!dataToSend.nama || !dataToSend.tanggal) {
                    alert('Mohon lengkapi data kegiatan!');
                    return;
                }
                
                saveCallback = function(result) {
                    loadKegiatanData();
                    alert('Data kegiatan berhasil disimpan!');
                };
                
            } else if (currentEditType === 'narasumber') {
                const nip = document.getElementById('modalNIP').value;
                const nipError = document.getElementById('nipError');
                const allData = await fetchDataFromGoogleSheets(SHEET_NAMES['narasumber']);
                
                // Check duplicate NIP (only for new data)
                if (!editId && allData.some(d => d.nip === nip)) {
                    nipError.style.display = 'block';
                    return;
                }
                nipError.style.display = 'none';
                
                dataToSend = {
                    id: editId || 'NEW',
                    nip: nip,
                    nama: document.getElementById('modalNama').value,
                    email: document.getElementById('modalEmail').value,
                    spesialisasi: document.getElementById('modalSpesialisasi').value,
                    institusi: document.getElementById('modalInstitusi').value
                };
                
                if (!nip || !dataToSend.nama || !dataToSend.spesialisasi || !dataToSend.institusi) {
                    alert('Mohon lengkapi data narasumber!');
                    return;
                }
                
                saveCallback = function(result) {
                    loadNarasumberData();
                    alert('Data narasumber berhasil disimpan!');
                };
                
            } else if (currentEditType === 'peserta') {
                const nip = document.getElementById('modalNIP').value;
                const nipError = document.getElementById('nipError');
                const allData = await fetchDataFromGoogleSheets(SHEET_NAMES['peserta']);
                
                // Check duplicate NIP (only for new data)
                if (!editId && allData.some(d => d.nip === nip)) {
                    nipError.style.display = 'block';
                    return;
                }
                nipError.style.display = 'none';
                
                dataToSend = {
                    id: editId || 'NEW',
                    nip: nip,
                    nama: document.getElementById('modalNama').value,
                    email: document.getElementById('modalEmail').value,
                    unit: document.getElementById('modalUnit').value,
                    jabatan: document.getElementById('modalJabatan').value,
                    status: document.getElementById('modalStatus').value
                };
                
                if (!nip || !dataToSend.nama) {
                    alert('Mohon lengkapi data peserta!');
                    return;
                }
                
                saveCallback = function(result) {
                    loadPesertaData();
                    alert('Data peserta berhasil disimpan!');
                };
                
            } else if (currentEditType === 'laporan') {
                dataToSend = {
                    id: editId || 'NEW',
                    judul: document.getElementById('modalJudul').value,
                    jenis: document.getElementById('modalJenis').value,
                    tanggal: new Date().toLocaleDateString('id-ID'),
                    status: 'draft'
                };
                
                if (!dataToSend.judul || !dataToSend.jenis) {
                    alert('Mohon lengkapi data laporan!');
                    return;
                }
                
                saveCallback = function(result) {
                    loadLaporanData();
                    alert('Data laporan berhasil disimpan!');
                };
            }
            
            if (dataToSend) {
                await saveDataToGoogleSheets(currentEditType, dataToSend);
                if (saveCallback) saveCallback({ success: true });
            }
            
            const modal = bootstrap.Modal.getInstance(document.getElementById('addModal'));
            modal.hide();
            document.getElementById('addDataForm').reset();
        }
        
        // Import Data
        function importData() {
            document.getElementById('importFileInput').click();
        }
        
        // Feedback Form Handler
        document.getElementById('feedbackForm').addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Terima kasih! Saran/Komplain Anda telah kami terima dan akan segera ditindaklanjuti.');
            this.reset();
        });
        
        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function(e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({ behavior: 'smooth' });
                }
            });
        });
        
        // NIP validation on input
        document.getElementById('modalNIP').addEventListener('input', function() {
            const existingNIPs = ['198501012010011001', '198603152010012002'];
            const nipError = document.getElementById('nipError');
            
            if (existingNIPs.includes(this.value)) {
                nipError.style.display = 'block';
            } else {
                nipError.style.display = 'none';
            }
        });
        
        // ========== POPUP FUNCTIONS ==========
        
        // URL Konfigurasi (UBAH DISINI)
        const PENDAFTARAN_URL = 'dashboardsipandaiasn.html'; // Ganti dengan URL formulir pendaftaran Anda
        
        function openPendaftaranUrl() {
            if (PENDAFTARAN_URL) {
                window.open(PENDAFTARAN_URL, '_blank');
            } else {
                alert('URL Formulir Pendaftaran belum diatur!');
            }
        }
        
        // Show Sertifikat Popup
        let sertifikatTimeout = null;
        
        function showSertifikatPopup(url, title) {
            document.getElementById('sertifikatTitle').textContent = title;
            document.getElementById('sertifikatDownloadLink').href = url;
            
            const countdownContainer = document.getElementById('countdownContainer');
            const countdownTimer = document.getElementById('countdownTimer');
            
            countdownContainer.style.display = 'block';
            let count = 5;
            countdownTimer.textContent = count;
            
            // Clear previous timeout
            if (sertifikatTimeout) clearTimeout(sertifikatTimeout);
            
            sertifikatTimeout = setTimeout(function() {
                countdownContainer.style.display = 'none';
            }, 5000);
            
            const modal = new bootstrap.Modal(document.getElementById('sertifikatModal'));
            modal.show();
        }
        
        // Show Galeri Popup
        function openGaleriPopup(folderId, title, tanggal, mapsUrl) {
            document.getElementById('galeriTitle').textContent = title;
            document.getElementById('galeriTanggal').textContent = tanggal;
            document.getElementById('galeriFolderId').textContent = folderId;
            document.getElementById('galeriMaps').href = mapsUrl;
            document.getElementById('galeriDriveLink').href = 'https://drive.google.com/drive/folders/' + folderId;
            
            const modal = new bootstrap.Modal(document.getElementById('galeriModal'));
            modal.show();
        }
    </script>
</body>
</html>
