<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Form Pendaftaran Pengembangan Kompetensi ASN</title>

<style>
body{
  font-family:Segoe UI,Arial,sans-serif;
  background:#eef2f7;
  padding:20px
}
.container{
  max-width:1150px;
  margin:auto;
  padding:22px;
  background:#f8fafc;
  border-radius:18px;
  box-shadow:0 12px 35px rgba(0,0,0,.12)
}
h2{text-align:center;margin-bottom:22px}

/* INFO */
.info-kegiatan{
  background:linear-gradient(135deg,#ecfeff,#f0fdf4);
  border-radius:18px;
  padding:20px;
  margin-bottom:24px;
  box-shadow:0 8px 25px rgba(0,0,0,.08)
}
.info-kegiatan h3{text-align:center;color:#0f766e}
.info-item{
  display:grid;
  grid-template-columns:200px 1fr;
  gap:12px;
  margin-bottom:12px
}
.info-item .label{font-weight:800}
@media(max-width:640px){
  .info-item{grid-template-columns:1fr}
}

/* INPUT */
input,select{
  width:100%;
  padding:12px;
  margin-bottom:12px;
  border-radius:12px;
  border:1px solid #ddd
}
label{font-weight:700}

/* BUTTON GROUP */
.btn-group{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(140px,1fr));
  gap:10px;
  margin-bottom:14px
}
.btn-group button{
  padding:12px;
  border:none;
  border-radius:14px;
  background:#e5e7eb;
  font-weight:700;
  cursor:pointer
}
.btn-group button.active{
  background:#2563eb;
  color:#fff;
  transform:scale(1.05)
}

/* SUBMIT */
.submit-btn{
  width:100%;
  padding:16px;
  border:none;
  border-radius:16px;
  background:linear-gradient(135deg,#16a34a,#22c55e);
  color:#fff;
  font-weight:900;
  cursor:pointer
}

/* COUNTER */
.counter-box{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:12px;
  margin-bottom:18px
}
.counter-item{
  background:linear-gradient(135deg,#e0f2fe,#f0fdf4);
  padding:14px;
  border-radius:16px;
  text-align:center;
  font-weight:800
}
.counter-item span{
  display:block;
  font-size:28px;
  color:#16a34a
}
.badge{
  grid-column:1/-1;
  text-align:center;
  padding:12px;
  border-radius:14px;
  background:#dc2626;
  color:#fff;
  font-weight:900;
  animation:pulse 1.5s infinite
}
.hidden{display:none}

/* PROGRESS */
.progress-bar-bg{
  background:#e5e7eb;
  border-radius:14px;
  overflow:hidden
}
.progress-bar{
  height:22px;
  width:0%;
  background:linear-gradient(135deg,#22c55e,#16a34a);
  text-align:center;
  color:white;
  font-weight:900
}

#notif{text-align:center;margin-top:18px;font-weight:800}

@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.05)}
  100%{transform:scale(1)}
}
</style>
</head>

<body>

<div class="container">
<h2>ðŸ“‹ Form Pendaftaran Pengembangan Kompetensi ASN</h2>

<!-- INFO -->
<div class="info-kegiatan">
  <h3>ðŸ“Œ Informasi Kegiatan</h3>
  <div class="info-item"><div class="label">Tema</div><div>Optimalisasi Pemanfaatan SKP Platform</div></div>
  <div class="info-item"><div class="label">Jadwal</div><div>22 Januari 2026 â€¢ 13.00â€“16.00</div></div>
  <div class="info-item"><div class="label">JP</div><div>2 JP</div></div>
</div>

<!-- COUNTER -->
<div class="counter-box">
  <div class="counter-item">ðŸ‘¥ Total<span id="total">0</span></div>
  <div class="counter-item">ðŸŽ¥ Zoom<span id="zoom">0</span></div>
  <div class="counter-item">ðŸ“º YouTube<span id="youtube">0</span></div>
  <div id="badge" class="badge hidden">ðŸ”¥ Hampir Penuh</div>
</div>

<!-- PROGRESS -->
<div style="margin-bottom:16px">
  <div style="font-weight:800;margin-bottom:6px">ðŸ“Š Progress Kuota</div>
  <div class="progress-bar-bg">
    <div id="progressBar" class="progress-bar">0%</div>
  </div>
</div>

<form id="daftarForm">
  <input id="nama" placeholder="Nama Lengkap" required>
  <input id="nip" placeholder="NIP" required>
  <input id="unit" placeholder="Unit Kerja" required>

  <label>Status</label>
  <div class="btn-group">
    <button type="button" onclick="pilih(this,'status','PNS')">PNS</button>
    <button type="button" onclick="pilih(this,'status','PPPK')">PPPK</button>
  </div>

  <label>Platform</label>
  <div class="btn-group">
    <button type="button" onclick="pilih(this,'platform','Zoom')">Zoom</button>
    <button type="button" onclick="pilih(this,'platform','Youtube')">YouTube</button>
  </div>

  <button class="submit-btn">ðŸš€ KIRIM PENDAFTARAN</button>
</form>

<div id="notif"></div>
</div>

<script>
/* ================= KONFIG ================= */
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbyT3neA_9261WtgHunupLUM_SikAc91wwnFfjDVUGxFo6GIbIgTtwUj7qbBlL8ncnvv0Q/exec";
const REKAP_URL  = WEBAPP_URL + "?mode=rekap";
const KUOTA_MAKS = 300;
let pilihan = {}, isSubmitting=false;

/* ================= PILIH ================= */
function pilih(el,f,v){
  el.parentElement.querySelectorAll("button").forEach(b=>b.classList.remove("active"));
  el.classList.add("active");
  pilihan[f]=v;
}

/* ================= SUBMIT ================= */
daftarForm.addEventListener("submit",e=>{
  e.preventDefault();
  if(!pilihan.status||!pilihan.platform){
    notif.innerHTML="âš ï¸ Lengkapi pilihan";
    return;
  }
  if(isSubmitting) return;
  isSubmitting=true;
  notif.innerHTML="â³ Mengirim...";

  const fd=new FormData();
  fd.append("nama",nama.value);
  fd.append("nip",nip.value);
  fd.append("unit",unit.value);
  fd.append("status",pilihan.status);
  fd.append("platform",pilihan.platform);

  fetch(WEBAPP_URL,{method:"POST",body:fd})
    .then(r=>r.text())
    .then(()=>{
      notif.innerHTML="âœ… Berhasil";
      daftarForm.reset();
      document.querySelectorAll(".btn-group button").forEach(b=>b.classList.remove("active"));
      loadRekap();
      isSubmitting=false;
    })
    .catch(()=>{notif.innerHTML="âŒ Gagal";isSubmitting=false});
});

/* ================= REKAP ================= */
function loadRekap(){
  fetch(REKAP_URL)
    .then(r=>r.json())
    .then(d=>{
      total.textContent=d.total;
      zoom.textContent=d.zoom;
      youtube.textContent=d.youtube;

      const persen=Math.min(100,Math.round((d.total/KUOTA_MAKS)*100));
      progressBar.style.width=persen+"%";
      progressBar.textContent=persen+"%";

      if(persen>=80) badge.classList.remove("hidden");
      else badge.classList.add("hidden");
    });
}
loadRekap();
setInterval(loadRekap,30000);
</script>

</body>
</html>
