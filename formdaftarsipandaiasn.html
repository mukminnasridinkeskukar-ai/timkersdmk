<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Form Pendaftaran Pengembangan Kompetensi ASN</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:'Segoe UI',Arial,sans-serif;
  background:linear-gradient(135deg,#eef2ff,#f8fafc);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
  padding:20px;
}
.container{
  width:100%;
  max-width:820px;
  background:#ffffff;
  padding:30px;
  border-radius:22px;
  box-shadow:0 20px 45px rgba(0,0,0,.15);
}
h2{
  text-align:center;
  margin-bottom:25px;
  color:#1e293b;
}
label{
  display:block;
  margin-top:14px;
  font-weight:600;
}
input,select{
  width:100%;
  margin-top:6px;
  padding:12px 14px;
  border-radius:12px;
  border:1px solid #c7d2fe;
  font-size:14px;
}
.row{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:14px;
}
@media(max-width:640px){
  .row{grid-template-columns:1fr}
}
button{
  margin-top:24px;
  width:100%;
  padding:15px;
  border:none;
  border-radius:18px;
  background:linear-gradient(135deg,#2563eb,#1d4ed8);
  color:white;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}
button:disabled{
  opacity:.7;
  cursor:not-allowed;
}
#notif{
  margin-top:16px;
  text-align:center;
  font-weight:700;
}
.spinner{
  width:20px;
  height:20px;
  border:3px solid #fff;
  border-top:3px solid transparent;
  border-radius:50%;
  display:inline-block;
  animation:spin 1s linear infinite;
  vertical-align:middle;
  margin-right:8px;
}
@keyframes spin{
  to{transform:rotate(360deg)}
}
</style>
</head>

<body>

<div class="container">
<h2>üìã Form Pendaftaran Pengembangan Kompetensi ASN</h2>

<form id="formDaftar">

<label>Nama Lengkap</label>
<input id="nama" required>

<div class="row">
  <div>
    <label>NIP</label>
    <input id="nip" required>
  </div>
  <div>
    <label>Unit Kerja</label>
    <input id="unit" required>
  </div>
</div>

<label>Status Pegawai</label>
<select id="status" required>
  <option value="">-- Pilih --</option>
  <option>PNS</option>
  <option>PPPK</option>
</select>

<label>Jenis SDMK</label>
<select id="jenis" required>
  <option value="">-- Pilih --</option>
  <option>Tenaga Medis</option>
  <option>Tenaga Kesehatan</option>
  <option>Tenaga Penunjang</option>
</select>

<div class="row">
  <div>
    <label>Jumlah JP Terakhir</label>
    <input id="jp_terakhir" type="number" required>
  </div>
  <div>
    <label>Jumlah JP</label>
    <input id="jp" type="number" required>
  </div>
</div>

<label>Tema Pembelajaran</label>
<input id="tema" required>

<label>Tanggal Kegiatan</label>
<input id="tanggal" type="date" required>

<label>Platform Digital</label>
<select id="platform" required>
  <option value="">-- Pilih --</option>
  <option>Zoom</option>
  <option>Youtube</option>
</select>

<label>Whatsapp / Telpon</label>
<input id="wa" required>

<label>Email Aktif</label>
<input id="email" type="email" required>

<button id="btnSubmit" type="submit">üöÄ KIRIM PENDAFTARAN</button>
</form>

<div id="notif"></div>
</div>

<script>
/* ================= CONFIG ================= */
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbx0Su64h-CTAyDu5IxqqjK6OSaUnzzxP5WVBKCZ6ESaaMk9ow9jk2cXLEs3lrzgpyLrrA/exec";
const DASHBOARD_URL = "/jadwal.html"; // ganti sesuai halaman jadwal kamu

const form  = document.getElementById("formDaftar");
const notif = document.getElementById("notif");
const btn   = document.getElementById("btnSubmit");

/* ================= SUBMIT ================= */
form.addEventListener("submit", async (e) => {
  e.preventDefault();

  // LOCK BUTTON
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span> Mengirim...';
  notif.innerHTML = "‚è≥ Mohon tunggu, data sedang diproses...";

  const data = {
    nama: nama.value.trim(),
    nip: nip.value.trim(),
    unit: unit.value.trim(),
    status: status.value,
    jenis: jenis.value,
    jp_terakhir: jp_terakhir.value,
    tema: tema.value.trim(),
    tanggal: tanggal.value,
    jp: jp.value,
    platform: platform.value,
    wa: wa.value.trim(),
    email: email.value.trim()
  };

  try {
    const res = await fetch(WEBAPP_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    const result = await res.json();

    if (!result.success) {
      throw new Error(result.message);
    }

    notif.innerHTML = "‚úÖ Pendaftaran berhasil. Mengalihkan ke dashboard...";

    // JEDA 2 DETIK ‚Üí REDIRECT
    setTimeout(() => {
      window.location.href = DASHBOARD_URL;
    }, 2000);

  } catch (err) {
    console.error(err);
    notif.innerHTML = "‚ùå Gagal menyimpan data: " + err.message;
    btn.disabled = false;
    btn.innerHTML = "üöÄ KIRIM PENDAFTARAN";
  }
});
</script>

</body>
</html>
