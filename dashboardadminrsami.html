<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8">
<title>Dashboard SDMK</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{margin:0;font-family:Segoe UI,Arial,sans-serif;background:#f1f5f9}
.hidden{display:none}

/* LOGIN */
.login{
  position:fixed;inset:0;display:flex;
  align-items:center;justify-content:center;
  background:#020617;
}
.login-box{
  width:340px;padding:24px;border-radius:16px;
  background:#111827;color:#fff;
}
.login-box h2{text-align:center}
.login-box input{
  width:100%;margin-top:10px;padding:10px;
  border-radius:10px;border:none;
}
.login-box button{
  width:100%;margin-top:12px;padding:10px;
  border:none;border-radius:10px;
  background:#2563eb;color:#fff;
}

/* DASHBOARD */
.dash{padding:16px}
.top{display:flex;justify-content:space-between;align-items:center}
.logout{background:#ef4444;color:#fff;border:none;padding:6px 12px;border-radius:8px}

input,select{padding:8px;margin:6px 0}

table{
  width:100%;border-collapse:collapse;background:#fff;margin-top:10px
}
th,td{border:1px solid #e5e7eb;padding:8px}
th{background:#f8fafc}
tbody tr:hover{background:#f9fafb;cursor:pointer}
img.thumb{width:42px;height:42px;border-radius:50%}

/* MODAL */
.modal{
  position:fixed;inset:0;background:rgba(0,0,0,.7);
  display:flex;align-items:center;justify-content:center;
  visibility:hidden;opacity:0;
}
.modal.show{visibility:visible;opacity:1}
.modal-box{
  background:#fff;padding:20px;border-radius:16px;
  width:95%;max-width:800px;max-height:90vh;overflow:auto;
}
.modal-box img{width:160px;border-radius:14px}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="login" id="loginWrap">
  <div class="login-box">
    <h2>üîê Admin</h2>
    <input id="user" placeholder="Username">
    <input id="pass" type="password" placeholder="Password">
    <button onclick="login()">Masuk</button>
    <div id="err" style="color:#fecaca;text-align:center"></div>
  </div>
</div>

<!-- DASHBOARD -->
<div class="dash hidden" id="dashWrap">
  <div class="top">
    <h3>üìã Dashboard Peminat SDMK</h3>
    <button class="logout" onclick="logout()">Logout</button>
  </div>

  <input id="search" placeholder="üîç Cari Nama">

  <table id="tbl">
    <thead>
      <tr>
        <th>Foto</th>
        <th>Nama</th>
        <th>JK</th>
        <th>Pendidikan</th>
        <th>Jurusan</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<!-- MODAL -->
<div class="modal" id="modal" onclick="closeModal(event)">
  <div class="modal-box">
    <img id="mFoto"><br><br>
    <div id="mData"></div>
  </div>
</div>

<script>
/* CONFIG */
const ADMIN_USER="rsudami";
const ADMIN_PASS="muarabadak";
const URL="https://script.google.com/macros/s/AKfycbye5mnDcMD_JjPC0kYHAYMDrAFjbLhycO2UYsQ0qrynXMNNAlhO-zQmo1JS0lsILY-G/exec";
let dataAll=[];

/* LOGIN */
function login(){
  if(user.value===ADMIN_USER && pass.value===ADMIN_PASS){
    localStorage.setItem("login","1");
    showDash();
  }else err.textContent="Login salah";
}
function logout(){localStorage.clear();location.reload()}
if(localStorage.getItem("login")==="1") showDash();

function showDash(){
  loginWrap.style.display="none";
  dashWrap.classList.remove("hidden");
  loadData();
}

/* LOAD DATA */
function loadData(){
  fetch(URL).then(r=>r.json()).then(d=>{
    dataAll=d;
    render();
  });
}

search.oninput=render;

function render(){
  const q=search.value.toLowerCase();
  const d=dataAll.filter(r=>
    r["Nama Lengkap & Gelar"].toLowerCase().includes(q)
  );

  tbl.querySelector("tbody").innerHTML=d.map((r,i)=>`
    <tr onclick="openModal(${i})">
      <td><img class="thumb" src="https://lh3.googleusercontent.com/d/${r["ID FOTO DRIVE"]}=s96"></td>
      <td>${r["Nama Lengkap & Gelar"]}</td>
      <td>${r["Jenis Kelamin"]}</td>
      <td>${r["Pendidikan"]}</td>
      <td>${r["Jurusan / Keahlian"]}</td>
    </tr>
  `).join("");
}

/* MODAL */
function openModal(i){
  const r=dataAll[i];
  modal.classList.add("show");
  mFoto.src=`https://lh3.googleusercontent.com/d/${r["ID FOTO DRIVE"]}=s400`;
  mData.innerHTML=`
    <b>Nama</b>: ${r["Nama Lengkap & Gelar"]}<br>
    <b>Jenis Kelamin</b>: ${r["Jenis Kelamin"]}<br>
    <b>Alamat Domisili</b>: ${r["Alamat Domisili"]}<br>
    <b>Pendidikan</b>: ${r["Pendidikan"]}<br>
    <b>Jurusan / Keahlian</b>: ${r["Jurusan / Keahlian"]}
  `;
}
function closeModal(e){
  if(e.target===modal) modal.classList.remove("show");
}
</script>

</body>
</html>
