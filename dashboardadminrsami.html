<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Dashboard SDMK</title>

<style>
body{margin:0;font-family:Segoe UI,sans-serif;background:#050814;color:#eaf3ff}
.hidden{display:none}
.login{height:100vh;display:flex;align-items:center;justify-content:center}
.box{background:#0e1738;padding:30px;border-radius:16px;width:320px}
input,button{width:100%;padding:10px;margin-top:10px;border-radius:8px;border:none}
button{background:#00f7ff;font-weight:bold;cursor:pointer}
.dashboard{padding:20px;display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:20px}
.card{background:#0e1738;padding:15px;border-radius:16px;cursor:pointer}
</style>
</head>

<body>

<!-- LOGIN -->
<div class="login" id="login">
  <div class="box">
    <h3>Login Admin</h3>
    <input id="user" placeholder="Username">
    <input id="pass" type="password" placeholder="Password">
    <button onclick="login()">Login</button>
    <div id="msg"></div>
  </div>
</div>

<!-- APP -->
<div id="app" class="hidden">
  <h2 style="text-align:center">Dashboard SDMK</h2>
  <div class="dashboard" id="dashboard"></div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbxf2-yo51Ebcwfau5IrIEJ8kad6czhY1e4nX3oKA5xHibwV0TsXG4KQ3hVy5Sl5y4-L/exec";
let SESSION = localStorage.getItem("sdmk_session");

/******** LOGIN ********/
function login(){
  fetch(API,{
    method:"POST",
    body:JSON.stringify({
      action:"login",
      username:user.value,
      password:pass.value
    })
  })
  .then(r=>r.json())
  .then(r=>{
    if(r.success){
      SESSION = r.session;
      localStorage.setItem("sdmk_session",SESSION);
      showApp();
    }else{
      msg.innerText="Login gagal";
    }
  });
}

/******** LOAD DATA ********/
function showApp(){
  login.classList.add("hidden");
  app.classList.remove("hidden");

  fetch(`${API}?session=${SESSION}`)
  .then(r=>r.json())
  .then(data=>{
    dashboard.innerHTML="";
    data.forEach(d=>{
      dashboard.innerHTML+=`
        <div class="card">
          <b>${d["Nama Lengkap & Gelar"]}</b><br>
          ${d["Jenis SDMK"]}
        </div>
      `;
    });
  });
}

// AUTO LOGIN
if(SESSION) showApp();
</script>

</body>
</html>
