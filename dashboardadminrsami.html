<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Dashboard SDMK</title>

<style>
body{
  margin:0;
  font-family:Segoe UI,Arial,sans-serif;
  background:linear-gradient(120deg,#0a0f2c,#050814);
  color:#eaf1ff;
}

header{
  padding:28px;
  text-align:center;
  font-size:28px;
  font-weight:700;
}

.tools{
  padding:0 30px 20px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
  justify-content:center;
}

.tools input,.tools select{
  padding:10px 14px;
  border-radius:10px;
  border:none;
  font-size:14px;
  min-width:220px;
}

.grid{
  padding:30px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(260px,1fr));
  gap:24px;
}

.card{
  background:linear-gradient(145deg,#121a3a,#0a1026);
  border-radius:20px;
  padding:18px;
  cursor:pointer;
  transition:.3s;
}

.card:hover{
  transform:translateY(-6px);
  box-shadow:0 20px 40px rgba(0,0,0,.5);
}

.card img{
  width:100%;
  height:240px;
  object-fit:cover;
  border-radius:16px;
}

.card h3{
  margin:14px 0 4px;
  font-size:18px;
}

.card small{opacity:.7}

/* MODAL */
.modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.9);
  display:none;
  z-index:999;
}

.modal-content{
  max-width:1200px;
  margin:40px auto;
  background:#0e1538;
  border-radius:24px;
  padding:25px;
}

.modal-grid{
  display:grid;
  grid-template-columns:360px 1fr;
  gap:30px;
}

.modal img{
  width:100%;
  border-radius:18px;
  cursor:pointer;
}

.label{
  font-size:12px;
  opacity:.6;
}

.value{
  margin-bottom:10px;
}

.close{
  text-align:right;
  margin-bottom:10px;
}

.close button{
  background:#ff4b4b;
  border:none;
  color:#fff;
  padding:8px 16px;
  border-radius:10px;
  cursor:pointer;
}

@media(max-width:900px){
  .modal-grid{grid-template-columns:1fr}
}
</style>
</head>

<body>

<header>DASHBOARD DATA SDMK</header>

<div class="tools">
  <input id="search" placeholder="Cari Nama atau NIK">
  <select id="filter">
    <option value="">Semua Jenis SDMK</option>
  </select>
</div>

<div class="grid" id="grid"></div>

<div class="modal" id="modal">
  <div class="modal-content">
    <div class="close">
      <button onclick="closeModal()">Tutup</button>
    </div>
    <div class="modal-grid" id="modalBody"></div>
  </div>
</div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbwFU8qgdIHrL28zR-QxWuz34GCz_5_z6r1RV7DubKN7ttwezDrxP57B4bQJ8pzJcJMp/exec";

let DATA=[];

fetch(API_URL)
.then(r=>r.json())
.then(d=>{
  DATA=d;
  buildFilter();
  render();
});

search.oninput = render;
filter.onchange = render;

function buildFilter(){
  const jenis = [...new Set(DATA.map(d=>d["Jenis SDMK"]))];
  jenis.forEach(j=>{
    const opt=document.createElement("option");
    opt.value=j;
    opt.textContent=j;
    filter.appendChild(opt);
  });
}

function render(){
  const q = search.value.toLowerCase();
  const f = filter.value;
  grid.innerHTML="";

  DATA.filter(d=>{
    return (!f || d["Jenis SDMK"]===f) &&
      (
        (d["Nama Lengkap & Gelar"]||"").toLowerCase().includes(q) ||
        (d["NIK"]||"").toLowerCase().includes(q)
      );
  }).forEach(d=>{
    const foto = `https://lh3.googleusercontent.com/d/${(d["ID FOTO DRIVE"]||"").trim()}`;
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <img src="${foto}">
      <h3>${d["Nama Lengkap & Gelar"]}</h3>
      <small>${d["Jenis SDMK"]}</small>
    `;
    card.onclick=()=>openModal(d,foto);
    grid.appendChild(card);
  });
}

function openModal(d,foto){
  modal.style.display="block";
  modalBody.innerHTML=`
    <img src="${foto}" onerror="this.src='https://via.placeholder.com/400x500?text=No+Photo'">
    <div>
      ${Object.entries(d).map(([k,v])=>`
        <div class="label">${k}</div>
        <div class="value">${v||"-"}</div>
      `).join("")}
    </div>
  `;
}

function closeModal(){
  modal.style.display="none";
}
</script>

</body>
</html>
