<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Absensi SIPANDAI-ASN</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
:root{
  --primary:#0d6efd;
  --success:#28a745;
  --danger:#dc3545;
  --bg:#f1f4f9;
}
*{box-sizing:border-box}
body{
  margin:0;
  font-family:"Segoe UI",Arial,sans-serif;
  background:linear-gradient(135deg,#e9f0ff,#f8fbff);
  min-height:100vh;
  display:flex;
  align-items:center;
  justify-content:center;
}
.wrapper{
  width:100%;
  max-width:760px;
  padding:20px;
}
.card{
  background:#fff;
  border-radius:18px;
  box-shadow:0 20px 50px rgba(0,0,0,.15);
  overflow:hidden;
}
.header{
  background:linear-gradient(135deg,#0d6efd,#084298);
  color:#fff;
  padding:26px;
}
.header h1{
  margin:0;
  font-size:24px;
}
.header p{
  margin:6px 0 0;
  opacity:.9;
}
.content{
  padding:30px;
}
.section-title{
  font-weight:700;
  margin:25px 0 12px;
  color:#0d6efd;
}
label{
  font-weight:600;
  margin-top:16px;
  display:block;
}
input,select,textarea{
  width:100%;
  padding:14px;
  margin-top:6px;
  border-radius:12px;
  border:1.5px solid #d0d7e2;
  font-size:15px;
}
input:focus,select:focus,textarea:focus{
  outline:none;
  border-color:var(--primary);
  box-shadow:0 0 0 3px rgba(13,110,253,.15);
}
textarea{resize:vertical}
.btn{
  margin-top:30px;
  width:100%;
  padding:16px;
  border:none;
  border-radius:14px;
  font-size:16px;
  font-weight:700;
  background:linear-gradient(135deg,#0d6efd,#084298);
  color:#fff;
  cursor:pointer;
  transition:.2s;
}
.btn:disabled{
  opacity:.7;
  cursor:not-allowed;
}
.status{
  margin-top:18px;
  padding:14px;
  border-radius:12px;
  display:none;
  font-weight:600;
}
.status.success{
  background:#e9f8ef;
  color:#1e7e34;
}
.status.error{
  background:#fdecea;
  color:#b02a37;
}
.footer{
  text-align:center;
  padding:14px;
  font-size:13px;
  color:#777;
  background:#f8f9fa;
}
</style>
</head>

<body>

<div class="wrapper">
<div class="card">

  <div class="header">
    <h1>Absensi SIPANDAI-ASN</h1>
    <p>Dinas Kesehatan • Kehadiran & Evaluasi Kegiatan</p>
  </div>

  <div class="content">
    <form id="form">

      <div class="section-title">Identitas Peserta</div>

      <label>Nama Lengkap</label>
      <input id="nama" placeholder="Nama sesuai identitas" required>

      <label>NIP</label>
      <input id="nip" placeholder="Nomor Induk Pegawai" required>

      <label>Email Aktif</label>
      <input type="email" id="email" placeholder="email@domain.go.id" required>

      <label>Platform Digital yang Digunakan</label>
      <select id="platform" required>
        <option value="">-- Pilih Platform --</option>
        <option value="Zoom Meeting">Zoom Meeting</option>
        <option value="YouTube">YouTube</option>
      </select>

      <div class="section-title">Evaluasi Kegiatan</div>

      <label>Evaluasi Penyelenggara</label>
      <select id="evalPenyelenggara" required>
        <option value="">-- Pilih --</option>
        <option>Sangat Baik</option>
        <option>Baik</option>
        <option>Cukup</option>
        <option>Kurang</option>
      </select>

      <label>Evaluasi Fasilitator / Narasumber</label>
      <select id="evalNarasumber" required>
        <option value="">-- Pilih --</option>
        <option>Sangat Baik</option>
        <option>Baik</option>
        <option>Cukup</option>
        <option>Kurang</option>
      </select>

      <label>Evaluasi Sarana Prasarana</label>
      <select id="evalSarana" required>
        <option value="">-- Pilih --</option>
        <option>Sangat Baik</option>
        <option>Baik</option>
        <option>Cukup</option>
        <option>Kurang</option>
      </select>

      <label>Komentar / Saran</label>
      <textarea id="komentar" rows="3" placeholder="Opsional"></textarea>

     <button type="submit" class="btn" id="submitBtn">KIRIM ABSENSI</button>

      <div class="status success" id="successMsg">
        ✅ Absensi berhasil dikirim. Menunggu proses validasi Admin SIPANDAI-ASN.
      </div>

      <div class="status error" id="errorMsg"></div>

    </form>
  </div>

  <div class="footer">
    Sistem Informasi Pengembangan ASN Dinas Kesehatan
  </div>

</div>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwqjOykmtEwpkiePZVyjfAS34NI7YeAPjZaAD11qtx24QkqIGSF0OCS09QyarqD9b87QQ/exec";

const form = document.getElementById("form");
const submitBtn = document.getElementById("submitBtn");
const successMsg = document.getElementById("successMsg");
const errorMsg = document.getElementById("errorMsg");

form.onsubmit = async e => {
  e.preventDefault();

  submitBtn.disabled = true;
  submitBtn.innerText = "Mengirim...";

  successMsg.style.display = "none";
  errorMsg.style.display = "none";

  const payload = {
    nama: nama.value,
    nip: nip.value,
    email: email.value,
    platform: platform.value,
    evalPenyelenggara: evalPenyelenggara.value,
    evalNarasumber: evalNarasumber.value,
    evalSarana: evalSarana.value,
    komentar: komentar.value
  };

  try {
    const res = await fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify(payload)
    });

    const out = await res.json();

    if (!out.success) {
      throw new Error(out.message || "Gagal mengirim absensi");
    }

    successMsg.style.display = "block";
    form.reset();

  } catch (err) {
    errorMsg.innerText = "❌ " + err.message;
    errorMsg.style.display = "block";
  } finally {
    submitBtn.disabled = false;
    submitBtn.innerText = "KIRIM ABSENSI";
  }
};
</script>


</body>
</html>
