<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PAK Integrasi - Dinas Kesehatan</title>
    <style>
        /* ============================================
           CSS VARIABLES - KEMENTERIAN THEME
           ============================================ */
        :root {
            --primary-color: #003366;
            --primary-dark: #002244;
            --primary-light: #004d99;
            --secondary-color: #0066cc;
            --accent-color: #ff9900;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
            --light-bg: #f8f9fa;
            --dark-text: #212529;
            --border-color: #dee2e6;
            --shadow: 0 4px 6px rgba(0,0,0,0.1);
            --shadow-lg: 0 10px 25px rgba(0,0,0,0.15);
            --transition: all 0.3s ease;
            --border-radius: 12px;
        }

        /* ============================================
           RESET & BASE STYLES
           ============================================ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #003366 0%, #004080 50%, #0059b3 100%);
            min-height: 100vh;
            color: var(--dark-text);
            overflow-x: hidden;
        }

        /* ============================================
           ANIMATIONS
           ============================================ */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(40px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes slideInLeft {
            from { opacity: 0; transform: translateX(-50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes slideInRight {
            from { opacity: 0; transform: translateX(50px); }
            to { opacity: 1; transform: translateX(0); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-15px); }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        @keyframes glow {
            0%, 100% { box-shadow: 0 0 5px rgba(0,102,204,0.5); }
            50% { box-shadow: 0 0 20px rgba(0,102,204,0.8); }
        }

        .animate-fade-in {
            animation: fadeIn 0.6s ease forwards;
        }

        .animate-fade-in-up {
            animation: fadeInUp 0.8s ease forwards;
        }

        .animate-slide-left {
            animation: slideInLeft 0.6s ease forwards;
        }

        .animate-slide-right {
            animation: slideInRight 0.6s ease forwards;
        }

        .animate-pulse {
            animation: pulse 2s infinite;
        }

        .animate-float {
            animation: float 3s ease-in-out infinite;
        }

        .delay-1 { animation-delay: 0.1s; }
        .delay-2 { animation-delay: 0.2s; }
        .delay-3 { animation-delay: 0.3s; }
        .delay-4 { animation-delay: 0.4s; }
        .delay-5 { animation-delay: 0.5s; }
        .delay-6 { animation-delay: 0.6s; }

        /* ============================================
           HEADER
           ============================================ */
        .header {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            padding: 15px 40px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            box-shadow: var(--shadow-lg);
            position: relative;
            overflow: hidden;
            z-index: 100;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 300%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            animation: shimmer 4s infinite;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 15px;
            color: white;
            animation: slideInLeft 0.8s ease;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            color: var(--primary-color);
            animation: float 3s ease-in-out infinite;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-size: 1.3rem;
            font-weight: 700;
            letter-spacing: 0.5px;
        }

        .logo-subtitle {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .nav-menu {
            display: flex;
            gap: 10px;
            animation: slideInRight 0.8s ease;
        }

        .nav-btn {
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            border: 2px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 25px;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 500;
            font-size: 0.9rem;
            position: relative;
            overflow: hidden;
        }

        .nav-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: var(--transition);
        }

        .nav-btn:hover::before {
            left: 100%;
        }

        .nav-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .nav-btn.active {
            background: white;
            color: var(--primary-color);
            border-color: white;
        }

        /* ============================================
           MAIN CONTAINER
           ============================================ */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 30px 20px;
        }

        /* ============================================
           VIEWS
           ============================================ */
        .view {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .view.active {
            display: block;
        }

        /* ============================================
           HOME VIEW - HERO SECTION
           ============================================ */
        .hero-section {
            text-align: center;
            padding: 60px 20px;
            color: white;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 700;
            margin-bottom: 20px;
            animation: fadeInUp 0.8s ease;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero-subtitle {
            font-size: 1.3rem;
            margin-bottom: 40px;
            opacity: 0.95;
            animation: fadeInUp 0.8s ease 0.2s backwards;
        }

        .hero-badges {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-bottom: 50px;
            animation: fadeInUp 0.8s ease 0.3s backwards;
        }

        .hero-badge {
            background: rgba(255,255,255,0.15);
            backdrop-filter: blur(10px);
            padding: 15px 30px;
            border-radius: 30px;
            border: 1px solid rgba(255,255,255,0.2);
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 500;
        }

        .hero-badge-icon {
            font-size: 1.5rem;
        }

        .action-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            max-width: 1100px;
            margin: 0 auto;
        }

        .action-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px 30px;
            text-align: center;
            box-shadow: var(--shadow-lg);
            transition: var(--transition);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            animation: fadeInUp 0.6s ease backwards;
        }

        .action-card:nth-child(1) { animation-delay: 0.4s; }
        .action-card:nth-child(2) { animation-delay: 0.5s; }
        .action-card:nth-child(3) { animation-delay: 0.6s; }

        .action-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
        }

        .action-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(0,0,0,0.2);
        }

        .action-card:hover .card-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .card-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            font-size: 2.5rem;
            color: white;
            transition: var(--transition);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .card-description {
            color: #666;
            font-size: 0.95rem;
            line-height: 1.6;
        }

        .card-btn {
            margin-top: 20px;
            padding: 12px 30px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 25px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .card-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(0,102,204,0.4);
        }

        .card-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--accent-color);
            color: white;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
        }

        .lock-badge {
            background: var(--danger-color);
        }

        /* ============================================
           FORM VIEW
           ============================================ */
        .form-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.6s ease;
        }

        .form-header {
            text-align: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .form-header h2 {
            color: var(--primary-color);
            font-size: 1.8rem;
            margin-bottom: 10px;
        }

        .form-header p {
            color: #666;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-weight: 600;
            color: var(--dark-text);
            margin-bottom: 8px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .form-label .required {
            color: var(--danger-color);
        }

        .form-input, .form-select {
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 8px;
            font-size: 0.95rem;
            transition: var(--transition);
            background: white;
        }

        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 3px rgba(0,102,204,0.1);
        }

        .form-input:hover, .form-select:hover {
            border-color: var(--secondary-color);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .file-upload-area {
            border: 2px dashed var(--border-color);
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            background: var(--light-bg);
        }

        .file-upload-area:hover {
            border-color: var(--secondary-color);
            background: rgba(0,102,204,0.05);
        }

        .file-upload-area.dragover {
            border-color: var(--secondary-color);
            background: rgba(0,102,204,0.1);
        }

        .file-upload-icon {
            font-size: 3rem;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }

        .file-upload-text {
            color: #666;
            margin-bottom: 10px;
        }

        .file-upload-hint {
            font-size: 0.85rem;
            color: #999;
        }

        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid var(--border-color);
        }

        .btn {
            padding: 14px 35px;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,102,204,0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success-color), #20c997);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, var(--warning-color), #e0a800);
            color: #212529;
        }

        .btn-danger {
            background: linear-gradient(135deg, var(--danger-color), #c82333);
            color: white;
        }

        /* ============================================
           DASHBOARD VIEW
           ============================================ */
        .dashboard-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.6s ease;
        }

        .dashboard-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .dashboard-title {
            color: var(--primary-color);
            font-size: 1.8rem;
            font-weight: 700;
        }

        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            transition: var(--transition);
            animation: fadeInUp 0.5s ease backwards;
        }

        .stat-card:nth-child(1) { animation-delay: 0.1s; }
        .stat-card:nth-child(2) { animation-delay: 0.2s; }
        .stat-card:nth-child(3) { animation-delay: 0.3s; }
        .stat-card:nth-child(4) { animation-delay: 0.4s; }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .search-filter-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            padding: 12px 20px;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            font-size: 0.95rem;
            transition: var(--transition);
        }

        .search-input:focus {
            outline: none;
            border-color: var(--secondary-color);
        }

        .filter-select {
            padding: 12px 20px;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            font-size: 0.95rem;
            background: white;
            cursor: pointer;
        }

        /* Table Styles */
        .table-container {
            overflow-x: auto;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        .data-table thead {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .data-table th {
            padding: 15px;
            text-align: left;
            font-weight: 600;
            font-size: 0.9rem;
            white-space: nowrap;
        }

        .data-table td {
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            font-size: 0.9rem;
        }

        .data-table tbody tr {
            transition: var(--transition);
            animation: fadeIn 0.3s ease;
        }

        .data-table tbody tr:hover {
            background: rgba(0,102,204,0.05);
            transform: scale(1.01);
        }

        .data-table tbody tr:nth-child(even) {
            background: #f8f9fa;
        }

        .data-table tbody tr:nth-child(even):hover {
            background: rgba(0,102,204,0.08);
        }

        /* Status Badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .status-disetujui {
            background: rgba(40, 167, 69, 0.15);
            color: var(--success-color);
        }

        .status-perbaikan {
            background: rgba(255, 193, 7, 0.15);
            color: #856404;
        }

        .status-ditolak {
            background: rgba(220, 53, 69, 0.15);
            color: var(--danger-color);
        }

        .status-pending {
            background: rgba(0, 102, 204, 0.15);
            color: var(--secondary-color);
        }

        /* Action Buttons */
        .action-buttons {
            display: flex;
            gap: 8px;
        }

        .action-btn {
            width: 35px;
            height: 35px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            font-size: 1rem;
        }

        .action-btn-view {
            background: rgba(0, 102, 204, 0.1);
            color: var(--secondary-color);
        }

        .action-btn-view:hover {
            background: var(--secondary-color);
            color: white;
        }

        .action-btn-edit {
            background: rgba(255, 193, 7, 0.1);
            color: #856404;
        }

        .action-btn-edit:hover {
            background: var(--warning-color);
            color: white;
        }

        .action-btn-delete {
            background: rgba(220, 53, 69, 0.1);
            color: var(--danger-color);
        }

        .action-btn-delete:hover {
            background: var(--danger-color);
            color: white;
        }

        .action-btn-download {
            background: rgba(40, 167, 69, 0.1);
            color: var(--success-color);
        }

        .action-btn-download:hover {
            background: var(--success-color);
            color: white;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
        }

        .pagination-btn {
            width: 40px;
            height: 40px;
            border: 2px solid var(--border-color);
            background: white;
            border-radius: 50%;
            cursor: pointer;
            transition: var(--transition);
            font-weight: 600;
        }

        .pagination-btn:hover,
        .pagination-btn.active {
            background: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }

        /* ============================================
           ADMIN VIEW
           ============================================ */
        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 20px;
        }

        .admin-title {
            color: var(--primary-color);
            font-size: 1.8rem;
            font-weight: 700;
        }

        .admin-info {
            display: flex;
            align-items: center;
            gap: 15px;
            background: white;
            padding: 10px 20px;
            border-radius: 30px;
            box-shadow: var(--shadow);
        }

        .admin-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .admin-details {
            display: flex;
            flex-direction: column;
        }

        .admin-name {
            font-weight: 600;
            color: var(--dark-text);
        }

        .admin-role {
            font-size: 0.8rem;
            color: #666;
        }

        .admin-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 25px;
            background: white;
            padding: 10px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
        }

        .admin-tab {
            padding: 12px 25px;
            border: none;
            background: transparent;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            color: #666;
            transition: var(--transition);
        }

        .admin-tab:hover {
            background: rgba(0,102,204,0.1);
            color: var(--secondary-color);
        }

        .admin-tab.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .admin-panel {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .admin-panel.active {
            display: block;
        }

        /* Logbox */
        .logbox-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow-lg);
        }

        .logbox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
        }

        .logbox-title {
            color: var(--primary-color);
            font-size: 1.3rem;
            font-weight: 600;
        }

        .logbox-filters {
            display: flex;
            gap: 10px;
        }

        .log-entry {
            display: flex;
            align-items: flex-start;
            gap: 15px;
            padding: 15px;
            border-bottom: 1px solid var(--border-color);
            transition: var(--transition);
        }

        .log-entry:hover {
            background: rgba(0,102,204,0.03);
        }

        .log-timestamp {
            font-size: 0.8rem;
            color: #999;
            white-space: nowrap;
            min-width: 150px;
        }

        .log-icon {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1rem;
            flex-shrink: 0;
        }

        .log-icon-create {
            background: rgba(40, 167, 69, 0.15);
            color: var(--success-color);
        }

        .log-icon-update {
            background: rgba(0, 102, 204, 0.15);
            color: var(--secondary-color);
        }

        .log-icon-delete {
            background: rgba(220, 53, 69, 0.15);
            color: var(--danger-color);
        }

        .log-icon-login {
            background: rgba(255, 153, 0, 0.15);
            color: var(--accent-color);
        }

        .log-content {
            flex: 1;
        }

        .log-action {
            font-weight: 600;
            color: var(--dark-text);
            margin-bottom: 3px;
        }

        .log-detail {
            font-size: 0.85rem;
            color: #666;
        }

        /* CRUD Table */
        .crud-toolbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .crud-search {
            flex: 1;
            min-width: 250px;
            max-width: 400px;
            position: relative;
        }

        .crud-search input {
            width: 100%;
            padding: 12px 20px 12px 45px;
            border: 2px solid var(--border-color);
            border-radius: 30px;
            font-size: 0.95rem;
        }

        .crud-search::before {
            content: 'üîç';
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 1rem;
        }

        .add-btn {
            background: linear-gradient(135deg, var(--success-color), #20c997);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 30px;
            cursor: pointer;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: var(--transition);
        }

        .add-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(40, 167, 69, 0.4);
        }

        /* ============================================
           LIGHTBOX
           ============================================ */
        .lightbox {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            animation: fadeIn 0.3s ease;
        }

        .lightbox.active {
            display: flex;
        }

        .lightbox-content {
            background: white;
            border-radius: var(--border-radius);
            max-width: 600px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.4s ease;
        }

        .lightbox-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 2px solid var(--border-color);
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: var(--border-radius) var(--border-radius) 0 0;
        }

        .lightbox-title {
            font-size: 1.3rem;
            font-weight: 600;
        }

        .lightbox-close {
            width: 35px;
            height: 35px;
            border: none;
            background: rgba(255,255,255,0.2);
            color: white;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .lightbox-close:hover {
            background: rgba(255,255,255,0.3);
            transform: rotate(90deg);
        }

        .lightbox-body {
            padding: 25px;
        }

        .lightbox-footer {
            padding: 20px 25px;
            border-top: 2px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        /* Detail Items */
        .detail-item {
            display: flex;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border-color);
        }

        .detail-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        .detail-label {
            font-weight: 600;
            color: var(--primary-color);
            min-width: 140px;
            flex-shrink: 0;
        }

        .detail-value {
            color: var(--dark-text);
        }

        /* ============================================
           LOGIN MODAL
           ============================================ */
        .login-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .login-modal.active {
            display: flex;
        }

        .login-box {
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            max-width: 400px;
            width: 100%;
            box-shadow: var(--shadow-lg);
            animation: fadeInUp 0.4s ease;
        }

        .login-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .login-header h2 {
            color: var(--primary-color);
            font-size: 1.5rem;
            margin-bottom: 10px;
        }

        .login-header p {
            color: #666;
            font-size: 0.9rem;
        }

        .login-form .form-group {
            margin-bottom: 20px;
        }

        .login-form .form-label {
            display: block;
            margin-bottom: 8px;
        }

        .login-form .form-input {
            width: 100%;
        }

        .login-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border: none;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }

        .login-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,102,204,0.4);
        }

        .login-close {
            position: absolute;
            top: 20px;
            right: 20px;
            color: white;
            font-size: 2rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .login-close:hover {
            transform: rotate(90deg);
        }

        /* ============================================
           TOAST NOTIFICATIONS
           ============================================ */
        .toast-container {
            position: fixed;
            top: 100px;
            right: 20px;
            z-index: 2000;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .toast {
            background: white;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 12px;
            min-width: 300px;
            animation: slideInRight 0.4s ease;
        }

        .toast.success {
            border-left: 4px solid var(--success-color);
        }

        .toast.error {
            border-left: 4px solid var(--danger-color);
        }

        .toast.warning {
            border-left: 4px solid var(--warning-color);
        }

        .toast.info {
            border-left: 4px solid var(--secondary-color);
        }

        .toast-icon {
            font-size: 1.3rem;
        }

        .toast-message {
            flex: 1;
            font-size: 0.9rem;
        }

        .toast-close {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1.2rem;
            color: #999;
            transition: var(--transition);
        }

        .toast-close:hover {
            color: var(--danger-color);
        }

        /* ============================================
           RESPONSIVE
           ============================================ */
        @media (max-width: 768px) {
            .header {
                padding: 15px 20px;
                flex-direction: column;
                gap: 15px;
            }

            .nav-menu {
                flex-wrap: wrap;
                justify-content: center;
            }

            .hero-title {
                font-size: 2rem;
            }

            .hero-subtitle {
                font-size: 1rem;
            }

            .hero-badges {
                flex-direction: column;
                align-items: center;
            }

            .action-cards {
                grid-template-columns: 1fr;
            }

            .form-container {
                padding: 20px;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .dashboard-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .search-filter-bar {
                flex-direction: column;
            }

            .data-table {
                font-size: 0.8rem;
            }

            .data-table th,
            .data-table td {
                padding: 10px 8px;
            }

            .admin-header {
                flex-direction: column;
                align-items: flex-start;
            }

            .admin-tabs {
                flex-wrap: wrap;
            }

            .lightbox-content {
                margin: 10px;
            }
        }

        /* ============================================
           LOADING SPINNER
           ============================================ */
        .loading-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.7);
            z-index: 3000;
            justify-content: center;
            align-items: center;
        }

        .loading-overlay.active {
            display: flex;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255,255,255,0.3);
            border-top-color: white;
            border-radius: 50%;
            animation: rotate 1s linear infinite;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="logo">
            <div class="logo-icon">üèõÔ∏è</div>
            <div class="logo-text">
                <div class="logo-title">PAK Integrasi</div>
                <div class="logo-subtitle">Kementerian Kesehatan RI</div>
            </div>
        </div>
        <nav class="nav-menu">
            <button class="nav-btn active" onclick="showView('home')">üè† Beranda</button>
            <button class="nav-btn" onclick="showView('form')">üìù Form Pengajuan</button>
            <button class="nav-btn" onclick="showView('dashboard')">üìä Dashboard</button>
            <button class="nav-btn" onclick="openLoginModal()">üîê Admin</button>
        </nav>
    </header>

    <!-- Main Container -->
    <main class="main-container">
        <!-- HOME VIEW -->
        <div id="homeView" class="view active">
            <section class="hero-section">
                <h1 class="hero-title">Sistem PAK Integrasi</h1>
                <p class="hero-subtitle">Pengajuan Penilaian Angka Kredit Pegawai Negeri Sipil Dinas Kesehatan</p>
                
                <div class="hero-badges">
                    <div class="hero-badge">
                        <span class="hero-badge-icon">‚úÖ</span>
                        <span>Terintegrasi</span>
                    </div>
                    <div class="hero-badge">
                        <span class="hero-badge-icon">üîí</span>
                        <span>Aman & Terpercaya</span>
                    </div>
                    <div class="hero-badge">
                        <span class="hero-badge-icon">‚ö°</span>
                        <span>Proses Cepat</span>
                    </div>
                </div>
            </section>

            <div class="action-cards">
                <div class="action-card" onclick="showView('form')">
                    <div class="card-icon">üìù</div>
                    <h3 class="card-title">Form Pengajuan PAK</h3>
                    <p class="card-description">Ajukan penilaian angka kredit Anda untuk proses integrasi jabatan fungsional</p>
                    <button class="card-btn">Isi Formulir</button>
                </div>
                
                <div class="action-card" onclick="showView('dashboard')">
                    <div class="card-icon">üìä</div>
                    <h3 class="card-title">Dashboard Data</h3>
                    <p class="card-description">Lihat status pengajuan dan riwayat pengajuan PAK Anda</p>
                    <button class="card-btn">Lihat Dashboard</button>
                </div>
                
                <div class="action-card" onclick="openLoginModal()">
                    <span class="card-badge lock-badge">üîí Wajib Login</span>
                    <div class="card-icon">‚öôÔ∏è</div>
                    <h3 class="card-title">Dashboard Admin</h3>
                    <p class="card-description">Kelola data pemohon, setujui atau tolak pengajuan, dan akses fitur lengkap</p>
                    <button class="card-btn">Masuk Admin</button>
                </div>
            </div>
        </div>

        <!-- FORM VIEW -->
        <div id="formView" class="view">
            <div class="form-container">
                <div class="form-header">
                    <h2>üìù Form Pengajuan PAK Integrasi</h2>
                    <p>Isi data dengan lengkap dan benar untuk mengajukan PAK</p>
                </div>

                <form id="pakForm" onsubmit="submitForm(event)">
                    <div class="form-grid">
                        <div class="form-group">
                            <label class="form-label">üìß Email <span class="required">*</span></label>
                            <input type="email" class="form-input" id="email" required placeholder="email@email.com">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üì± No. HP <span class="required">*</span></label>
                            <input type="tel" class="form-input" id="noHp" required placeholder="0812xxxxx">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üë§ Nama Lengkap <span class="required">*</span></label>
                            <input type="text" class="form-input" id="namaLengkap" required placeholder="Nama lengkap sesuai SK">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üî¢ NIP <span class="required">*</span></label>
                            <input type="text" class="form-input" id="nip" required placeholder="123456789012345678" maxlength="18">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìí No. Karpeg</label>
                            <input type="text" class="form-input" id="noKarpeg" placeholder="A.xxxxxxxx">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìç Tempat, Tanggal Lahir <span class="required">*</span></label>
                            <input type="text" class="form-input" id="ttl" required placeholder="Jakarta, 1 Januari 1990">
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üéì Pendidikan <span class="required">*</span></label>
                            <select class="form-select" id="pendidikan" required>
                                <option value="">Pilih Pendidikan</option>
                                <option value="SMA">SMA/Sederajat</option>
                                <option value="D3">D3 (Diploma)</option>
                                <option value="S1">S1 (Sarjana)</option>
                                <option value="S2">S2 (Magister)</option>
                                <option value="S3">S3 (Doktor)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">‚ö• Jenis Kelamin <span class="required">*</span></label>
                            <select class="form-select" id="jenisKelamin" required>
                                <option value="">Pilih Jenis Kelamin</option>
                                <option value="Laki-laki">Laki-laki</option>
                                <option value="Perempuan">Perempuan</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üíº Pangkat/Gol. Ruang <span class="required">*</span></label>
                            <select class="form-select" id="pangkatGol" required>
                                <option value="">Pilih Pangkat</option>
                                <option value="I/a">I/a (Juru)</option>
                                <option value="I/b">I/b (Juru Tk. I)</option>
                                <option value="I/c">I/c (Pengatur)</option>
                                <option value="I/d">I/d (Pengatur Tk. I)</option>
                                <option value="II/a">II/a (Penata)</option>
                                <option value="II/b">II/b (Penata Tk. I)</option>
                                <option value="II/c">II/c (Penata Muda)</option>
                                <option value="II/d">II/d (Penata Muda Tk. I)</option>
                                <option value="III/a">III/a (Penata)</option>
                                <option value="III/b">III/b (Penata Tk. I)</option>
                                <option value="III/c">III/c (Penata Utama)</option>
                                <option value="III/d">III/d (Penata Utama Tk. I)</option>
                                <option value="IV/a">IV/a (Pembina)</option>
                                <option value="IV/b">IV/b (Pembina Tk. I)</option>
                                <option value="IV/c">IV/c (Pembina Utama Muda)</option>
                                <option value="IV/d">IV/d (Pembina Utama Madya)</option>
                                <option value="IV/e">IV/e (Pembina Utama)</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìÖ TMT Pangkat <span class="required">*</span></label>
                            <input type="date" class="form-input" id="tmtPangkat" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üèÖ Jenis Jabatan Fungsional <span class="required">*</span></label>
                            <select class="form-select" id="jenisJF" required>
                                <option value="">Pilih Jenis JF</option>
                                <option value="Penata">Penata</option>
                                <option value="Arsiparis">Arsiparis</option>
                                <option value="Pustakawan">Pustakawan</option>
                                <option value="Analis Kepegawaian">Analis Kepegawaian</option>
                                <option value="Perencana">Perencana</option>
                                <option value="Statistisi">Statistisi</option>
                                <option value="Nutrisionis">Nutrisionis</option>
                                <option value="Kefarmasian">Kefarmasian</option>
                                <option value="Keperawatan">Keperawatan</option>
                                <option value="Kedokteran">Kedokteran</option>
                                <option value="Lainnya">Lainnya</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìà Jenjang JF <span class="required">*</span></label>
                            <select class="form-select" id="jenjangJF" required>
                                <option value="">Pilih Jenjang</option>
                                <option value="Terampil">Terampil</option>
                                <option value="Mahir">Mahir</option>
                                <option value="Penyelia">Penyelia</option>
                                <option value="Pertama">Pertama</option>
                                <option value="Muda">Muda</option>
                                <option value="Madya">Madya</option>
                                <option value="Utama">Utama</option>
                            </select>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">üìÖ TMT JF <span class="required">*</span></label>
                            <input type="date" class="form-input" id="tmtJF" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">‚è±Ô∏è Masa Kerja Golongan <span class="required">*</span></label>
                            <input type="text" class="form-input" id="masaKerjaGol" required placeholder="10 tahun 5 bulan">
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">üè¢ Satuan Kerja <span class="required">*</span></label>
                            <input type="text" class="form-input" id="satuanKerja" required placeholder="Dinas Kesehatan Provinsi/Kabupaten/Kota">
                        </div>
                        
                        <div class="form-group full-width">
                            <label class="form-label">üìé Upload Dokumen PAK <span class="required">*</span></label>
                            <div class="file-upload-area" id="fileUploadArea" onclick="document.getElementById('uploadDokumen').click()">
                                <div class="file-upload-icon">üìÅ</div>
                                <div class="file-upload-text">Klik atau drag & drop file di sini</div>
                                <div class="file-upload-hint">Format: PDF, JPG, PNG (Max: 10MB)</div>
                                <input type="file" id="uploadDokumen" style="display: none" accept=".pdf,.jpg,.jpeg,.png" onchange="handleFileSelect(event)">
                            </div>
                            <div id="fileName" style="margin-top: 10px; font-weight: 600; color: var(--success-color);"></div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="showView('home')">‚ùå Batal</button>
                        <button type="submit" class="btn btn-primary">‚úÖ Kirim Pengajuan</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- DASHBOARD VIEW -->
        <div id="dashboardView" class="view">
            <div class="dashboard-container">
                <div class="dashboard-header">
                    <h2 class="dashboard-title">üìä Dashboard Data PAK</h2>
                </div>

                <div class="dashboard-stats">
                    <div class="stat-card">
                        <div class="stat-icon">üìã</div>
                        <div class="stat-value" id="totalCount">0</div>
                        <div class="stat-label">Total Pengajuan</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #28a745, #20c997);">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-value" id="disetujuiCount">0</div>
                        <div class="stat-label">Disetujui</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #ffc107, #e0a800);">
                        <div class="stat-icon">üîß</div>
                        <div class="stat-value" id="perbaikanCount">0</div>
                        <div class="stat-label">Perbaikan</div>
                    </div>
                    <div class="stat-card" style="background: linear-gradient(135deg, #dc3545, #c82333);">
                        <div class="stat-icon">‚ùå</div>
                        <div class="stat-value" id="ditolakCount">0</div>
                        <div class="stat-label">Ditolak</div>
                    </div>
                </div>

                <div class="search-filter-bar">
                    <input type="text" class="search-input" id="searchInput" placeholder="Cari berdasarkan nama, NIP, atau Satuan Kerja..." oninput="filterTable()">
                    <select class="filter-select" id="statusFilter" onchange="filterTable()">
                        <option value="">Semua Status</option>
                        <option value="disetujui">Disetujui</option>
                        <option value="perbaikan">Perbaikan</option>
                        <option value="ditolak">Ditolak</option>
                        <option value="pending">Pending</option>
                    </select>
                </div>

                <div class="table-container">
                    <table class="data-table" id="dashboardTable">
                        <thead>
                            <tr>
                                <th>Tanggal</th>
                                <th>Nama Lengkap</th>
                                <th>NIP</th>
                                <th>Satuan Kerja</th>
                                <th>Status</th>
                                <th>Catatan</th>
                                <th>Aksi</th>
                            </tr>
                        </thead>
                        <tbody id="dashboardTableBody">
                            <!-- Data akan dimuat di sini -->
                        </tbody>
                    </table>
                </div>

                <div class="pagination" id="pagination">
                    <!-- Pagination akan dimuat di sini -->
                </div>
            </div>
        </div>

        <!-- ADMIN VIEW -->
        <div id="adminView" class="view">
            <div class="dashboard-container">
                <div class="admin-header">
                    <h2 class="admin-title">‚öôÔ∏è Dashboard Admin</h2>
                    <div class="admin-info">
                        <div class="admin-avatar">A</div>
                        <div class="admin-details">
                            <span class="admin-name" id="adminName">Admin</span>
                            <span class="admin-role">Administrator</span>
                        </div>
                        <button class="btn btn-danger" onclick="logout()" style="padding: 8px 15px; font-size: 0.8rem;">Logout</button>
                    </div>
                </div>

                <div class="admin-tabs">
                    <button class="admin-tab active" onclick="showAdminPanel('data')">üìä Data Pemohon</button>
                    <button class="admin-tab" onclick="showAdminPanel('logs')">üìú Log Aktivitas</button>
                    <button class="admin-tab" onclick="showAdminPanel('settings')">‚öôÔ∏è Pengaturan</button>
                </div>

                <!-- Data Panel -->
                <div id="adminDataPanel" class="admin-panel active">
                    <div class="crud-toolbar">
                        <div class="crud-search">
                            <input type="text" placeholder="Cari data pemohon..." oninput="searchAdminData()">
                        </div>
                        <button class="add-btn" onclick="openLightbox('add')">‚ûï Tambah Data</button>
                    </div>

                    <div class="table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Tanggal</th>
                                    <th>Nama</th>
                                    <th>NIP</th>
                                    <th>Satuan Kerja</th>
                                    <th>Status</th>
                                    <th>Catatan</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="adminTableBody">
                                <!-- Admin data akan dimuat di sini -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Logs Panel -->
                <div id="adminLogsPanel" class="admin-panel">
                    <div class="logbox-container">
                        <div class="logbox-header">
                            <h3 class="logbox-title">üìú Log Aktivitas</h3>
                            <div class="logbox-filters">
                                <select class="filter-select" id="logFilter" onchange="filterLogs()">
                                    <option value="">Semua Aktivitas</option>
                                    <option value="create">Tambah Data</option>
                                    <option value="update">Update Data</option>
                                    <option value="delete">Hapus Data</option>
                                    <option value="login">Login</option>
                                </select>
                            </div>
                        </div>
                        <div id="logEntries">
                            <!-- Log entries akan dimuat di sini -->
                        </div>
                    </div>
                </div>

                <!-- Settings Panel -->
                <div id="adminSettingsPanel" class="admin-panel">
                    <div class="logbox-container">
                        <div class="logbox-header">
                            <h3 class="logbox-title">‚öôÔ∏è Pengaturan Sistem</h3>
                        </div>
                        <div style="padding: 20px;">
                            <div class="detail-item">
                                <span class="detail-label">Versi Aplikasi</span>
                                <span class="detail-value">1.0.0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Mode</span>
                                <span class="detail-value">Kementerian Kesehatan</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Total Data</span>
                                <span class="detail-value" id="totalDataCount">0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">Total Logs</span>
                                <span class="detail-value" id="totalLogsCount">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Login Modal -->
    <div class="login-modal" id="loginModal">
        <span class="login-close" onclick="closeLoginModal()">&times;</span>
        <div class="login-box">
            <div class="login-header">
                <h2>üîê Login Admin</h2>
                <p>Masukkan kredensial untuk mengakses dashboard admin</p>
            </div>
            <form class="login-form" onsubmit="handleLogin(event)">
                <div class="form-group">
                    <label class="form-label">Username</label>
                    <input type="text" class="form-input" id="loginUsername" required placeholder="Masukkan username">
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-input" id="loginPassword" required placeholder="Masukkan password">
                </div>
                <button type="submit" class="login-btn">üöÄ Login</button>
            </form>
            <p style="text-align: center; margin-top: 20px; font-size: 0.85rem; color: #666;">
                Demo: admin / admin123
            </p>
        </div>
    </div>

    <!-- Lightbox -->
    <div class="lightbox" id="lightbox">
        <div class="lightbox-content">
            <div class="lightbox-header">
                <h3 class="lightbox-title" id="lightboxTitle">Detail Pengajuan</h3>
                <button class="lightbox-close" onclick="closeLightbox()">&times;</button>
            </div>
            <div class="lightbox-body" id="lightboxBody">
                <!-- Detail content -->
            </div>
            <div class="lightbox-footer" id="lightboxFooter">
                <button class="btn btn-secondary" onclick="closeLightbox()">Tutup</button>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="spinner"></div>
    </div>

    <script>
        // ============================================
        // GOOGLE SHEETS & DRIVE CONFIGURATION
        // ============================================
        
        // GANTI DENGAN GOOGLE APPS SCRIPT WEB APP URL
        // Contoh: 'https://script.google.com/macros/s/XXXXX/exec'
        const GOOGLE_SHEET_URL = 'https://script.google.com/macros/s/AKfycbxqrd1Op7aTiHCJDyfv5w_gIboP1bupSWjgOKzft79acPqVRViFtg_ALUxxMjmj-xbI/exec?';
        
        // Sheet names
        const SHEET_DATA = 'Data';
        const SHEET_LOGS = 'Log';
        
        // ============================================
        // GLOBAL VARIABLES
        // ============================================
        let currentUser = null;
        let appData = [];
        let logs = [];
        let currentPage = 1;
        let itemsPerPage = 10;
        let editingId = null;

        // ============================================
        // INITIALIZATION
        // ============================================
        document.addEventListener('DOMContentLoaded', function() {
            loadDataFromGoogleSheets();
        });

        // Load data from Google Sheets
        function loadDataFromGoogleSheets() {
            showLoading();
            
            // Using redirect-free approach
            // Fetch dengan redirect handling
            fetch(GOOGLE_SHEET_URL + 'action=read&sheet=' + SHEET_DATA, {
                redirect: 'follow'
            })
            .then(function(res) {
                if (res.status === 200) {
                    return res.json();
                } else if (res.status === 0) {
                    // CORS issue - try alternative
                    throw new Error('CORS issue');
                }
                return res.json();
            })
            .then(function(data) {
                if (Array.isArray(data)) {
                    appData = data.reverse();
                }
                renderDashboard();
                hideLoading();
            })
            .catch(function(err) {
                console.log('Error loading data:', err);
                appData = [];
                renderDashboard();
                hideLoading();
                showToast('info', 'Info', 'CORS Error! Cek console atau setup CORS proxy. Data disimpan sementara di browser.');
            });
        }

        // Load logs from Google Sheets
        function loadLogsFromGoogleSheets() {
            fetch(GOOGLE_SHEET_URL + '?action=read&sheet=' + SHEET_LOGS)
            .then(res => res.json())
            .then(data => {
                if (Array.isArray(data)) {
                    logs = data.reverse();
                }
                renderLogs();
            })
            .catch(err => {
                console.log('Error loading logs:', err);
                logs = [];
            });
        }

        // ============================================
        // NAVIGATION FUNCTIONS
        // ============================================
        function showView(viewName) {
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active');
            });

            document.querySelectorAll('.nav-btn').forEach(btn => {
                btn.classList.remove('active');
            });

            document.getElementById(viewName + 'View').classList.add('active');

            const navButtons = document.querySelectorAll('.nav-btn');
            navButtons.forEach(btn => {
                if (btn.textContent.toLowerCase().includes(viewName.toLowerCase()) || 
                    (viewName === 'home' && btn.textContent.includes('Beranda'))) {
                    btn.classList.add('active');
                }
            });

            if (viewName === 'dashboard') {
                renderDashboard();
            }
        }

        // ============================================
        // FORM HANDLING
        // ============================================
        function handleFileSelect(event) {
            const file = event.target.files[0];
            if (file) {
                document.getElementById('fileName').textContent = '‚úÖ ' + file.name;
                document.getElementById('fileUploadArea').style.borderColor = 'var(--success-color)';
            }
        }

        // Drag and drop
        const fileUploadArea = document.getElementById('fileUploadArea');
        
        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.classList.add('dragover');
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.classList.remove('dragover');
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                document.getElementById('uploadDokumen').files = files;
                handleFileSelect({ target: { files: files } });
            }
        });

        function submitForm(event) {
            event.preventDefault();
            
            showLoading();

            hideLoading();
            showToast('success', '‚úÖ Berhasil!', 'Pengajuan PAK berhasil dikirim');

            document.getElementById('pakForm').reset();
            document.getElementById('fileName').textContent = '';

            setTimeout(() => {
                showView('dashboard');
            }, 1500);
        }

        // ============================================
        // DASHBOARD FUNCTIONS
        // ============================================
        function renderDashboard() {
            const tbody = document.getElementById('dashboardTableBody');
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const statusFilter = document.getElementById('statusFilter').value;

            let filteredData = appData.filter(item => {
                const matchesSearch = item.namaLengkap.toLowerCase().includes(searchTerm) ||
                                     item.nip.includes(searchTerm) ||
                                     (item.satuanKerja && item.satuanKerja.toLowerCase().includes(searchTerm));
                const matchesStatus = statusFilter === '' || item.status === statusFilter;
                return matchesSearch && matchesStatus;
            });

            // Update stats
            document.getElementById('totalCount').textContent = appData.length;
            document.getElementById('disetujuiCount').textContent = appData.filter(d => d.status === 'disetujui').length;
            document.getElementById('perbaikanCount').textContent = appData.filter(d => d.status === 'perbaikan').length;
            document.getElementById('ditolakCount').textContent = appData.filter(d => d.status === 'ditolak').length;

            // Pagination
            const totalPages = Math.ceil(filteredData.length / itemsPerPage);
            const startIndex = (currentPage - 1) * itemsPerPage;
            const paginatedData = filteredData.slice(startIndex, startIndex + itemsPerPage);

            tbody.innerHTML = '';

            if (paginatedData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" style="text-align: center; padding: 40px; color: #999;">Tidak ada data</td></tr>';
            } else {
                paginatedData.forEach(item => {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${item.timestamp}</td>
                        <td><strong>${item.namaLengkap}</strong></td>
                        <td>${item.nip}</td>
                        <td>${item.satuanKerja || '-'}</td>
                        <td><span class="status-badge status-${item.status}">${getStatusLabel(item.status)}</span></td>
                        <td>${item.catatan}</td>
                        <td>
                            <div class="action-buttons">
                                <button class="action-btn action-btn-view" title="Lihat Detail" onclick="viewDetail(${item.id})">üëÅÔ∏è</button>
                                ${item.fileUrl ? `<button class="action-btn action-btn-download" title="Download" onclick="downloadDoc('${item.fileUrl}', '${item.fileName || item.namaLengkap}')">‚¨áÔ∏è</button>` : ''}
                            </div>
                        </td>
                    `;
                    tbody.appendChild(row);
                });
            }

            renderPagination(totalPages);
        }

        function getStatusLabel(status) {
            const labels = {
                'disetujui': '‚úÖ Disetujui',
                'perbaikan': 'üîß Perbaikan',
                'ditolak': '‚ùå Ditolak',
                'pending': '‚è≥ Pending'
            };
            return labels[status] || status;
        }

        function renderPagination(totalPages) {
            const pagination = document.getElementById('pagination');
            if (totalPages <= 1) {
                pagination.innerHTML = '';
                return;
            }

            let html = `<button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>‚Äπ</button>`;
            
            for (let i = 1; i <= totalPages; i++) {
                html += `<button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">${i}</button>`;
            }
            
            html += `<button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>‚Ä∫</button>`;
            
            pagination.innerHTML = html;
        }

        function changePage(page) {
            currentPage = page;
            renderDashboard();
        }

        function filterTable() {
            currentPage = 1;
            renderDashboard();
        }

        // ============================================
        // ADMIN FUNCTIONS
        // ============================================
        function openLoginModal() {
            document.getElementById('loginModal').classList.add('active');
        }

        function closeLoginModal() {
            document.getElementById('loginModal').classList.remove('active');
            document.getElementById('loginUsername').value = '';
            document.getElementById('loginPassword').value = '';
        }

        function handleLogin(event) {
            event.preventDefault();
            
            const username = document.getElementById('loginUsername').value;
            const password = document.getElementById('loginPassword').value;

            if (username === 'admin' && password === 'admin123') {
                currentUser = { username: username, role: 'admin' };
                closeLoginModal();
                showView('admin');
                renderAdminData();
                addLog('login', 'Login', `${username} login ke sistem`);
                showToast('success', '‚úÖ Login Berhasil', 'Selamat datang di dashboard admin');
            } else {
                showToast('error', '‚ùå Login Gagal', 'Username atau password salah');
            }
        }

        function logout() {
            currentUser = null;
            showView('home');
            showToast('info', 'üëã Logout', 'Anda telah keluar dari sistem');
        }

        function showAdminPanel(panelName) {
            document.querySelectorAll('.admin-panel').forEach(panel => {
                panel.classList.remove('active');
            });
            
            document.querySelectorAll('.admin-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            document.getElementById('admin' + panelName.charAt(0).toUpperCase() + panelName.slice(1) + 'Panel').classList.add('active');
            
            const tabs = document.querySelectorAll('.admin-tab');
            tabs.forEach(tab => {
                if (tab.textContent.toLowerCase().includes(panelName)) {
                    tab.classList.add('active');
                }
            });

            if (panelName === 'data') {
                renderAdminData();
            } else if (panelName === 'logs') {
                renderLogs();
            } else if (panelName === 'settings') {
                document.getElementById('totalDataCount').textContent = appData.length;
                document.getElementById('totalLogsCount').textContent = logs.length;
            }
        }

        function renderAdminData() {
            const tbody = document.getElementById('adminTableBody');
            tbody.innerHTML = '';

            appData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${item.timestamp}</td>
                    <td><strong>${item.namaLengkap}</strong></td>
                    <td>${item.nip}</td>
                    <td>${item.satuanKerja || '-'}</td>
                    <td>
                        <select class="filter-select" style="padding: 5px 10px; font-size: 0.8rem;" onchange="updateStatus(${item.id}, this.value)">
                            <option value="pending" ${item.status === 'pending' ? 'selected' : ''}>Pending</option>
                            <option value="disetujui" ${item.status === 'disetujui' ? 'selected' : ''}>Disetujui</option>
                            <option value="perbaikan" ${item.status === 'perbaikan' ? 'selected' : ''}>Perbaikan</option>
                            <option value="ditolak" ${item.status === 'ditolak' ? 'selected' : ''}>Ditolak</option>
                        </select>
                    </td>
                    <td>${item.catatan}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="action-btn action-btn-view" title="Lihat" onclick="viewDetail(${item.id})">üëÅÔ∏è</button>
                            <button class="action-btn action-btn-edit" title="Edit Catatan" onclick="editCatatan(${item.id})">‚úèÔ∏è</button>
                            <button class="action-btn action-btn-delete" title="Hapus" onclick="deleteData(${item.id})">üóëÔ∏è</button>
                        </div>
                    </td>
                `;
                tbody.appendChild(row);
            });
        }

        function updateStatus(id, status) {
            const item = appData.find(d => d.id === id);
            if (item) {
                item.status = status;
                addLog('update', 'Update Status', `${item.namaLombok} - Status diubah ke ${status}`);
                showToast('success', '‚úÖ Status Diupdate', `Status berhasil diubah ke ${getStatusLabel(status)}`);
            }
        }

        function editCatatan(id) {
            const item = appData.find(d => d.id === id);
            if (item) {
                const newCatatan = prompt('Edit Catatan:', item.catatan);
                if (newCatatan !== null) {
                    item.catatan = newCatatan;
                    addLog('update', 'Edit Catatan', `${item.namaLengkap} - Catatan diperbarui`);
                    renderAdminData();
                    showToast('success', '‚úÖ Catatan Diupdate', 'Catatan berhasil diperbarui');
                }
            }
        }

        function deleteData(id) {
            if (confirm('Apakah Anda yakin ingin menghapus data ini?')) {
                const item = appData.find(d => d.id === id);
                appData = appData.filter(d => d.id !== id);
                addLog('delete', 'Hapus Data', `${item.namaLengkap} - Data dihapus`);
                renderAdminData();
                showToast('success', '‚úÖ Data Dihapus', 'Data berhasil dihapus');
            }
        }

        function searchAdminData() {
            const searchTerm = event.target.value.toLowerCase();
            const tbody = document.getElementById('adminTableBody');
            const rows = tbody.querySelectorAll('tr');

            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(searchTerm) ? '' : 'none';
            });
        }

        // ============================================
        // LOGS FUNCTIONS
        // ============================================
        function addLog(type, action, detail) {
            const log = {
                id: Date.now(),
                timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19),
                type: type,
                action: action,
                detail: detail
            };
            logs.unshift(log);
        }

        function renderLogs() {
            const container = document.getElementById('logEntries');
            const filter = document.getElementById('logFilter').value;

            let filteredLogs = logs;
            if (filter) {
                filteredLogs = logs.filter(log => log.type === filter);
            }

            container.innerHTML = '';

            filteredLogs.forEach(log => {
                const iconClass = `log-icon-${log.type}`;
                const icon = {
                    'create': '‚ûï',
                    'update': '‚úèÔ∏è',
                    'delete': 'üóëÔ∏è',
                    'login': 'üîë'
                }[log.type] || 'üìã';

                const entry = document.createElement('div');
                entry.className = 'log-entry';
                entry.innerHTML = `
                    <span class="log-timestamp">${log.timestamp}</span>
                    <div class="log-icon ${iconClass}">${icon}</div>
                    <div class="log-content">
                        <div class="log-action">${log.action}</div>
                        <div class="log-detail">${log.detail}</div>
                    </div>
                `;
                container.appendChild(entry);
            });
        }

        function filterLogs() {
            renderLogs();
        }

        // ============================================
        // LIGHTBOX FUNCTIONS
        // ============================================
        function openLightbox(mode, id = null) {
            const lightbox = document.getElementById('lightbox');
            const title = document.getElementById('lightboxTitle');
            const body = document.getElementById('lightboxBody');
            const footer = document.getElementById('lightboxFooter');

            if (mode === 'add') {
                title.textContent = '‚ûï Tambah Data Manual';
                body.innerHTML = `
                    <form id="addDataForm">
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label class="form-label">Nama Lengkap</label>
                            <input type="text" class="form-input" id="addNama" required>
                        </div>
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label class="form-label">NIP</label>
                            <input type="text" class="form-input" id="addNip" required>
                        </div>
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label class="form-label">Satuan Kerja</label>
                            <input type="text" class="form-input" id="addSatuanKerja" required>
                        </div>
                        <div class="form-group" style="margin-bottom: 15px;">
                            <label class="form-label">Status</label>
                            <select class="form-select" id="addStatus" required>
                                <option value="pending">Pending</option>
                                <option value="disetujui">Disetujui</option>
                                <option value="perbaikan">Perbaikan</option>
                                <option value="ditolak">Ditolak</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Catatan</label>
                            <input type="text" class="form-input" id="addCatatan">
                        </div>
                    </form>
                `;
                footer.innerHTML = `
                    <button class="btn btn-secondary" onclick="closeLightbox()">Batal</button>
                    <button class="btn btn-success" onclick="saveNewData()">üíæ Simpan</button>
                `;
            } else {
                const item = appData.find(d => d.id === id);
                if (item) {
                    title.textContent = 'üìã Detail Pengajuan';
                    body.innerHTML = `
                        <div class="detail-item">
                            <span class="detail-label">Timestamp</span>
                            <span class="detail-value">${item.timestamp}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Email</span>
                            <span class="detail-value">${item.email}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">No. HP</span>
                            <span class="detail-value">${item.noHp}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Nama Lengkap</span>
                            <span class="detail-value">${item.namaLengkap}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">NIP</span>
                            <span class="detail-value">${item.nip}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">No. Karpeg</span>
                            <span class="detail-value">${item.noKarpeg || '-'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Tempat, TTL</span>
                            <span class="detail-value">${item.ttl}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Pendidikan</span>
                            <span class="detail-value">${item.pendidikan}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Jenis Kelamin</span>
                            <span class="detail-value">${item.jenisKelamin}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Pangkat/Gol.</span>
                            <span class="detail-value">${item.pangkatGol}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">TMT Pangkat</span>
                            <span class="detail-value">${item.tmtPangkat}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Jenis JF</span>
                            <span class="detail-value">${item.jenisJF}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Jenjang JF</span>
                            <span class="detail-value">${item.jenjangJF}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">TMT JF</span>
                            <span class="detail-value">${item.tmtJF}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Masa Kerja Gol.</span>
                            <span class="detail-value">${item.masaKerjaGol}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Satuan Kerja</span>
                            <span class="detail-value">${item.satuanKerja || '-'}</span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Status</span>
                            <span class="detail-value"><span class="status-badge status-${item.status}">${getStatusLabel(item.status)}</span></span>
                        </div>
                        <div class="detail-item">
                            <span class="detail-label">Catatan</span>
                            <span class="detail-value">${item.catatan}</span>
                        </div>
                    `;
                    footer.innerHTML = `
                        <button class="btn btn-secondary" onclick="closeLightbox()">Tutup</button>
                    `;
                }
            }

            lightbox.classList.add('active');
        }

        function closeLightbox() {
            document.getElementById('lightbox').classList.remove('active');
            editingId = null;
        }

        function saveNewData() {
            const newData = {
                id: Date.now(),
                timestamp: new Date().toISOString().replace('T', ' ').substring(0, 19),
                namaLengkap: document.getElementById('addNama').value,
                nip: document.getElementById('addNip').value,
                satuanKerja: document.getElementById('addSatuanKerja').value,
                status: document.getElementById('addStatus').value,
                catatan: document.getElementById('addCatatan').value,
                email: '-',
                noHp: '-',
                noKarpeg: '-',
                ttl: '-',
                pendidikan: '-',
                jenisKelamin: '-',
                pangkatGol: '-',
                tmtPangkat: '-',
                jenisJF: '-',
                jenjangJF: '-',
                tmtJF: '-',
                masaKerjaGol: '-',
                dokumen: '#'
            };

            appData.unshift(newData);
            addLog('create', 'Tambah Data', `${newData.namaLengkap} - ${newData.satuanKerja}`);
            closeLightbox();
            renderAdminData();
            showToast('success', '‚úÖ Data Ditambahkan', 'Data berhasil ditambahkan');
        }

        function viewDetail(id) {
            if (currentUser) {
                openLightbox('view', id);
            } else {
                const item = appData.find(d => d.id === id);
                const lightbox = document.getElementById('lightbox');
                const title = document.getElementById('lightboxTitle');
                const body = document.getElementById('lightboxBody');
                const footer = document.getElementById('lightboxFooter');

                title.textContent = 'üìã Detail Pengajuan';
                body.innerHTML = `
                    <div class="detail-item">
                        <span class="detail-label">Tanggal</span>
                        <span class="detail-value">${item.timestamp}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Nama Lengkap</span>
                        <span class="detail-value">${item.namaLengkap}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">NIP</span>
                        <span class="detail-value">${item.nip}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Satuan Kerja</span>
                        <span class="detail-value">${item.satuanKerja || '-'}</span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Status</span>
                        <span class="detail-value"><span class="status-badge status-${item.status}">${getStatusLabel(item.status)}</span></span>
                    </div>
                    <div class="detail-item">
                        <span class="detail-label">Catatan</span>
                        <span class="detail-value">${item.catatan}</span>
                    </div>
                `;
                footer.innerHTML = `
                    <button class="btn btn-secondary" onclick="closeLightbox()">Tutup</button>
                `;
                lightbox.classList.add('active');
            }
        }

        function downloadDoc(url, name) {
            if (url && url !== '#') {
                window.open(url, '_blank');
            } else {
                showToast('info', '‚¨áÔ∏è Download', `Mendownload dokumen untuk ${name}`);
            }
        }

        // ============================================
        // UTILITY FUNCTIONS
        // ============================================
        function showToast(type, title, message) {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                'success': '‚úÖ',
                'error': '‚ùå',
                'warning': '‚ö†Ô∏è',
                'info': '‚ÑπÔ∏è'
            };

            toast.innerHTML = `
                <span class="toast-icon">${icons[type]}</span>
                <span class="toast-message"><strong>${title}</strong><br>${message}</span>
                <button class="toast-close" onclick="this.parentElement.remove()">√ó</button>
            `;

            container.appendChild(toast);

            setTimeout(() => {
                toast.style.opacity = '0';
                toast.style.transform = 'translateX(100%)';
                setTimeout(() => toast.remove(), 300);
            }, 4000);
        }

        function showLoading() {
            document.getElementById('loadingOverlay').classList.add('active');
        }

        function hideLoading() {
            document.getElementById('loadingOverlay').classList.remove('active');
        }

        // Close lightbox on outside click
        document.getElementById('lightbox').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLightbox();
            }
        });

        // Close login modal on outside click
        document.getElementById('loginModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeLoginModal();
            }
        });
    </script>
</body>
</html>
