<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PAK Integrasi Enterprise</title>
<style>
body{font-family:Arial;margin:0;background:#f4f6f9;}
header{background:#1e3a8a;color:white;padding:15px;text-align:center;}
.container{padding:20px;}
.card{background:white;padding:20px;border-radius:10px;margin-bottom:20px;}
button{padding:10px 15px;border:none;border-radius:6px;cursor:pointer;margin:5px 0;}
.btn{background:#2563eb;color:white;}
.btn-danger{background:#dc2626;color:white;}
.btn-success{background:#16a34a;color:white;}
.hidden{display:none;}
input,select{width:100%;padding:8px;margin-bottom:10px;}
table{width:100%;border-collapse:collapse;}
th,td{border:1px solid #ddd;padding:8px;}
th{background:#e5e7eb;}
.stat{font-size:18px;font-weight:bold;}
</style>
</head>
<body>

<header>
<h2>Dashboard PAK Integrasi - Enterprise</h2>
</header>

<div class="container">

<!-- LOGIN -->
<div id="loginPage" class="card">
<h3>Login Admin</h3>
<input type="password" id="password" placeholder="Masukkan Password Admin">
<button class="btn" onclick="login()">Login</button>
</div>

<!-- DASHBOARD -->
<div id="dashboardPage" class="hidden">

<div class="card">
<h3>Statistik</h3>
<div class="stat">Total: <span id="total"></span></div>
<div class="stat">Menunggu: <span id="menunggu"></span></div>
<div class="stat">Disetujui: <span id="disetujui"></span></div>
<div class="stat">Ditolak: <span id="ditolak"></span></div>
</div>

<div class="card">
<h3>Data Pengajuan</h3>
<table>
<thead>
<tr>
<th>Nama</th>
<th>Satker</th>
<th>Status</th>
<th>File</th>
<th>Aksi</th>
</tr>
</thead>
<tbody id="tableData"></tbody>
</table>
</div>

</div>

</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbzd4UEzM5MO_A6we6M4fisbIwmyS3N7-Of1iQnT6DwZMj8AD0PN-d5SwJvbEkRtHM_Z/exec";
const ADMIN_PASSWORD="@pakintegrasi2026";

function login(){
if(document.getElementById("password").value===ADMIN_PASSWORD){
document.getElementById("loginPage").classList.add("hidden");
document.getElementById("dashboardPage").classList.remove("hidden");
loadData();
}else{
alert("Password salah!");
}
}

async function loadData(){
let res=await fetch(API_URL,{
method:"POST",
body:JSON.stringify({action:"getData"})
});
let data=await res.json();
data.shift();

let total=0,menunggu=0,disetujui=0,ditolak=0;
let html="";

data.forEach((row,i)=>{
total++;
if(row[17]=="Menunggu") menunggu++;
if(row[17]=="Disetujui") disetujui++;
if(row[17]=="Ditolak") ditolak++;

html+=`
<tr>
<td>${row[3]}</td>
<td>${row[15]}</td>
<td>${row[17]}</td>
<td><a href="${row[16]}" target="_blank">Download</a></td>
<td>
<button onclick="update(${i+2},'Disetujui')" class="btn-success">Setujui</button>
<button onclick="update(${i+2},'Ditolak')" class="btn-danger">Tolak</button>
</td>
</tr>`;
});

document.getElementById("tableData").innerHTML=html;
document.getElementById("total").innerText=total;
document.getElementById("menunggu").innerText=menunggu;
document.getElementById("disetujui").innerText=disetujui;
document.getElementById("ditolak").innerText=ditolak;
}

async function update(row,status){
await fetch(API_URL,{
method:"POST",
body:JSON.stringify({
action:"updateStatus",
row:row,
status:status,
catatan:"-"
})
});
loadData();
}
</script>

</body>
</html>
