<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Absensi</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Segoe UI,Arial;background:#f1f4f9;padding:20px}
.container{max-width:720px;margin:auto;background:#fff;padding:30px;border-radius:16px;box-shadow:0 15px 40px rgba(0,0,0,.15)}
label{font-weight:600;margin-top:15px;display:block}
input,select,textarea{width:100%;padding:12px;margin-top:6px;border-radius:10px;border:1px solid #ccc}
button{margin-top:25px;width:100%;padding:14px;font-size:16px;font-weight:700;border:none;border-radius:12px;background:#0d6efd;color:#fff;cursor:pointer}
button:disabled{opacity:.6}
.status{margin-top:15px;padding:12px;border-radius:10px;display:none}
.success{background:#e9f8ef;color:#1e7e34}
.error{background:#fdecea;color:#b02a37}
</style>
</head>

<body>

<div class="container">
<h2 style="text-align:center">Form Absensi</h2>

<form id="form">

<label>Nama Lengkap</label>
<input id="nama" required>

<label>NIP</label>
<input id="nip" required>

<label>Platform Digital Yang Digunakan</label>
<select id="platform" required>
  <option value="">-- Pilih --</option>
  <option>Zoom Meeting</option>
  <option>YouTube</option>
</select>

<label>Evaluasi Penyelenggara</label>
<select id="evalPenyelenggara" required>
  <option value="">-- Pilih --</option>
  <option>Sangat Baik</option>
  <option>Baik</option>
  <option>Cukup</option>
  <option>Kurang</option>
</select>

<label>Evaluasi Fasilitator / Narasumber</label>
<select id="evalNarasumber" required>
  <option value="">-- Pilih --</option>
  <option>Sangat Baik</option>
  <option>Baik</option>
  <option>Cukup</option>
  <option>Kurang</option>
</select>

<label>Evaluasi Sarana Prasarana</label>
<select id="evalSarana" required>
  <option value="">-- Pilih --</option>
  <option>Sangat Baik</option>
  <option>Baik</option>
  <option>Cukup</option>
  <option>Kurang</option>
</select>

<label>Komentar</label>
<textarea id="komentar" rows="3"></textarea>

<button type="submit" id="submitBtn">KIRIM ABSENSI</button>

<div class="status success" id="successMsg">✅ Absensi berhasil disimpan</div>
<div class="status error" id="errorMsg"></div>

</form>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyC9dK4tZKvLhkr22jDoz1IspSeLIp3XULV5S_9QcV4nCHcbQOTaaTHBjAOBO9B3dhD/exec";

const form = document.getElementById("form");
const submitBtn = document.getElementById("submitBtn");
const successMsg = document.getElementById("successMsg");
const errorMsg = document.getElementById("errorMsg");

form.addEventListener("submit", function(e){
  e.preventDefault();

  submitBtn.disabled = true;
  submitBtn.innerText = "Mengirim...";
  successMsg.style.display = "none";
  errorMsg.style.display = "none";

  const data = new URLSearchParams();
  data.append("nama", nama.value);
  data.append("nip", nip.value);
  data.append("platform", platform.value);
  data.append("evalPenyelenggara", evalPenyelenggara.value);
  data.append("evalNarasumber", evalNarasumber.value);
  data.append("evalSarana", evalSarana.value);
  data.append("komentar", komentar.value);

  fetch(SCRIPT_URL, { method:"POST", body:data })
    .then(r => r.json())
    .then(out => {
      if(!out.success) throw out.message;
      successMsg.style.display = "block";
      form.reset();
    })
    .catch(err => {
      errorMsg.innerText = "❌ " + err;
      errorMsg.style.display = "block";
    })
    .finally(() => {
      submitBtn.disabled = false;
      submitBtn.innerText = "KIRIM ABSENSI";
    });
});
</script>

</body>
</html>
