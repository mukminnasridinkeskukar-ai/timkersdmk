<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Absensi</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:Segoe UI,Arial;background:#f1f4f9;padding:20px}
.container{max-width:720px;margin:auto;background:#fff;padding:30px;border-radius:16px;box-shadow:0 15px 40px rgba(0,0,0,.15)}
label{font-weight:600;margin-top:15px;display:block}
input,select,textarea{width:100%;padding:12px;margin-top:6px;border-radius:10px;border:1px solid #ccc}
button{margin-top:25px;width:100%;padding:14px;font-size:16px;font-weight:700;border:none;border-radius:12px;background:#0d6efd;color:#fff;cursor:pointer}
button:disabled{opacity:.6}
.status{margin-top:15px;padding:12px;border-radius:10px;display:none}
.success{background:#e9f8ef;color:#1e7e34}
.error{background:#fdecea;color:#b02a37}
</style>
</head>

<body>

<div class="container">
<h2 style="text-align:center">Form Absensi</h2>

<form id="form">

<label>Nama Lengkap</label>
<input id="nama" required>

<label>NIP</label>
<input id="nip" required>

<label>Platform Digital Yang Digunakan</label>
<select id="platform" required>
  <option value="">-- Pilih --</option>
  <option>Zoom Meeting</option>
  <option>YouTube</option>
</select>

<label>Evaluasi Penyelenggara</label>
<select id="evalPenyelenggara" required>
  <option value="">-- Pilih --</option>
  <option>Sangat Baik</option>
  <option>Baik</option>
  <option>Cukup</option>
  <option>Kurang</option>
</select>

<label>Evaluasi Fasilitator / Narasumber</label>
<select id="evalNarasumber" required>
  <option value="">-- Pilih --</option>
  <option>Sangat Baik</option>
  <option>Baik</option>
  <option>Cukup</option>
  <option>Kurang</option>
</select>

<label>Evaluasi Sarana Prasarana</label>
<select id="evalSarana" required>
  <option value="">-- Pilih --</option>
  <option>Sangat Baik</option>
  <option>Baik</option>
  <option>Cukup</option>
  <option>Kurang</option>
</select>

<label>Komentar</label>
<textarea id="komentar" rows="3"></textarea>

<button type="submit" id="submitBtn">KIRIM ABSENSI</button>

<div class="status success" id="successMsg">‚úÖ Absensi berhasil disimpan</div>
<div class="status error" id="errorMsg"></div>
  
<div id="timer" style="
  text-align:center;
  font-weight:700;
  margin-bottom:15px;
  padding:12px;
  border-radius:10px;
  background:#eef2ff;
">
Memuat waktu absensi...
</div>

</form>
</div>

<script>
const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbyIZMt9dn-1C-pdOyoonbiipqnNgpwiua50MFJfQlcVYVSdJZGZjjW6rr9i7W98a0At/exec";

// ===== CEK LOGIN =====
if(!sessionStorage.getItem("login")){
  location.href="login.html";
}

// ===== LOAD TIMER =====
fetch(SCRIPT_URL)
.then(r=>r.json())
.then(cfg=>{
  const buka = new Date(cfg.buka);
  const tutup = new Date(cfg.tutup);

  setInterval(()=>{
    const now = new Date();
    let msg = "";

    if(now < buka){
      msg = "‚è≥ Absensi dibuka dalam " + countdown(buka-now);
    }else if(now > tutup){
      msg = "‚ùå Absensi telah ditutup";
      document.getElementById("submitBtn").disabled = true;
    }else{
      msg = "üü¢ Absensi ditutup dalam " + countdown(tutup-now);
    }

    document.getElementById("timer").innerText = msg;
  },1000);
});

function countdown(ms){
  const d = Math.floor(ms/86400000);
  const h = Math.floor(ms%86400000/3600000);
  const m = Math.floor(ms%3600000/60000);
  const s = Math.floor(ms%60000/1000);
  return `${d}h ${h}j ${m}m ${s}d`;
}
</script>


</body>
</html>
