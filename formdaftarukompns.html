<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Form UKOM Jabatan Fungsional Kesehatan</title>

<style>
body{
  margin:0;
  font-family:Segoe UI,Inter,Arial,sans-serif;
  background:linear-gradient(180deg,#60a5fa,#e0f2fe);
}
.container{
  max-width:840px;
  margin:50px auto;
  background:#fff;
  padding:32px;
  border-radius:20px;
  box-shadow:0 20px 45px rgba(0,0,0,.15);
}
h2{text-align:center;color:#1e40af}
p{text-align:center;color:#475569}

label{font-weight:600;margin-top:14px;display:block}
input,select{
  width:100%;
  padding:12px;
  margin-top:6px;
  border-radius:12px;
  border:1px solid #cbd5e1;
  font-size:15px;
}
button{
  margin-top:26px;
  width:100%;
  padding:16px;
  border:none;
  border-radius:14px;
  background:linear-gradient(135deg,#2563eb,#3b82f6);
  color:#fff;
  font-size:16px;
  font-weight:700;
  cursor:pointer;
}
button:disabled{opacity:.6}

.note{
  font-size:12px;
  color:#dc2626;
  display:none;
}

#notif{
  display:none;
  margin-top:20px;
  padding:14px;
  border-radius:12px;
  font-weight:600;
  text-align:center;
}
.ok{background:#dcfce7;color:#166534}
.err{background:#fee2e2;color:#991b1b}
</style>
</head>

<body>
<div class="container">
<h2>FORMULIR UKOM JABATAN FUNGSIONAL KESEHATAN</h2>
<p>Lengkapi data dan unggah dokumen sesuai ketentuan</p>

<form id="form">

<label>Periode</label>
<select name="periode" required>
  <option value="">-- pilih --</option>
  <option value="Januari 2026">Januari 2026</option>
  <option value="Juli 2026">Juli 2026</option>
</select>

<label>Nama Lengkap</label>
<input name="nama" required>

<label>NIK</label>
<input name="nik" maxlength="16" required>

<label>NIP</label>
<input name="nip">

<label>Nomor Telpon / WA</label>
<input name="telp" required>

<label>Email Aktif</label>
<input type="email" name="email" required>

<label>Unit Kerja</label>
<select name="unit" required>
  <option value="">-- pilih --</option>
  <option value="Puskesmas">Puskesmas</option>
  <option value="RSUD">RSUD</option>
  <option value="Dinas Kesehatan">Dinas Kesehatan</option>
</select>

<label>Jenis Jabatan</label>
<select name="jenis" id="jenis" required>
  <option value="">-- pilih --</option>
  <option value="Perawat">Perawat</option>
  <option value="Bidan">Bidan</option>
  <option value="Nutrisionis">Nutrisionis</option>
  <option value="Administrator Kesehatan">Administrator Kesehatan</option>
</select>

<label>Nomor STR</label>
<input name="str" id="str">
<div class="note" id="strNote">STR WAJIB untuk jabatan fungsional kesehatan tertentu</div>

<label>Upload Foto Latar Merah</label>
<input type="file" name="foto" accept=".jpg,.jpeg,.png" required>

<label>Upload Kelengkapan Dokumen (PDF)</label>
<input type="file" name="dokumen" accept=".pdf" required>

<div id="notif"></div>
<button type="submit" id="btn">üöÄ KIRIM DATA</button>

</form>
</div>

<script>
const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbzV4c-FebJJzh9pHwTwHN61X6707t3cCe7l5FeB_x_llPTmMGkJkJV0tiOzGyqr37K1/exec';

const jenis = document.getElementById('jenis');
const str = document.getElementById('str');
const note = document.getElementById('strNote');

jenis.onchange = ()=>{
  if(['Perawat','Bidan','Nutrisionis'].includes(jenis.value)){
    str.required = true;
    note.style.display = 'block';
  }else{
    str.required = false;
    note.style.display = 'none';
  }
};

const toBase64 = f => new Promise(res=>{
  const r = new FileReader();
  r.onload = e => res({
    name:f.name,
    type:f.type,
    data:e.target.result.split(',')[1]
  });
  r.readAsDataURL(f);
});

document.getElementById('form').onsubmit = async e=>{
  e.preventDefault();
  const btn = document.getElementById('btn');
  const notif = document.getElementById('notif');
  btn.disabled = true;

  const data = {};
  for(const el of e.target.elements){
    if(!el.name) continue;
    if(el.type==='file'){
      data[el.name] = el.files[0] ? await toBase64(el.files[0]) : null;
    }else{
      data[el.name] = el.value;
    }
  }

  fetch(WEB_APP_URL,{
    method:'POST',
    body:JSON.stringify(data)
  })
  .then(r=>r.json())
  .then(res=>{
    notif.style.display='block';
    if(res.status==='OK'){
      notif.className='ok';
      notif.innerHTML='‚úÖ Data berhasil dikirim';
      e.target.reset();
    }else{
      notif.className='err';
      notif.innerHTML='‚ùå '+res.message;
    }
    btn.disabled=false;
  })
  .catch(err=>{
    notif.style.display='block';
    notif.className='err';
    notif.innerHTML='‚ùå Koneksi gagal';
    btn.disabled=false;
  });
};
</script>

</body>
</html>
