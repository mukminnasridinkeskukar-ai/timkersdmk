<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIMANTRI - Dashboard SDM Kesehatan</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #1a5f7a;
            --secondary-color: #159895;
            --accent-color: #57c5b6;
            --dark-bg: #0c4a6e;
            --light-bg: #f0f7fa;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light-bg);
        }
        
        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            left: 0;
            height: 100vh;
            width: 280px;
            background: linear-gradient(180deg, var(--dark-bg) 0%, var(--primary-color) 100%);
            overflow-y: auto;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .sidebar-header {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .sidebar-header h4 {
            color: white;
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .sidebar-header small {
            color: rgba(255,255,255,0.7);
            font-size: 11px;
        }
        
        .sidebar .nav-item {
            margin: 3px 10px;
        }
        
        .sidebar .nav-link {
            color: rgba(255,255,255,0.85);
            padding: 12px 18px;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        .sidebar .nav-link:hover {
            background-color: rgba(255,255,255,0.12);
            color: white;
            transform: translateX(5px);
        }
        
        .sidebar .nav-link.active {
            background-color: var(--secondary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(21, 152, 149, 0.4);
        }
        
        .sidebar .nav-link i {
            width: 24px;
            margin-right: 10px;
            text-align: center;
        }
        
        .sidebar .submenu {
            padding-left: 20px;
            display: none;
        }
        
        .sidebar .submenu.show {
            display: block;
        }
        
        .sidebar .submenu .nav-link {
            font-size: 13px;
            padding: 10px 15px;
            color: rgba(255,255,255,0.7);
        }
        
        .sidebar .submenu .nav-link:hover {
            color: white;
        }
        
        .sidebar .submenu .nav-link::before {
            content: "â”” ";
            margin-right: 5px;
        }
        
        /* Main Content */
        .main-content {
            margin-left: 280px;
            padding: 20px;
            min-height: 100vh;
            transition: all 0.3s ease;
        }
        
        /* Header */
        .page-header {
            background: white;
            padding: 20px 30px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .page-header h4 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 3px;
        }
        
        .breadcrumb-custom {
            font-size: 12px;
            color: #6c757d;
        }
        
        /* Cards */
        .stat-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            border: none;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }
        
        .stat-card .icon-wrapper {
            width: 55px;
            height: 55px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            margin-bottom: 15px;
        }
        
        .stat-card .icon-wrapper.blue { background: rgba(26, 95, 122, 0.12); color: var(--primary-color); }
        .stat-card .icon-wrapper.green { background: rgba(21, 152, 149, 0.12); color: var(--secondary-color); }
        .stat-card .icon-wrapper.orange { background: rgba(230, 126, 34, 0.12); color: #e67e22; }
        .stat-card .icon-wrapper.red { background: rgba(231, 76, 60, 0.12); color: #e74c3c; }
        .stat-card .icon-wrapper.purple { background: rgba(155, 89, 182, 0.12); color: #9b59b6; }
        
        .stat-card h2 {
            font-size: 28px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 5px;
        }
        
        .stat-card p {
            color: #7f8c8d;
            font-size: 13px;
            margin-bottom: 0;
        }
        
        .stat-card .trend {
            font-size: 12px;
            margin-top: 8px;
        }
        
        .trend.up { color: #27ae60; }
        .trend.down { color: #e74c3c; }
        
        /* Tables */
        .table-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
        }
        
        .table-card .card-header {
            background: white;
            border-bottom: 1px solid #eee;
            padding: 15px 20px;
            font-weight: 600;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .table thead th {
            background: var(--light-bg);
            border: none;
            font-weight: 600;
            color: var(--primary-color);
            padding: 15px;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .table tbody td {
            padding: 15px;
            vertical-align: middle;
            font-size: 14px;
            color: #444;
        }
        
        .table tbody tr:hover {
            background: rgba(26, 95, 122, 0.03);
        }
        
        /* Badges */
        .badge-custom {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 11px;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-active { background: rgba(39, 174, 96, 0.15); color: #27ae60; }
        .badge-pending { background: rgba(230, 126, 34, 0.15); color: #e67e22; }
        .badge-inactive { background: rgba(231, 76, 60, 0.15); color: #e74c3c; }
        .badge-info { background: rgba(52, 152, 219, 0.15); color: #3498db; }
        
        /* Buttons */
        .btn-primary-custom {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            border: none;
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .btn-primary-custom:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(26, 95, 122, 0.3);
            color: white;
        }
        
        /* Sections */
        .section { display: none; }
        .section.active { display: block; }
        
        /* Search */
        .search-wrapper {
            position: relative;
            width: 250px;
        }
        
        .search-wrapper input {
            padding-left: 40px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            font-size: 14px;
        }
        
        .search-wrapper i {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #aaa;
        }
        
        /* Map Container */
        #map {
            height: 400px;
            border-radius: 12px;
            margin-bottom: 20px;
        }
        
        /* KPI Card */
        .kpi-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: none;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
        }
        
        .kpi-card .kpi-value {
            font-size: 36px;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .kpi-card .kpi-label {
            color: #7f8c8d;
            font-size: 13px;
            margin-top: 5px;
        }
        
        .kpi-card .kpi-status {
            font-size: 12px;
            margin-top: 10px;
        }
        
        /* Progress */
        .progress-custom {
            height: 8px;
            border-radius: 4px;
            background: #e9ecef;
            overflow: hidden;
        }
        
        .progress-custom .progress-bar {
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            border-radius: 4px;
        }
        
        /* Modal */
        .modal-header {
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            color: white;
        }
        
        .modal-header .btn-close {
            filter: brightness(0) invert(1);
        }
        
        /* Loading */
        .loading-spinner {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 200px;
        }
        
        .spinner-border {
            width: 3rem;
            height: 3rem;
            color: var(--secondary-color);
        }
        
        /* Responsive */
        @media (max-width: 992px) {
            .sidebar {
                width: 70px;
                overflow: visible;
            }
            
            .sidebar .nav-text, 
            .sidebar-header h4,
            .sidebar-header small,
            .sidebar .submenu {
                display: none !important;
            }
            
            .sidebar .nav-link {
                justify-content: center;
                padding: 15px;
            }
            
            .sidebar .nav-link i {
                margin-right: 0;
            }
            
            .main-content {
                margin-left: 70px;
            }
        }
        
        @media (max-width: 768px) {
            .sidebar {
                width: 0;
            }
            
            .main-content {
                margin-left: 0;
            }
        }
        
        /* Chart Container */
        .chart-container {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 15px rgba(0,0,0,0.06);
        }
        
        .chart-container h5 {
            color: var(--primary-color);
            font-weight: 600;
            margin-bottom: 20px;
        }
        
        /* Gap Analysis */
        .gap-bar {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .gap-label {
            width: 150px;
            font-size: 13px;
            color: #555;
        }
        
        .gap-progress {
            flex: 1;
            margin: 0 15px;
        }
        
        .gap-value {
            width: 60px;
            text-align: right;
            font-weight: 600;
            font-size: 13px;
        }
        
        /* Heatmap Legend */
        .heatmap-legend {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            font-size: 12px;
        }
        
        .heatmap-legend span {
            padding: 3px 10px;
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Sidebar -->
    <nav class="sidebar">
        <div class="sidebar-header">
            <h4><i class="bi bi-heart-pulse"></i> SIMANTRI</h4>
            <small>Sistem Informasi & Manajemen<br>SDM Kesehatan</small>
        </div>
        <ul class="nav flex-column mt-3">
            <li class="nav-item">
                <a class="nav-link active" href="#" data-section="beranda">
                    <i class="bi bi-speedometer2"></i>
                    <span class="nav-text">Beranda</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="induk">
                    <i class="bi bi-database"></i>
                    <span class="nav-text">Data Induk SDM</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="perencanaan">
                    <i class="bi bi-clipboard-check"></i>
                    <span class="nav-text">Perencanaan</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="distribusi">
                    <i class="bi bi-truck"></i>
                    <span class="nav-text">Pendistribusian</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="pendayagunaan">
                    <i class="bi bi-person-workspace"></i>
                    <span class="nav-text">Pendayagunaan</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="pengembangan">
                    <i class="bi bi-mortarboard"></i>
                    <span class="nav-text">Pengembangan</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="monev">
                    <i class="bi bi-bar-chart-steps"></i>
                    <span class="nav-text">Monev</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="pelaporan">
                    <i class="bi bi-file-earmark-text"></i>
                    <span class="nav-text">Pelaporan</span>
                </a>
            </li>
            <li class="nav-item">
                <a class="nav-link" href="#" data-section="peta">
                    <i class="bi bi-map"></i>
                    <span class="nav-text">Peta & Analitik</span>
                </a>
            </li>
            <li class="nav-item mt-3 border-top pt-3">
                <a class="nav-link" href="#" data-section="pengaturan">
                    <i class="bi bi-gear"></i>
                    <span class="nav-text">Pengaturan</span>
                </a>
            </li>
        </ul>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- BERANDA SECTION -->
        <section id="beranda" class="section active">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-house-door me-2"></i>Beranda</h4>
                    <div class="breadcrumb-custom">Dashboard Utama / Overview</div>
                </div>
                <button class="btn btn-primary-custom" onclick="refreshAllData()">
                    <i class="bi bi-arrow-clockwise me-2"></i>Refresh Data
                </button>
            </div>
            
            <!-- KPI Cards -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="icon-wrapper blue"><i class="bi bi-people-fill"></i></div>
                        <h2 id="total-sdm">0</h2>
                        <p>Total SDM Kesehatan</p>
                        <div class="trend up"><i class="bi bi-arrow-up"></i> +5.2% dari tahun lalu</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="icon-wrapper green"><i class="bi bi-person-badge"></i></div>
                        <h2 id="rasio-sdm">1:850</h2>
                        <p>Rasio SDMK vs Penduduk</p>
                        <div class="trend up"><i class="bi bi-arrow-up"></i> Membaik</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="icon-wrapper orange"><i class="bi bi-exclamation-triangle"></i></div>
                        <h2 id="kesenjangan">24</h2>
                        <p>Kesenjangan Formasi</p>
                        <div class="trend down"><i class="bi bi-arrow-down"></i> -8% dari target</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="stat-card">
                        <div class="icon-wrapper red"><i class="bi bi-hospital"></i></div>
                        <h2 id="fasyankes">156</h2>
                        <p>Fasyankes Terlayani</p>
                        <div class="trend up"><i class="bi bi-arrow-up"></i> 85% cakupan</div>
                    </div>
                </div>
            </div>
            
            <!-- Charts Row -->
            <div class="row mb-4">
                <div class="col-lg-8">
                    <div class="chart-container">
                        <h5><i class="bi bi-graph-up me-2"></i>Tren SDM Kesehatan 5 Tahun Terakhir</h5>
                        <canvas id="trendChart" height="100"></canvas>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="chart-container">
                        <h5><i class="bi bi-pie-chart me-2"></i>Komposisi Jenis Tenaga</h5>
                        <canvas id="jenisChart" height="200"></canvas>
                    </div>
                </div>
            </div>
            
            <!-- Gap Analysis & Map -->
            <div class="row mb-4">
                <div class="col-lg-6">
                    <div class="table-card">
                        <div class="card-header">
                            <i class="bi bi-bar-chart-steps me-2"></i>Analisis Kesenjangan per Jenis
                        </div>
                        <div class="card-body">
                            <div class="gap-bar">
                                <span class="gap-label">Dokter</span>
                                <div class="gap-progress">
                                    <div class="progress-custom">
                                        <div class="progress-bar" style="width: 75%"></div>
                                    </div>
                                </div>
                                <span class="gap-value text-danger">75%</span>
                            </div>
                            <div class="gap-bar">
                                <span class="gap-label">Perawat</span>
                                <div class="gap-progress">
                                    <div class="progress-custom">
                                        <div class="progress-bar" style="width: 88%"></div>
                                    </div>
                                </div>
                                <span class="gap-value text-warning">88%</span>
                            </div>
                            <div class="gap-bar">
                                <span class="gap-label">Bidan</span>
                                <div class="gap-progress">
                                    <div class="progress-custom">
                                        <div class="progress-bar" style="width: 92%"></div>
                                    </div>
                                </div>
                                <span class="gap-value text-success">92%</span>
                            </div>
                            <div class="gap-bar">
                                <span class="gap-label">Apoteker</span>
                                <div class="gap-progress">
                                    <div class="progress-custom">
                                        <div class="progress-bar" style="width: 65%"></div>
                                    </div>
                                </div>
                                <span class="gap-value text-danger">65%</span>
                            </div>
                            <div class="gap-bar">
                                <span class="gap-label">Sanitarian</span>
                                <div class="gap-progress">
                                    <div class="progress-custom">
                                        <div class="progress-bar" style="width: 70%"></div>
                                    </div>
                                </div>
                                <span class="gap-value text-danger">70%</span>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="table-card">
                        <div class="card-header">
                            <i class="bi bi-geo-alt me-2"></i>Peta Sebaran SDM Kesehatan
                        </div>
                        <div class="card-body p-0">
                            <div id="dashboardMap" style="height: 300px; border-radius: 0 0 12px 12px;"></div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- DATA INDUK SECTION -->
        <section id="induk" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-database me-2"></i>Data Induk SDM Kesehatan</h4>
                    <div class="breadcrumb-custom">Single Source of Truth / Basis Data Utama</div>
                </div>
                <button class="btn btn-primary-custom" onclick="showAddModal('induk')">
                    <i class="bi bi-plus-lg me-2"></i>Tambah Data
                </button>
            </div>
            
            <div class="row mb-4">
                <div class="col-md-2">
                    <div class="kpi-card">
                        <div class="kpi-value" id="count-dokter">0</div>
                        <div class="kpi-label">Dokter</div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="kpi-card">
                        <div class="kpi-value" id="count-perawat">0</div>
                        <div class="kpi-label">Perawat</div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="kpi-card">
                        <div class="kpi-value" id="count-bidan">0</div>
                        <div class="kpi-label">Bidan</div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="kpi-card">
                        <div class="kpi-value" id="count-apoteker">0</div>
                        <div class="kpi-label">Apoteker</div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="kpi-card">
                        <div class="kpi-value" id="count-nakes">0</div>
                        <div class="kpi-label">Nakes Lainnya</div>
                    </div>
                </div>
                <div class="col-md-2">
                    <div class="kpi-card">
                        <div class="kpi-value" id="count-nonakes">0</div>
                        <div class="kpi-label">Non Nakes</div>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <div class="d-flex align-items-center gap-3">
                        <span><i class="bi bi-table me-2"></i>Daftar SDM Kesehatan</span>
                        <div class="search-wrapper">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control form-control-sm" placeholder="Cari..." id="search-induk">
                        </div>
                    </div>
                    <div class="btn-group">
                        <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-file-earmark-excel"></i> Excel</button>
                        <button class="btn btn-sm btn-outline-secondary"><i class="bi bi-file-earmark-pdf"></i> PDF</button>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0" id="induk-table">
                            <thead>
                                <tr>
                                    <th>NIK</th>
                                    <th>Nama</th>
                                    <th>Jenis Kelamin</th>
                                    <th>Profesi</th>
                                    <th>Spesialisasi</th>
                                    <th>Kab/Kota</th>
                                    <th>Fasyankes</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="induk-body">
                                <tr><td colspan="9" class="text-center py-4">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PERENCANAAN SECTION -->
        <section id="perencanaan" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-clipboard-check me-2"></i>Perencanaan SDM Kesehatan</h4>
                    <div class="breadcrumb-custom">Analisis Kebutuhan, Proyeksi & Formasi</div>
                </div>
                <button class="btn btn-primary-custom" onclick="showAddModal('perencanaan')">
                    <i class="bi bi-plus-lg me-2"></i>Tambah Perencanaan
                </button>
            </div>
            
            <div class="row mb-4">
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper blue"><i class="bi bi-calculator"></i></div>
                        <h2 id="analisis-kebutuhan">12</h2>
                        <p>Analisis Kebutuhan</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper green"><i class="bi bi-calendar-range"></i></div>
                        <h2 id="proyeksi">5</h2>
                        <p>Proyeksi (5-10 Tahun)</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper orange"><i class="bi bi-sort-down"></i></div>
                        <h2 id="perhitungan-abk">8</h2>
                        <p>Perhitungan ABK/WISN</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper purple"><i class="bi bi-file-earmark-text"></i></div>
                        <h2 id="usulan-formasi">15</h2>
                        <p>Usulan Formasi</p>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <div class="d-flex align-items-center gap-3">
                        <span><i class="bi bi-list me-2"></i>Daftar Perencanaan</span>
                        <div class="search-wrapper">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control form-control-sm" placeholder="Cari..." id="search-perencanaan">
                        </div>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0" id="perencanaan-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Jenis Analisis</th>
                                    <th>Fasyankes</th>
                                    <th>Target</th>
                                    <th>Periode</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="perencanaan-body">
                                <tr><td colspan="7" class="text-center py-4">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PENDISTRIBUSIAN SECTION -->
        <section id="distribusi" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-truck me-2"></i>Pendistribusian SDM Kesehatan</h4>
                    <div class="breadcrumb-custom">Pemerataan & Kebijakan Distribusi</div>
                </div>
                <button class="btn btn-primary-custom" onclick="showAddModal('distribusi')">
                    <i class="bi bi-plus-lg me-2"></i>Tambah Distribusi
                </button>
            </div>
            
            <div class="row mb-4">
                <div class="col-lg-8">
                    <div class="table-card">
                        <div class="card-header">
                            <i class="bi bi-geo-alt me-2"></i>Peta Distribusi SDM Kesehatan
                        </div>
                        <div class="card-body p-0">
                            <div id="distribusiMap" style="height: 400px;"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="table-card">
                        <div class="card-header">
                            <i class="bi bi-exclamation-triangle me-2"></i>Daerah Kekurangan SDM
                        </div>
                        <div class="card-body">
                            <div class="mb-3 p-2 border rounded">
                                <strong>Puskesmas A</strong>
                                <span class="badge badge-inactive float-end">Kritis</span>
                                <small class="text-muted d-block">Kekurangan: Dokter, Bidan</small>
                            </div>
                            <div class="mb-3 p-2 border rounded">
                                <strong>RSUD B</strong>
                                <span class="badge badge-pending float-end">Sedang</span>
                                <small class="text-muted d-block">Kekurangan: Perawat, Apoteker</small>
                            </div>
                            <div class="mb-3 p-2 border rounded">
                                <strong>Puskesmas C</strong>
                                <span class="badge badge-pending float-end">Sedang</span>
                                <small class="text-muted d-block">Kekurangan: Sanitarian</small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <div class="d-flex align-items-center gap-3">
                        <span><i class="bi bi-list me-2"></i>Riwayat Pendistribusian</span>
                        <div class="search-wrapper">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control form-control-sm" placeholder="Cari..." id="search-distribusi">
                        </div>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0" id="distribusi-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>SDM</th>
                                    <th>Asal</th>
                                    <th>Tujuan</th>
                                    <th>Jenis</th>
                                    <th>Tanggal</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="distribusi-body">
                                <tr><td colspan="8" class="text-center py-4">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PENDAYAGUNAAN SECTION -->
        <section id="pendayagunaan" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-person-workspace me-2"></i>Pendayagunaan SDM Kesehatan</h4>
                    <div class="breadcrumb-custom">Optimalisasi Tenaga Kesehatan</div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper blue"><i class="bi bi-clock-history"></i></div>
                        <h2 id="beban-kerja">85%</h2>
                        <p>Rata-rata Beban Kerja</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper green"><i class="bi bi-check-circle"></i></div>
                        <h2 id="kesesuaian">92%</h2>
                        <p>Kesesuaian Kompetensi</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper orange"><i class="bi bi-graph-up-arrow"></i></div>
                        <h2 id="produktivitas">78%</h2>
                        <p>Produktivitas</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper purple"><i class="bi bi-people"></i></div>
                        <h2 id="tim">24</h2>
                        <p>Tim Pelayanan</p>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <i class="bi bi-table me-2"></i>Data Pendayagunaan
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0" id="pendayagunaan-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>SDM</th>
                                    <th>Fasyankes</th>
                                    <th>Beban Kerja</th>
                                    <th>Kesesuaian</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="pendayagunaan-body">
                                <tr><td colspan="7" class="text-center py-4">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PENGEMBANGAN SECTION -->
        <section id="pengembangan" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-mortarboard me-2"></i>Pengembangan & Pembinaan</h4>
                    <div class="breadcrumb-custom">Pendidikan, Pelatihan & Pengembangan Karier</div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper blue"><i class="bi bi-book"></i></div>
                        <h2 id="diklat">45</h2>
                        <p>Program Diklat</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper green"><i class="bi bi-award"></i></div>
                        <h2 id="sertifikasi">128</h2>
                        <p>Sertifikasi</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper orange"><i class="bi bi-arrow-up-circle"></i></div>
                        <h2 id="jenjang">32</h2>
                        <p>Kenaikan Jenjang JF</p>
                    </div>
                </div>
                <div class="col-lg-3">
                    <div class="stat-card">
                        <div class="icon-wrapper purple"><i class="bi bi-person-plus"></i></div>
                        <h2 id="mentoring">18</h2>
                        <p>Program Mentoring</p>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <div class="d-flex align-items-center gap-3">
                        <span><i class="bi bi-list me-2"></i>Riwayat Pengembangan</span>
                        <div class="search-wrapper">
                            <i class="bi bi-search"></i>
                            <input type="text" class="form-control form-control-sm" placeholder="Cari..." id="search-pengembangan">
                        </div>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0" id="pengembangan-table">
                            <thead>
                                <tr>
                                    <th>ID</th>
                                    <th>Program</th>
                                    <th>Jenis</th>
                                    <th>Peserta</th>
                                    <th>Tanggal</th>
                                    <th>Status</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody id="pengembangan-body">
                                <tr><td colspan="7" class="text-center py-4">Memuat data...</td></tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- MONEV SECTION -->
        <section id="monev" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-bar-chart-steps me-2"></i>Monitoring & Evaluasi</h4>
                    <div class="breadcrumb-custom">Indikator Kinerja & Capaian Target</div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-lg-6">
                    <div class="chart-container">
                        <h5><i class="bi bi-target me-2"></i>Capaian Indikator Kinerja</h5>
                        <canvas id="kpiChart" height="150"></canvas>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="chart-container">
                        <h5><i class="bi bi-check-square me-2"></i>Evaluasi Distribusi & Pendayagunaan</h5>
                        <canvas id="evalChart" height="150"></canvas>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <i class="bi bi-list-check me-2"></i>Temuan & Tindak Lanjut
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Temuan</th>
                                    <th>Kategori</th>
                                    <th>Tanggal</th>
                                    <th>Tindak Lanjut</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Kekurangan dokter di Puskesmas C</td>
                                    <td>Distribusi</td>
                                    <td>2024-01-15</td>
                                    <td>Usulkan penempatan dokter</td>
                                    <td><span class="badge badge-pending">Proses</span></td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Beban kerja perawat tinggi</td>
                                    <td>Pendayagunaan</td>
                                    <td>2024-01-10</td>
                                    <td>Recruitment tambahan</td>
                                    <td><span class="badge badge-active">Selesai</span></td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>STR kadaluarsa</td>
                                    <td>Kompetensi</td>
                                    <td>2024-01-05</td>
                                    <td>Koordinasi perpanjangan</td>
                                    <td><span class="badge badge-pending">Proses</span></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PELAPORAN SECTION -->
        <section id="pelaporan" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-file-earmark-text me-2"></i>Pelaporan & Dokumen</h4>
                    <div class="breadcrumb-custom">Satu Pintu Output & Arsip</div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="card text-center p-4" style="cursor: pointer;" onclick="generateReport('tahunan')">
                        <i class="bi bi-file-earmark-text text-primary" style="font-size: 48px;"></i>
                        <h5 class="mt-3">Laporan Tahunan</h5>
                        <p class="text-muted small">Download laporan tahunan SDMK</p>
                        <button class="btn btn-outline-primary btn-sm"><i class="bi bi-download me-1"></i>Download</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center p-4" style="cursor: pointer;" onclick="generateReport('perencanaan')">
                        <i class="bi bi-file-earmark-bar-graph text-success" style="font-size: 48px;"></i>
                        <h5 class="mt-3">Laporan Perencanaan</h5>
                        <p class="text-muted small">Download laporan perencanaan</p>
                        <button class="btn btn-outline-success btn-sm"><i class="bi bi-download me-1"></i>Download</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center p-4" style="cursor: pointer;" onclick="generateReport('distribusi')">
                        <i class="bi bi-file-earmark-bar-graph text-warning" style="font-size: 48px;"></i>
                        <h5 class="mt-3">Laporan Distribusi</h5>
                        <p class="text-muted small">Download laporan distribusi</p>
                        <button class="btn btn-outline-warning btn-sm"><i class="bi bi-download me-1"></i>Download</button>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="card text-center p-4" style="cursor: pointer;" onclick="generateReport('nasional')">
                        <i class="bi bi-globe text-info" style="font-size: 48px;"></i>
                        <h5 class="mt-3">Rekapitulasi Nasional</h5>
                        <p class="text-muted small">Data agregat nasional</p>
                        <button class="btn btn-outline-info btn-sm"><i class="bi bi-download me-1"></i>Download</button>
                    </div>
                </div>
            </div>
            
            <div class="table-card">
                <div class="card-header">
                    <i class="bi bi-folder me-2"></i>Arsip Dokumen Resmi
                </div>
                <div class="card-body p-0">
                    <div class="table-responsive">
                        <table class="table mb-0">
                            <thead>
                                <tr>
                                    <th>No</th>
                                    <th>Nama Dokumen</th>
                                    <th>Jenis</th>
                                    <th>Tanggal</th>
                                    <th>Ukuran</th>
                                    <th>Aksi</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1</td>
                                    <td>Renstra SDM Kesehatan 2024</td>
                                    <td>PDF</td>
                                    <td>2024-01-15</td>
                                    <td>2.5 MB</td>
                                    <td><button class="btn btn-sm btn-outline-primary"><i class="bi bi-download"></i></button></td>
                                </tr>
                                <tr>
                                    <td>2</td>
                                    <td>Analisis Kebutuhan SDMK</td>
                                    <td>Excel</td>
                                    <td>2024-01-10</td>
                                    <td>1.8 MB</td>
                                    <td><button class="btn btn-sm btn-outline-primary"><i class="bi bi-download"></i></button></td>
                                </tr>
                                <tr>
                                    <td>3</td>
                                    <td>Peta Sebaran SDMK</td>
                                    <td>PDF</td>
                                    <td>2024-01-05</td>
                                    <td>5.2 MB</td>
                                    <td><button class="btn btn-sm btn-outline-primary"><i class="bi bi-download"></i></button></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PETA & ANALITIK SECTION -->
        <section id="peta" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-map me-2"></i>Peta & Analitik</h4>
                    <div class="breadcrumb-custom">Visualisasi & Analisis Data</div>
                </div>
            </div>
            
            <div class="row mb-4">
                <div class="col-lg-8">
                    <div class="table-card">
                        <div class="card-header">
                            <i class="bi bi-geo-alt me-2"></i>Peta Ketersediaan SDM Kesehatan
                            <div class="heatmap-legend">
                                <span style="background: #27ae60;">Tersedia</span>
                                <span style="background: #f39c12;">Cukup</span>
                                <span style="background: #e74c3c;">Kurang</span>
                                <span style="background: #c0392b;">Kritis</span>
                            </div>
                        </div>
                        <div class="card-body p-0">
                            <div id="petaAnalitikMap" style="height: 500px;"></div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="chart-container">
                        <h5><i class="bi bi-graph-up me-2"></i>Analitik Tren</h5>
                        <canvas id="trenChart" height="200"></canvas>
                    </div>
                    <div class="chart-container">
                        <h5><i class="bi bi-calculator me-2"></i>Simulasi Kebijakan</h5>
                        <div class="mb-3">
                            <label class="form-label">Skenario:</label>
                            <select class="form-select">
                                <option>Penambahan 100 Dokter</option>
                                <option>Rotasi Perawat</option>
                                <option>Recruitment Bidan</option>
                            </select>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Hasil Simulasi:</label>
                            <div class="alert alert-info">
                                Cakupan layanan meningkat 15%<br>
                                Rasio SDMK: 1:750 â†’ 1:680
                            </div>
                        </div>
                        <button class="btn btn-primary-custom w-100">Hitung Simulasi</button>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- PENGATURAN SECTION -->
        <section id="pengaturan" class="section">
            <div class="page-header">
                <div>
                    <h4><i class="bi bi-gear me-2"></i>Pengaturan Sistem</h4>
                    <div class="breadcrumb-custom">Manajemen Sistem & Integrasi</div>
                </div>
            </div>
            
            <div class="row">
                <div class="col-lg-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-database me-2"></i>Konfigurasi Google Sheets
                        </div>
                        <div class="card-body">
                            <form id="settings-form">
                                <div class="mb-3">
                                    <label class="form-label">URL Spreadsheet SDM</label>
                                    <input type="text" class="form-control" id="sheet-sdm" placeholder="https://docs.google.com/spreadsheets/d/...">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">URL Spreadsheet Perencanaan</label>
                                    <input type="text" class="form-control" id="sheet-perencanaan" placeholder="https://docs.google.com/spreadsheets/d/...">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">URL Spreadsheet Distribusi</label>
                                    <input type="text" class="form-control" id="sheet-distribusi" placeholder="https://docs.google.com/spreadsheets/d/...">
                                </div>
                                <div class="mb-3">
                                    <label class="form-label">URL Spreadsheet Pendayagunaan</label>
                                    <input type="text" class="form-control" id="sheet-pendayagunaan" placeholder="https://docs.google.com/spreadsheets/d/...">
                                </div>
                                <button type="submit" class="btn btn-primary-custom">
                                    <i class="bi bi-save me-2"></i>Simpan Pengaturan
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="card mb-4">
                        <div class="card-header">
                            <i class="bi bi-people me-2"></i>Manajemen Pengguna
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>Nama</th>
                                            <th>Role</th>
                                            <th>Status</th>
                                            <th>Aksi</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>Admin Utama</td>
                                            <td>Administrator</td>
                                            <td><span class="badge badge-active">Aktif</span></td>
                                            <td><button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button></td>
                                        </tr>
                                        <tr>
                                            <td>Pimpinan</td>
                                            <td>Viewer</td>
                                            <td><span class="badge badge-active">Aktif</span></td>
                                            <td><button class="btn btn-sm btn-outline-secondary"><i class="bi bi-pencil"></i></button></td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <button class="btn btn-outline-primary mt-2"><i class="bi bi-plus me-2"></i>Tambah Pengguna</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <div class="card-header">
                    <i class="bi bi-journal-text me-2"></i>Log Aktivitas
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table">
                            <thead>
                                <tr>
                                    <th>Waktu</th>
                                    <th>User</th>
                                    <th>Aktivitas</th>
                                    <th>Detail</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2024-02-05 10:30</td>
                                    <td>Admin Utama</td>
                                    <td>Update Data</td>
                                    <td>Perbarui data SDM Jakarta</td>
                                </tr>
                                <tr>
                                    <td>2024-02-05 09:15</td>
                                    <td>Pimpinan</td>
                                    <td>Export Laporan</td>
                                    <td>Download laporan tahunan</td>
                                </tr>
                                <tr>
                                    <td>2024-02-04 16:45</td>
                                    <td>Admin Utama</td>
                                    <td>Login</td>
                                    <td>Sistem login berhasil</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </main>

    <!-- Modal -->
    <div class="modal fade" id="actionModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="modalTitle">Detail</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="modalBody"></div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Google Sheets URLs (Replace with your actual published sheets)
        const GOOGLE_SHEETS = {
            induk: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSample_SDM/pub?output=csv',
            perencanaan: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSample_Planning/pub?output=csv',
            distribusi: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSample_Distribution/pub?output=csv',
            pendayagunaan: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSample_Utilization/pub?output=csv',
            pengembangan: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSample_Development/pub?output=csv'
        };
        
        // Sample Data
        let sampleData = {
            induk: [
                { nik: '3175010101900001', nama: 'Dr. Ahmad Fauzi', jk: 'L', profesi: 'Dokter', spesialisasi: 'Umum', kabkota: 'Jakarta Selatan', fasyankes: 'RSUD Jakarta', status: 'Aktif' },
                { nik: '3175010202850002', nama: 'Siti Nurhaliza', jk: 'P', profesi: 'Perawat', spesialisasi: 'ICU', kabkota: 'Jakarta Pusat', fasyankes: 'RSAB Harapan Kita', status: 'Aktif' },
                { nik: '3275010303900003', nama: 'Budi Santoso', jk: 'L', profesi: 'Bidan', spesialisasi: 'Kandungan', kabkota: 'Bandung', fasyankes: 'Puskesmas Bandung', status: 'Cuti' },
                { nik: '3575010401800004', nama: 'Dewi Lestari', jk: 'P', profesi: 'Apoteker', spesialisasi: 'Farmasi Klinis', kabkota: 'Surabaya', fasyankes: 'RSUD Surabaya', status: 'Aktif' },
                { nik: '3675010505950005', nama: 'Rudi Hermawan', jk: 'L', profesi: 'Sanitarian', spesialisasi: 'Kesehatan Lingkungan', kabkota: 'Yogyakarta', fasyankes: 'Dinas Kesehatan', status: 'Aktif' },
                { nik: '3175010601700006', nama: 'Maya Susanti', jk: 'P', profesi: 'Dokter', spesialisasi: 'Gigi', kabkota: 'Jakarta Barat', fasyankes: 'Puskesmas Jakarta', status: 'Aktif' },
                { nik: '3175010702850007', nama: 'Andi Pratama', jk: 'L', profesi: 'Perawat', spesialisasi: 'IGD', kabkota: 'Jakarta Utara', fasyankes: 'RSUD Jakarta', status: 'Aktif' },
                { nik: '3275010803920008', nama: 'Ratna Dewi', jk: 'P', profesi: 'Bidan', spesialisasi: 'Anak', kabkota: 'Bandung', fasyankes: 'RSIA Bandung', status: 'Aktif' }
            ],
            perencanaan: [
                { id: 'PL001', jenis: 'Analisis Kebutuhan', fasyankes: 'RSUD Jakarta', target: '50 SDMK', periode: '2024', status: 'Selesai' },
                { id: 'PL002', jenis: 'Perhitungan ABK', fasyankes: 'Puskesmas A', target: '25 SDMK', periode: '2024', status: 'Berlangsung' },
                { id: 'PL003', jenis: 'Proyeksi Kebutuhan', fasyankes: 'Kabupaten Bogor', target: '200 SDMK', periode: '2024-2029', status: 'Draft' },
                { id: 'PL004', jenis: 'Gap Analysis', fasyankes: 'RSUD Bandung', target: '30 SDMK', periode: '2024', status: 'Review' }
            ],
            distribusi: [
                { id: 'DIS001', sdm: 'Dr. Ahmad Fauzi', asal: 'Jakarta', tujuan: 'RSUD Bekasi', jenis: 'Penugasan', tanggal: '2024-02-01', status: 'Berlangsung' },
                { id: 'DIS002', sdm: 'Siti Nurhaliza', asal: 'Jakarta', tujuan: 'RSUD Bandung', jenis: 'Rotasi', tanggal: '2024-01-20', status: 'Selesai' },
                { id: 'DIS003', sdm: 'Budi Santoso', asal: 'Bandung', tujuan: 'Puskesmas C', jenis: 'Mutasi', tanggal: '2024-02-15', status: 'Proses' },
                { id: 'DIS004', sdm: 'Dewi Lestari', asal: 'Surabaya', tujuan: 'Yogyakarta', jenis: 'Penugasan Khusus', tanggal: '2024-03-01', status: 'Pending' }
            ],
            pendayagunaan: [
                { id: 'PD001', sdm: 'Dr. Ahmad Fauzi', fasyankes: 'RSUD Jakarta', beban_kerja: '85%', kesesuaian: '90%', status: 'Optimal' },
                { id: 'PD002', sdm: 'Siti Nurhaliza', fasyankes: 'RSAB Harapan Kita', beban_kerja: '95%', kesesuaian: '85%', status: 'Overload' },
                { id: 'PD003', sdm: 'Dewi Lestari', fasyankes: 'RSUD Surabaya', beban_kerja: '75%', kesesuaian: '95%', status: 'Optimal' }
            ],
            pengembangan: [
                { id: 'PG001', program: 'Pelatihan ICU', jenis: 'Diklat', peserta: '25 SDMK', tanggal: '2024-03-15', status: 'Berlangsung' },
                { id: 'PG002', program: 'Spesialis Anak', jenis: 'Pendidikan', peserta: '10 SDMK', tanggal: '2024-02-01', status: 'Aktif' },
                { id: 'PG003', program: 'Uji Kompetensi', jenis: 'Sertifikasi', peserta: '50 SDMK', tanggal: '2024-04-10', status: 'Rencana' }
            ]
        };
        
        let modal = null;
        let maps = {};
        
        document.addEventListener('DOMContentLoaded', function() {
            modal = new bootstrap.Modal(document.getElementById('actionModal'));
            initNavigation();
            loadAllData();
            initMaps();
            initCharts();
        });
        
        function initNavigation() {
            document.querySelectorAll('.sidebar .nav-link').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const section = this.dataset.section;
                    
                    document.querySelectorAll('.sidebar .nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                    
                    document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
                    document.getElementById(section).classList.add('active');
                    
                    // Initialize map when opening distribusi or peta section
                    if (section === 'distribusi' && maps.distribusi) {
                        setTimeout(() => maps.distribusi.invalidateSize(), 100);
                    }
                    if (section === 'peta' && maps.peta) {
                        setTimeout(() => maps.peta.invalidateSize(), 100);
                    }
                });
            });
        }
        
        async function loadAllData() {
            // Load sample data
            renderAllTables();
            updateStats();
        }
        
        function renderAllTables() {
            renderIndukTable();
            renderPerencanaanTable();
            renderDistribusiTable();
            renderPendayagunaanTable();
            renderPengembanganTable();
        }
        
        function renderIndukTable() {
            const tbody = document.getElementById('induk-body');
            tbody.innerHTML = sampleData.induk.map(item => `
                <tr>
                    <td>${item.nik}</td>
                    <td>${item.nama}</td>
                    <td>${item.jk}</td>
                    <td>${item.profesi}</td>
                    <td>${item.spesialisasi}</td>
                    <td>${item.kabkota}</td>
                    <td>${item.fasyankes}</td>
                    <td><span class="badge badge-status badge-${item.status === 'Aktif' ? 'active' : 'inactive'}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewDetail('induk', '${item.nik}')"><i class="bi bi-eye"></i></button>
                        <button class="btn btn-sm btn-outline-warning" onclick="editItem('induk', '${item.nik}')"><i class="bi bi-pencil"></i></button>
                    </td>
                </tr>
            `).join('');
            
            // Count by profession
            const countByProfesi = {};
            sampleData.induk.forEach(item => {
                countByProfesi[item.profesi] = (countByProfesi[item.profesi] || 0) + 1;
            });
            
            document.getElementById('count-dokter').textContent = countByProfesi['Dokter'] || 0;
            document.getElementById('count-perawat').textContent = countByProfesi['Perawat'] || 0;
            document.getElementById('count-bidan').textContent = countByProfesi['Bidan'] || 0;
            document.getElementById('count-apoteker').textContent = countByProfesi['Apoteker'] || 0;
            document.getElementById('count-nakes').textContent = (countByProfesi['Sanitarian'] || 0) + (countByProfesi['Gizi'] || 0);
            document.getElementById('count-nonakes').textContent = 0;
            
            document.getElementById('total-sdm').textContent = sampleData.induk.length;
        }
        
        function renderPerencanaanTable() {
            const tbody = document.getElementById('perencanaan-body');
            tbody.innerHTML = sampleData.perencanaan.map(item => `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.jenis}</td>
                    <td>${item.fasyankes}</td>
                    <td>${item.target}</td>
                    <td>${item.periode}</td>
                    <td><span class="badge badge-status badge-${getStatusClass(item.status)}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewDetail('perencanaan', '${item.id}')"><i class="bi bi-eye"></i></button>
                    </td>
                </tr>
            `).join('');
        }
        
        function renderDistribusiTable() {
            const tbody = document.getElementById('distribusi-body');
            tbody.innerHTML = sampleData.distribusi.map(item => `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.sdm}</td>
                    <td>${item.asal}</td>
                    <td>${item.tujuan}</td>
                    <td>${item.jenis}</td>
                    <td>${item.tanggal}</td>
                    <td><span class="badge badge-status badge-${getStatusClass(item.status)}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewDetail('distribusi', '${item.id}')"><i class="bi bi-eye"></i></button>
                    </td>
                </tr>
            `).join('');
        }
        
        function renderPendayagunaanTable() {
            const tbody = document.getElementById('pendayagunaan-body');
            tbody.innerHTML = sampleData.pendayagunaan.map(item => `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.sdm}</td>
                    <td>${item.fasyankes}</td>
                    <td>${item.beban_kerja}</td>
                    <td>${item.kesesuaian}</td>
                    <td><span class="badge badge-status badge-${item.status === 'Optimal' ? 'active' : 'pending'}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewDetail('pendayagunaan', '${item.id}')"><i class="bi bi-eye"></i></button>
                    </td>
                </tr>
            `).join('');
        }
        
        function renderPengembanganTable() {
            const tbody = document.getElementById('pengembangan-body');
            tbody.innerHTML = sampleData.pengembangan.map(item => `
                <tr>
                    <td>${item.id}</td>
                    <td>${item.program}</td>
                    <td>${item.jenis}</td>
                    <td>${item.peserta}</td>
                    <td>${item.tanggal}</td>
                    <td><span class="badge badge-status badge-${getStatusClass(item.status)}">${item.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-outline-primary" onclick="viewDetail('pengembangan', '${item.id}')"><i class="bi bi-eye"></i></button>
                    </td>
                </tr>
            `).join('');
            
            document.getElementById('diklat').textContent = sampleData.pengembangan.filter(p => p.jenis === 'Diklat').length;
            document.getElementById('sertifikasi').textContent = sampleData.pengembangan.filter(p => p.jenis === 'Sertifikasi').length;
            document.getElementById('jenjang').textContent = sampleData.pengembangan.filter(p => p.jenis === 'Pendidikan').length;
            document.getElementById('mentoring').textContent = 18;
        }
        
        function updateStats() {
            document.getElementById('analisis-kebutuhan').textContent = sampleData.perencanaan.length;
            document.getElementById('proyeksi').textContent = 5;
            document.getElementById('perhitungan-abk').textContent = 8;
            document.getElementById('usulan-formasi').textContent = 15;
            document.getElementById('total-distribusi').textContent = sampleData.distribusi.length;
        }
        
        function getStatusClass(status) {
            const lower = status.toLowerCase();
            if (lower.includes('selesai') || lower.includes('aktif') || lower.includes('optimal')) return 'active';
            if (lower.includes('proses') || lower.includes('berlangsung') || lower.includes('review')) return 'pending';
            return 'inactive';
        }
        
        function initMaps() {
            // Dashboard Map
            maps.dashboard = L.map('dashboardMap').setView([-6.2088, 106.8456], 10);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(maps.dashboard);
            
            // Add some markers
            const locations = [
                { lat: -6.2088, lng: 106.8456, title: 'Jakarta', status: 'available' },
                { lat: -6.9175, lng: 107.6191, title: 'Bandung', status: 'warning' },
                { lat: -7.2575, lng: 112.7521, title: 'Surabaya', status: 'available' }
            ];
            
            locations.forEach(loc => {
                const color = loc.status === 'available' ? '#27ae60' : '#f39c12';
                L.circleMarker([loc.lat, loc.lng], {
                    radius: 10,
                    fillColor: color,
                    color: color,
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.8
                }).addTo(maps.dashboard).bindPopup(loc.title);
            });
            
            // Distribusi Map
            maps.distribusi = L.map('distribusiMap').setView([-6.2088, 106.8456], 8);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(maps.distribusi);
            
            // Peta Analitik Map
            maps.peta = L.map('petaAnalitikMap').setView([-6.2088, 106.8456], 5);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(maps.peta);
            
            // Add heatmap-style circles
            const regions = [
                { lat: -6.2088, lng: 106.8456, title: 'DKI Jakarta', coverage: 85 },
                { lat: -6.9175, lng: 107.6191, title: 'Jawa Barat', coverage: 72 },
                { lat: -7.2575, lng: 112.7521, title: 'Jawa Timur', coverage: 78 },
                { lat: -6.9667, lng: 110.4206, title: 'Jawa Tengah', coverage: 68 },
                { lat: -8.4095, lng: 115.1889, title: 'Bali', coverage: 92 }
            ];
            
            regions.forEach(region => {
                let color = '#27ae60';
                if (region.coverage < 60) color = '#c0392b';
                else if (region.coverage < 75) color = '#e74c3c';
                else if (region.coverage < 85) color = '#f39c12';
                
                L.circleMarker([region.lat, region.lng], {
                    radius: region.coverage / 5,
                    fillColor: color,
                    color: color,
                    weight: 1,
                    opacity: 1,
                    fillOpacity: 0.6
                }).addTo(maps.peta).bindPopup(`<b>${region.title}</b><br>Cakupan: ${region.coverage}%`);
            });
        }
        
        function initCharts() {
            // Trend Chart
            const trendCtx = document.getElementById('trendChart').getContext('2d');
            new Chart(trendCtx, {
                type: 'line',
                data: {
                    labels: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    datasets: [{
                        label: 'Dokter',
                        data: [120, 135, 142, 155, 168, 180],
                        borderColor: '#3498db',
                        tension: 0.3,
                        fill: false
                    }, {
                        label: 'Perawat',
                        data: [450, 478, 495, 520, 545, 580],
                        borderColor: '#27ae60',
                        tension: 0.3,
                        fill: false
                    }, {
                        label: 'Bidan',
                        data: [280, 290, 305, 320, 335, 350],
                        borderColor: '#9b59b6',
                        tension: 0.3,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom' } },
                    scales: { y: { beginAtZero: false } }
                }
            });
            
            // Jenis Chart
            const jenisCtx = document.getElementById('jenisChart').getContext('2d');
            new Chart(jenisCtx, {
                type: 'doughnut',
                data: {
                    labels: ['Dokter', 'Perawat', 'Bidan', 'Apoteker', 'Sanitarian', 'Lainnya'],
                    datasets: [{
                        data: [180, 580, 350, 85, 65, 120],
                        backgroundColor: ['#3498db', '#27ae60', '#9b59b6', '#e67e22', '#e74c3c', '#95a5a6']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom' } }
                }
            });
            
            // KPI Chart
            const kpiCtx = document.getElementById('kpiChart').getContext('2d');
            new Chart(kpiCtx, {
                type: 'radar',
                data: {
                    labels: ['Cakupan', 'Kualitas', 'Distribusi', 'Produktivitas', 'Kompetensi'],
                    datasets: [{
                        label: 'Capaian',
                        data: [85, 78, 72, 88, 82],
                        backgroundColor: 'rgba(26, 95, 122, 0.2)',
                        borderColor: '#1a5f7a',
                        pointBackgroundColor: '#1a5f7a'
                    }]
                },
                options: {
                    responsive: true,
                    scales: { r: { beginAtZero: true, max: 100 } }
                }
            });
            
            // Eval Chart
            const evalCtx = document.getElementById('evalChart').getContext('2d');
            new Chart(evalCtx, {
                type: 'bar',
                data: {
                    labels: ['Distribusi', 'Pendayagunaan', 'Pengembangan', 'Pelayanan'],
                    datasets: [{
                        label: 'Target',
                        data: [100, 100, 100, 100],
                        backgroundColor: 'rgba(231, 76, 60, 0.3)'
                    }, {
                        label: 'Capaian',
                        data: [72, 85, 65, 88],
                        backgroundColor: 'rgba(39, 174, 96, 0.8)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { position: 'bottom' } }
                }
            });
            
            // Tren Chart
            const trenCtx = document.getElementById('trenChart').getContext('2d');
            new Chart(trenCtx, {
                type: 'line',
                data: {
                    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
                    datasets: [{
                        label: 'Ketersediaan',
                        data: [75, 78, 76, 82, 80, 85],
                        borderColor: '#27ae60',
                        tension: 0.3,
                        fill: true,
                        backgroundColor: 'rgba(39, 174, 96, 0.1)'
                    }]
                },
                options: {
                    responsive: true,
                    plugins: { legend: { display: false } }
                }
            });
        }
        
        function viewDetail(type, id) {
            const data = sampleData[type].find(item => item.id === id || item.nik === id);
            if (!data) return;
            
            document.getElementById('modalTitle').textContent = `Detail ${type.charAt(0).toUpperCase() + type.slice(1)}`;
            
            let content = '<div class="table-responsive"><table class="table table-striped">';
            for (const [key, value] of Object.entries(data)) {
                content += `<tr><td><strong>${key.replace(/_/g, ' ')}</strong></td><td>${value}</td></tr>`;
            }
            content += '</table></div>';
            
            document.getElementById('modalBody').innerHTML = content;
            modal.show();
        }
        
        function editItem(type, id) {
            alert('Fitur edit akan membuka formulir edit data');
        }
        
        function showAddModal(type) {
            document.getElementById('modalTitle').textContent = `Tambah Data ${type.charAt(0).toUpperCase() + type.slice(1)}`;
            document.getElementById('modalBody').innerHTML = `
                <div class="alert alert-info">
                    <i class="bi bi-info-circle me-2"></i>
                    Untuk menambahkan data, silakan update melalui Google Sheets yang telah dikonfigurasi di menu Pengaturan.
                </div>
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Tutup</button>
            `;
            modal.show();
        }
        
        function refreshAllData() {
            location.reload();
        }
        
        function generateReport(type) {
            alert(`Laporan ${type} sedang digenerate...`);
        }
        
        // Search functionality
        document.getElementById('search-induk')?.addEventListener('keyup', function() {
            filterTable('induk-table', this.value);
        });
        
        document.getElementById('search-perencanaan')?.addEventListener('keyup', function() {
            filterTable('perencanaan-table', this.value);
        });
        
        document.getElementById('search-distribusi')?.addEventListener('keyup', function() {
            filterTable('distribusi-table', this.value);
        });
        
        function filterTable(tableId, searchValue) {
            const table = document.getElementById(tableId);
            const rows = table.getElementsByTagName('tr');
            const search = searchValue.toLowerCase();
            
            for (let i = 1; i < rows.length; i++) {
                const rowText = rows[i].textContent.toLowerCase();
                rows[i].style.display = rowText.includes(search) ? '' : 'none';
            }
        }
        
        // Settings form
        document.getElementById('settings-form')?.addEventListener('submit', function(e) {
            e.preventDefault();
            alert('Pengaturan berhasil disimpan! Data akan dimuat ulang.');
        });
    </script>
</body>
</html>
