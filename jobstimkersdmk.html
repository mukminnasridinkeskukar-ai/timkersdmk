<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Tugas Pokok & Fungsi</title>

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  font-family:'Inter',sans-serif;
  background:#f4f6fb;
  color:#111;
}

/* HEADER */
header{
  margin:20px;
  padding:28px;
  background:linear-gradient(135deg,#6366f1,#818cf8);
  color:white;
  border-radius:26px;
  box-shadow:0 25px 60px rgba(0,0,0,.25);
}

/* CONTROLS */
.controls{
  margin:20px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
}
.controls input,
.controls select{
  padding:14px;
  border-radius:14px;
  border:1px solid #ddd;
  font-size:14px;
  min-width:220px;
}

/* TABLE */
.table-wrap{
  margin:20px;
  background:white;
  border-radius:26px;
  box-shadow:0 20px 45px rgba(0,0,0,.15);
  overflow-x:auto;
}
table{
  width:100%;
  min-width:900px;
  border-collapse:collapse;
}
th,td{
  padding:14px;
  border-bottom:1px solid #eee;
  font-size:14px;
}
th{
  background:#eef2ff;
  text-align:left;
}
tbody tr:hover{
  background:#f9fafb;
}
a.btn{
  background:#6366f1;
  color:white;
  padding:8px 14px;
  border-radius:10px;
  text-decoration:none;
  font-size:13px;
}

/* MOBILE CARD */
.cards{
  display:none;
  margin:20px;
}
.card{
  background:white;
  border-radius:22px;
  padding:18px;
  margin-bottom:16px;
  box-shadow:0 15px 40px rgba(0,0,0,.15);
}

/* RESPONSIVE */
@media(max-width:768px){
  table{display:none}
  .cards{display:block}
}
</style>
</head>

<body>

<header>
  <h1>ðŸ“Š Dashboard Tugas Pokok & Fungsi</h1>
  <p>Monitoring kegiatan dan penanggung jawab</p>
</header>

<div class="controls">
  <input id="search" placeholder="ðŸ” Cari tugas / sub kegiatan">
  <select id="filterPJ">
    <option value="">ðŸ“Œ Semua Penanggung Jawab</option>
  </select>
</div>

<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>No</th>
        <th>Tugas Pokok dan Fungsi</th>
        <th>Sub Kegiatan</th>
        <th>Penanggung Jawab</th>
        <th>Pendamping</th>
        <th>Link</th>
      </tr>
    </thead>
    <tbody id="tableData"></tbody>
  </table>
</div>

<div class="cards" id="cardData"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxqNCngdvo7D3VYVxdoM9jdH6yh9IuOS79WzPKYfAyn_Z_QD3NMV22HhTqKZl4a33ve/exec";
let allData = [];

/* LOAD DATA */
fetch(API_URL,{ method:"POST" })
.then(r=>r.json())
.then(d=>{
  console.log("DATA:", d);
  allData = d;
  render(d);
  fillFilter(d);
});

/* RENDER */
function render(data){
  tableData.innerHTML="";
  cardData.innerHTML="";
  data.forEach(d=>{
    tableData.innerHTML += `
      <tr>
        <td>${d.no}</td>
        <td>${d.tugas}</td>
        <td>${d.sub}</td>
        <td>${d.pj}</td>
        <td>${d.pendamping}</td>
        <td>${d.link ? `<a class="btn" target="_blank" href="${d.link}">Buka</a>` : "-"}</td>
      </tr>
    `;
    cardData.innerHTML += `
      <div class="card">
        <h4>${d.tugas}</h4>
        <p>${d.sub}</p>
        <p><b>PJ:</b> ${d.pj}</p>
        <p><b>Pendamping:</b> ${d.pendamping}</p>
        ${d.link ? `<a class="btn" target="_blank" href="${d.link}">Buka</a>` : ""}
      </div>
    `;
  });
}

/* FILTER */
function fillFilter(data){
  const pjSet = [...new Set(data.map(d=>d.pj))];
  pjSet.forEach(p=>{
    if(p) filterPJ.innerHTML += `<option>${p}</option>`;
  });
}

search.oninput = applyFilter;
filterPJ.onchange = applyFilter;

function applyFilter(){
  const q = search.value.toLowerCase();
  const pj = filterPJ.value;
  render(allData.filter(d=>{
    const text =
      d.tugas.toLowerCase().includes(q) ||
      d.sub.toLowerCase().includes(q);
    return (!pj || d.pj === pj) && text;
  }));
}
</script>

</body>
</html>
