<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Tugas Tim</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
body{margin:0;font-family:Inter,sans-serif;background:#f4f6fb;color:#111}
header{
  margin:20px;
  padding:28px;
  color:#fff;
  border-radius:24px;
  background:linear-gradient(135deg,#6366f1,#818cf8);
  box-shadow:0 20px 50px rgba(0,0,0,.25);
}
.controls{
  margin:20px;
  display:flex;
  gap:14px;
  flex-wrap:wrap;
}
.controls input,.controls select{
  padding:14px;
  border-radius:14px;
  border:1px solid #ddd;
  min-width:220px;
}
.table-wrap{
  margin:20px;
  background:#fff;
  border-radius:24px;
  box-shadow:0 18px 45px rgba(0,0,0,.15);
  overflow-x:auto;
}
table{width:100%;min-width:900px;border-collapse:collapse}
th,td{padding:14px;border-bottom:1px solid #eee}
th{background:#eef2ff}
tbody tr:hover{background:#f9fafb}
a.btn{
  background:#6366f1;
  color:white;
  padding:8px 14px;
  border-radius:10px;
  text-decoration:none;
}
.cards{display:none;margin:20px}
.card{
  background:#fff;
  border-radius:20px;
  padding:18px;
  margin-bottom:16px;
  box-shadow:0 15px 40px rgba(0,0,0,.15);
}
@media(max-width:768px){
  table{display:none}
  .cards{display:block}
}
</style>
</head>

<body>

<header>
  <h1>ðŸ“Š Dashboard Tugas Pokok & Fungsi</h1>
  <p>Monitoring kegiatan tim</p>
</header>

<div class="controls">
  <input id="search" placeholder="ðŸ” Cari tugas / sub kegiatan">
  <select id="filterPJ">
    <option value="">ðŸ“Œ Semua Penanggung Jawab</option>
  </select>
</div>

<div class="table-wrap">
  <table>
    <thead>
      <tr>
        <th>No</th>
        <th>Tugas Pokok</th>
        <th>Sub Kegiatan</th>
        <th>PJ</th>
        <th>Pendamping</th>
        <th>Link</th>
      </tr>
    </thead>
    <tbody id="tableData"></tbody>
  </table>
</div>

<div class="cards" id="cardData"></div>

<script>
const API_URL = "https://script.google.com/macros/s/AKfycbxOYvzPXOecwy1Z_kEeAtjvUrrEjoLYdW2PFtG8-SiJ8cR9vxJbHgkPA6LOD9oPY7jS/exec";
let allData=[];

fetch(API_URL,{
  method:"POST",
  body:new URLSearchParams({action:"data"})
})
.then(r=>r.json())
.then(d=>{
  allData=d;
  render(d);
  fillFilter(d);
});

function render(data){
  tableData.innerHTML="";
  cardData.innerHTML="";
  data.forEach(d=>{
    tableData.innerHTML+=`
      <tr>
        <td>${d.NO}</td>
        <td>${d.TUGAS}</td>
        <td>${d.SUB}</td>
        <td>${d.PJ}</td>
        <td>${d.PENDAMPING}</td>
        <td>${d.LINK?`<a class="btn" target="_blank" href="${d.LINK}">Buka</a>`:"-"}</td>
      </tr>`;
    cardData.innerHTML+=`
      <div class="card">
        <h4>${d.TUGAS}</h4>
        <p>${d.SUB}</p>
        <p><b>PJ:</b> ${d.PJ}</p>
        <p><b>Pendamping:</b> ${d.PENDAMPING}</p>
        ${d.LINK?`<a class="btn" target="_blank" href="${d.LINK}">Buka</a>`:""}
      </div>`;
  });
}

function fillFilter(data){
  filterPJ.innerHTML='<option value="">ðŸ“Œ Semua Penanggung Jawab</option>';
  [...new Set(data.map(d=>d.PJ))].forEach(p=>{
    if(p) filterPJ.innerHTML+=`<option>${p}</option>`;
  });
}

search.oninput=applyFilter;
filterPJ.onchange=applyFilter;

function applyFilter(){
  const q=search.value.toLowerCase();
  const pj=filterPJ.value;
  render(allData.filter(d=>{
    const s=d.TUGAS.toLowerCase().includes(q)||d.SUB.toLowerCase().includes(q);
    return(!pj||d.PJ===pj)&&s;
  }));
}
</script>

</body>
</html>
