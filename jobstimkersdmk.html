<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Kegiatan</title>

<style>
:root{
  --primary:#4f46e5;
  --bg:#f4f6fb;
  --card:#ffffff;
}
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:var(--bg);
}
#dashboard{
  width:100%;
  padding:20px;
  box-sizing:border-box;
}
header{
  background:linear-gradient(135deg,var(--primary),#6366f1);
  color:white;
  padding:22px;
  border-radius:18px;
  box-shadow:0 12px 35px rgba(0,0,0,.2);
}
.controls{
  display:flex;
  gap:14px;
  flex-wrap:wrap;
  margin:20px 0;
}
.controls input,
.controls select{
  padding:12px 14px;
  border-radius:12px;
  border:1px solid #ddd;
  min-width:230px;
  box-shadow:0 4px 12px rgba(0,0,0,.06);
}
.table-wrap{
  position:relative;
  width:100%;
  background:white;
  border-radius:18px;
  box-shadow:0 15px 40px rgba(0,0,0,.1);
  overflow-x:auto;
}
table{
  width:100%;
  min-width:950px;
  border-collapse:collapse;
}
thead th{
  position:sticky;
  top:0;
  background:#eef2ff;
}
th,td{
  padding:14px 16px;
  text-align:left;
  white-space:nowrap;
}
tbody tr:hover{background:#f9fafb}
.link-btn{
  background:var(--primary);
  color:white;
  padding:8px 14px;
  border-radius:10px;
  text-decoration:none;
  font-weight:600;
}
footer{
  text-align:center;
  padding:16px;
  color:#666;
}
</style>
</head>

<body>

<div id="dashboard">
  <header>
    <h1>ðŸ“Š Dashboard Kegiatan</h1>
    <p>Sistem Informasi Internal</p>
  </header>

  <div class="controls">
    <input type="text" id="search" placeholder="ðŸ” Cari kegiatan / pengampu / username">
    <select id="filterPengampu">
      <option value="">ðŸ“Œ Semua Pengampu</option>
    </select>
  </div>

  <div class="table-wrap">
    <table>
      <thead>
        <tr>
          <th>No</th>
          <th>Kegiatan</th>
          <th>Pengampu</th>
          <th>Link Akses</th>
          <th>Username</th>
          <th>Password</th>
        </tr>
      </thead>
      <tbody id="tableData"></tbody>
    </table>
  </div>
</div>

<footer>Â© Dashboard Internal</footer>

<script>
const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbxPO3MPsFCmgnIJ_v6FYQ5cZWJ6IB96-bbQtneelfAXiVC7DUtwVt4qxWK8yvY4ctdy/exec";
let allData = [];

window.onload = loadData;

function loadData(){
  fetch(WEB_APP_URL,{
    method:"POST",
    body:new URLSearchParams({action:"data"})
  })
  .then(r=>r.json())
  .then(data=>{
    allData = data;
    renderTable(data);
    fillFilter(data);
  });
}

function renderTable(data){
  tableData.innerHTML="";
  data.forEach((d,i)=>{
    tableData.innerHTML+=`
      <tr>
        <td>${i+1}</td>
        <td>${d.Kegiatan}</td>
        <td>${d.Pengampu}</td>
        <td><a class="link-btn" href="${d["Link Akses"]}" target="_blank">Buka</a></td>
        <td>${d.Username}</td>
        <td>${d.Password}</td>
      </tr>`;
  });
}

function fillFilter(data){
  filterPengampu.innerHTML = `<option value="">ðŸ“Œ Semua Pengampu</option>`;
  [...new Set(data.map(d=>d.Pengampu))].forEach(p=>{
    filterPengampu.innerHTML+=`<option value="${p}">${p}</option>`;
  });
}

search.addEventListener("input",filterData);
filterPengampu.addEventListener("change",filterData);

function filterData(){
  const q = search.value.toLowerCase();
  const p = filterPengampu.value;
  renderTable(
    allData.filter(d=>{
      const s =
        d.Kegiatan.toLowerCase().includes(q) ||
        d.Pengampu.toLowerCase().includes(q) ||
        d.Username.toLowerCase().includes(q);
      return (!p || d.Pengampu===p) && s;
    })
  );
}
</script>

</body>
</html>
