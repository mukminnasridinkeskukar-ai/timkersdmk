<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Form Pelaporan Kegiatan SDMK</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
<style>
body{background:#f4f6f9;font-family:Segoe UI,Arial}
.card{border-radius:18px}
</style>
</head>

<body>
<div class="container py-5">
  <div class="card shadow p-4">
    <h3 class="fw-bold text-center mb-4">
      Form Pelaporan Kegiatan Pengabdian Masyarakat
    </h3>

<form id="form">

<h5>A. Data PIC</h5>
<input class="form-control mb-3" name="email" type="email" placeholder="Email Aktif" required>
<input class="form-control mb-3" name="pic_name" placeholder="Nama PIC" required>
<input class="form-control mb-3" name="pic_phone" placeholder="Nomor Telpon / WhatsApp" required>

<h5 class="mt-4">B. Data Kegiatan</h5>
<input class="form-control mb-3" name="activity_name" placeholder="Nama Kegiatan" required>
<input class="form-control mb-3" name="location" placeholder="Tempat Kegiatan" required>

<div class="row">
  <div class="col"><input class="form-control mb-3" name="activity_date" type="date" required></div>
  <div class="col"><input class="form-control mb-3" name="activity_time" type="time" required></div>
</div>

<input class="form-control mb-3" name="participant_count" type="number" placeholder="Jumlah Peserta" required>

<h5 class="mt-4">C. Upload Dokumen</h5>
<input class="form-control mb-3" type="file" id="participant_list" required>
<input class="form-control mb-3" type="file" id="recommendation" required>
<input class="form-control mb-3" type="file" id="photo_docs" required>
<input class="form-control mb-3" type="file" id="video_docs" required>
<input class="form-control mb-3" type="file" id="letter_request" required>
<input class="form-control mb-3" type="file" id="attendance" required>
<input class="form-control mb-3" type="file" id="minutes" required>

<button class="btn btn-primary btn-lg w-100 mt-4">Kirim</button>

</form>
  </div>
</div>

<script>
const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxE6nk20uDn5QAoYv_7emT-YHGoc54UZFTBjI5F0-l8VSpce_aMWkzNNkOvWqeu3ao58Q/exec";

const toBase64 = file => new Promise(res=>{
  const r=new FileReader();
  r.onload=()=>res(JSON.stringify({
    name:file.name,
    mimeType:file.type,
    data:r.result.split(",")[1]
  }));
  r.readAsDataURL(file);
});

document.getElementById("form").onsubmit = async e =>{
  e.preventDefault();
  const f=e.target;

  const payload={
    email:f.email.value,
    pic_name:f.pic_name.value,
    pic_phone:f.pic_phone.value,
    activity_name:f.activity_name.value,
    location:f.location.value,
    activity_date:f.activity_date.value,
    activity_time:f.activity_time.value,
    participant_count:f.participant_count.value,
    participant_list:await toBase64(participant_list.files[0]),
    recommendation:await toBase64(recommendation.files[0]),
    photo_docs:await toBase64(photo_docs.files[0]),
    video_docs:await toBase64(video_docs.files[0]),
    letter_request:await toBase64(letter_request.files[0]),
    attendance:await toBase64(attendance.files[0]),
    minutes:await toBase64(minutes.files[0])
  };

  await fetch(WEBAPP_URL,{method:"POST",body:new URLSearchParams(payload)});
  alert("Data berhasil dikirim");
  f.reset();
};
</script>
</body>
</html>
