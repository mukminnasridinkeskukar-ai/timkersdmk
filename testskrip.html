<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard Pengabdian Masyarakat (Abdimas)</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@400;500;600;700;800&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #0d9488;
      --primary-dark: #0f766e;
      --accent: #f59e0b;
      --violet: #7c3aed;
      --rose: #e11d48;
      --sky: #0ea5e9;
      --mint: #10b981;
      --bg: linear-gradient(145deg, #f0fdfa 0%, #e0f2fe 50%, #fce7f3 100%);
      --bg-solid: #f0fdfa;
      --text: #0f172a;
      --text-soft: #475569;
      --text-muted: #64748b;
      --lightbox: rgba(255, 255, 255, 0.82);
      --lightbox-border: rgba(255, 255, 255, 0.9);
      --shadow-soft: 0 4px 24px rgba(0, 0, 0, 0.06);
      --shadow-lightbox: 0 8px 32px rgba(0, 0, 0, 0.08), 0 0 0 1px rgba(255, 255, 255, 0.5) inset;
      --shadow-hover: 0 20px 50px rgba(0, 0, 0, 0.12), 0 0 0 1px rgba(255, 255, 255, 0.6) inset;
      --radius: 20px;
      --radius-sm: 12px;
      --font-heading: 'Outfit', sans-serif;
      --font-body: 'Plus Jakarta Sans', sans-serif;
      --font-accent: 'Nunito', sans-serif;
      --ease-out: cubic-bezier(0.22, 1, 0.36, 1);
      --ease-bounce: cubic-bezier(0.34, 1.56, 0.64, 1);
      --duration: 0.4s;
      --duration-slow: 0.6s;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    html { scroll-behavior: smooth; }

    body {
      font-family: var(--font-body);
      font-size: 1.1rem;
      background: var(--bg-solid);
      background: var(--bg);
      background-attachment: fixed;
      color: var(--text);
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* ========== KEYFRAMES ========== */
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(28px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes fadeInDown {
      from { opacity: 0; transform: translateY(-16px); }
      to { opacity: 1; transform: translateY(0); }
    }
    @keyframes scaleIn {
      from { opacity: 0; transform: scale(0.92); }
      to { opacity: 1; transform: scale(1); }
    }
    @keyframes slideInRight {
      from { opacity: 0; transform: translateX(24px); }
      to { opacity: 1; transform: translateX(0); }
    }
    @keyframes bounceIn {
      0% { opacity: 0; transform: scale(0.3); }
      50% { transform: scale(1.05); }
      70% { transform: scale(0.95); }
      100% { opacity: 1; transform: scale(1); }
    }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-8px); }
    }
    @keyframes glow {
      0%, 100% { box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08); }
      50% { box-shadow: 0 12px 48px rgba(13, 148, 136, 0.18); }
    }
    @keyframes gradientShift {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    /* ========== LIGHTBOX BASE (semua box) ========== */
    .lightbox {
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      border-radius: var(--radius);
      box-shadow: var(--shadow-lightbox);
      transition: box-shadow var(--duration) var(--ease-out), transform var(--duration) var(--ease-out);
    }

    /* Header */
    .header {
      font-family: var(--font-heading);
      background: linear-gradient(135deg, var(--primary) 0%, #0f766e 50%, #0e5c54 100%);
      background-size: 200% 200%;
      animation: gradientShift 8s ease infinite;
      color: white;
      padding: 1.1rem 1.75rem;
      display: flex;
      align-items: center;
      justify-content: space-between;
      box-shadow: var(--shadow-soft);
      animation: fadeInDown 0.55s var(--ease-out), gradientShift 10s ease infinite;
      animation-fill-mode: both;
    }
    .header h1 {
      font-size: clamp(1.2rem, 3.5vw, 1.6rem);
      font-weight: 800;
      letter-spacing: -0.02em;
    }
    .back-btn {
      font-family: var(--font-accent);
      font-weight: 600;
      font-size: 1rem;
      background: rgba(255,255,255,0.25);
      border: 1px solid rgba(255,255,255,0.4);
      color: white;
      padding: 0.6rem 1.2rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      display: none;
      transition: all var(--duration) var(--ease-out);
    }
    .back-btn.visible { display: inline-flex; align-items: center; gap: 0.5rem; animation: fadeIn 0.35s var(--ease-out); }
    .back-btn:hover { background: rgba(255,255,255,0.4); transform: translateX(-4px); }
    .back-btn:active { transform: scale(0.97); }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 1.75rem 1.5rem;
      animation: fadeInUp 0.5s var(--ease-out);
    }

    /* ========== BERANDA ========== */
    #beranda {
      min-height: calc(100vh - 64px);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      padding: 2rem;
      text-align: center;
    }
    #beranda.hidden { display: none !important; }

    .beranda-title {
      font-family: var(--font-heading);
      font-size: clamp(2.2rem, 6vw, 3.2rem);
      font-weight: 800;
      margin-bottom: 0.6rem;
      color: var(--text);
      letter-spacing: -0.03em;
      animation: fadeInUp 0.65s var(--ease-out) 0.1s both;
    }
    .beranda-subtitle {
      font-family: var(--font-accent);
      font-size: clamp(1.15rem, 2.5vw, 1.4rem);
      font-weight: 700;
      color: var(--primary);
      margin-bottom: clamp(2.5rem, 6vw, 3.5rem);
      animation: fadeInUp 0.65s var(--ease-out) 0.2s both;
    }

    .menu-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 1.5rem;
      width: 100%;
      max-width: 920px;
    }

    .menu-btn {
      font-family: var(--font-body);
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      border-radius: var(--radius);
      padding: 2rem 1.5rem;
      cursor: pointer;
      transition: all var(--duration) var(--ease-bounce);
      text-decoration: none;
      color: var(--text);
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.85rem;
      box-shadow: var(--shadow-lightbox);
      animation: fadeInUp 0.55s var(--ease-out) both;
    }
    .menu-btn:nth-child(1) { animation-delay: 0.15s; }
    .menu-btn:nth-child(2) { animation-delay: 0.28s; }
    .menu-btn:nth-child(3) { animation-delay: 0.41s; }
    .menu-btn:nth-child(4) { animation-delay: 0.54s; }
    .menu-btn:hover {
      transform: translateY(-10px) scale(1.03);
      box-shadow: var(--shadow-hover);
      animation: float 2.5s ease-in-out infinite;
    }
    .menu-btn:active { transform: translateY(-2px) scale(1); }
    .menu-btn .icon {
      width: 64px;
      height: 64px;
      border-radius: 18px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 2rem;
      transition: transform var(--duration) var(--ease-bounce);
    }
    .menu-btn:hover .icon { transform: scale(1.15) rotate(-3deg); }
    .menu-btn.formulir .icon { background: rgba(16, 185, 129, 0.2); color: var(--mint); }
    .menu-btn.dashboard .icon { background: rgba(245, 158, 11, 0.25); color: var(--accent); }
    .menu-btn.galeri .icon { background: rgba(124, 58, 237, 0.2); color: var(--violet); }
    .menu-btn.admin .icon { background: rgba(225, 29, 72, 0.2); color: var(--rose); }
    .menu-btn span {
      font-family: var(--font-heading);
      font-weight: 700;
      font-size: clamp(1.15rem, 2.2vw, 1.35rem);
    }
    .menu-btn small {
      font-family: var(--font-accent);
      font-size: 0.95rem;
      font-weight: 600;
      color: var(--text-soft);
      transition: color var(--duration);
    }

    /* ========== SECTION ========== */
    .section {
      display: none;
      min-height: calc(100vh - 64px);
      padding: 1.75rem 0;
    }
    .section.active {
      display: block;
      animation: fadeInUp 0.5s var(--ease-out);
    }

    .section-title {
      font-family: var(--font-heading);
      font-size: clamp(1.5rem, 4vw, 1.9rem);
      font-weight: 800;
      margin-bottom: 1.75rem;
      color: var(--text);
      letter-spacing: -0.02em;
    }

    /* ========== FORMULIR ========== */
    .form-card {
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      border-radius: var(--radius);
      padding: 2.25rem;
      box-shadow: var(--shadow-lightbox);
      max-width: 660px;
      margin: 0 auto;
      animation: scaleIn 0.55s var(--ease-out);
      transition: box-shadow var(--duration) var(--ease-out);
    }
    .form-card:hover { box-shadow: var(--shadow-hover); }
    .form-group {
      margin-bottom: 1.4rem;
      animation: slideInRight 0.45s var(--ease-out) both;
    }
    .form-group:nth-child(1) { animation-delay: 0.06s; }
    .form-group:nth-child(2) { animation-delay: 0.12s; }
    .form-group:nth-child(3) { animation-delay: 0.18s; }
    .form-group:nth-child(4) { animation-delay: 0.24s; }
    .form-group:nth-child(5) { animation-delay: 0.3s; }
    .form-group:nth-child(6) { animation-delay: 0.36s; }
    .form-group:nth-child(7) { animation-delay: 0.42s; }
    .form-group:nth-child(8) { animation-delay: 0.48s; }
    .form-group:nth-child(9) { animation-delay: 0.54s; }
    .form-group:nth-child(10) { animation-delay: 0.6s; }
    .form-group label {
      font-family: var(--font-heading);
      font-size: 1.05rem;
      font-weight: 700;
      margin-bottom: 0.5rem;
      color: var(--text);
    }
    .form-group input,
    .form-group textarea,
    .form-group select {
      width: 100%;
      padding: 0.9rem 1.15rem;
      border: 2px solid rgba(255,255,255,0.8);
      border-radius: var(--radius-sm);
      font-family: var(--font-body);
      font-size: 1.05rem;
      background: rgba(255,255,255,0.6);
      transition: all var(--duration) var(--ease-out);
    }
    .form-group input:focus,
    .form-group textarea:focus {
      outline: none;
      border-color: var(--primary);
      background: rgba(255,255,255,0.9);
      box-shadow: 0 0 0 4px rgba(13, 148, 136, 0.2);
    }
    .form-group textarea { min-height: 120px; resize: vertical; }
    .form-hint {
      font-family: var(--font-accent);
      font-size: 0.95rem;
      color: var(--text-muted);
      margin-top: 0.4rem;
    }
    .btn-submit {
      font-family: var(--font-heading);
      font-size: 1.1rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      border: none;
      padding: 1rem 2rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      width: 100%;
      margin-top: 0.5rem;
      transition: all var(--duration) var(--ease-out);
    }
    .btn-submit:hover { transform: translateY(-3px); box-shadow: 0 10px 28px rgba(13, 148, 136, 0.4); }
    .btn-submit:active { transform: translateY(0); }
    .btn-submit:disabled { opacity: 0.6; cursor: not-allowed; transform: none; }
    .form-status {
      font-family: var(--font-accent);
      font-size: 1rem;
      margin-top: 1rem;
      padding: 0.9rem;
      border-radius: var(--radius-sm);
      display: none;
      animation: fadeIn 0.35s var(--ease-out);
    }
    .form-status.success { display: block; background: rgba(16, 185, 129, 0.2); color: #047857; border: 1px solid rgba(16, 185, 129, 0.4); }
    .form-status.error { display: block; background: rgba(225, 29, 72, 0.15); color: #b91c1c; border: 1px solid rgba(225, 29, 72, 0.3); }

    /* ========== DASHBOARD ========== */
    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 1.5rem;
      margin-bottom: 2rem;
    }
    .stat-card {
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      border-radius: var(--radius);
      padding: 1.75rem;
      box-shadow: var(--shadow-lightbox);
      transition: all var(--duration) var(--ease-out);
      animation: fadeInUp 0.55s var(--ease-out) both;
    }
    .stat-card:nth-child(1) { animation-delay: 0.1s; border-left: 4px solid var(--sky); }
    .stat-card:nth-child(2) { animation-delay: 0.22s; border-left: 4px solid var(--mint); }
    .stat-card:hover {
      transform: translateY(-6px);
      box-shadow: var(--shadow-hover);
    }
    .stat-card .value {
      font-family: var(--font-heading);
      font-size: clamp(2rem, 5vw, 2.6rem);
      font-weight: 800;
      color: var(--primary);
      transition: transform 0.35s var(--ease-bounce);
    }
    .stat-card:hover .value { transform: scale(1.08); }
    .stat-card .label {
      font-family: var(--font-accent);
      font-size: 1.05rem;
      font-weight: 700;
      color: var(--text-soft);
      margin-top: 0.35rem;
    }
    .table-wrap {
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      border-radius: var(--radius);
      overflow: auto;
      box-shadow: var(--shadow-lightbox);
      animation: fadeInUp 0.55s var(--ease-out) 0.2s both;
      -webkit-overflow-scrolling: touch;
    }
    .data-table {
      width: 100%;
      min-width: 600px;
      border-collapse: collapse;
      font-size: 1.05rem;
    }
    .data-table th,
    .data-table td {
      padding: 1rem 1.15rem;
      text-align: left;
      border-bottom: 1px solid rgba(255,255,255,0.6);
      transition: background var(--duration) var(--ease-out);
    }
    .data-table th {
      font-family: var(--font-heading);
      font-size: 1rem;
      font-weight: 700;
      background: linear-gradient(135deg, var(--primary), var(--primary-dark));
      color: white;
      white-space: nowrap;
    }
    .data-table tbody tr { animation: fadeIn 0.4s var(--ease-out) both; }
    .data-table tbody tr:nth-child(1) { animation-delay: 0.05s; }
    .data-table tbody tr:nth-child(2) { animation-delay: 0.1s; }
    .data-table tbody tr:nth-child(3) { animation-delay: 0.15s; }
    .data-table tbody tr:nth-child(4) { animation-delay: 0.2s; }
    .data-table tbody tr:nth-child(5) { animation-delay: 0.25s; }
    .data-table tbody tr:nth-child(n+6) { animation-delay: 0.3s; }
    .data-table tbody tr:hover { background: rgba(255,255,255,0.5); }
    .empty-state {
      font-family: var(--font-accent);
      font-size: 1.1rem;
      text-align: center;
      padding: 3rem 2rem;
      color: var(--text-muted);
    }

    /* ========== GALERI ========== */
    .gallery-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 1.5rem;
    }
    .gallery-item {
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow-lightbox);
      aspect-ratio: 4/3;
      position: relative;
      transition: all var(--duration) var(--ease-out);
      animation: scaleIn 0.55s var(--ease-out) both;
    }
    .gallery-item:nth-child(1) { animation-delay: 0.06s; }
    .gallery-item:nth-child(2) { animation-delay: 0.12s; }
    .gallery-item:nth-child(3) { animation-delay: 0.18s; }
    .gallery-item:nth-child(4) { animation-delay: 0.24s; }
    .gallery-item:nth-child(n+5) { animation-delay: 0.3s; }
    .gallery-item:hover {
      transform: translateY(-8px) scale(1.02);
      box-shadow: var(--shadow-hover);
    }
    .gallery-item img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.5s var(--ease-out);
    }
    .gallery-item:hover img { transform: scale(1.1); }
    .gallery-item .caption {
      font-family: var(--font-accent);
      font-size: 1rem;
      font-weight: 700;
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 1.1rem;
      background: linear-gradient(transparent, rgba(0,0,0,0.8));
      color: white;
      transition: padding var(--duration) var(--ease-out);
    }
    .gallery-item:hover .caption { padding-bottom: 1.35rem; }
    .gallery-placeholder {
      font-family: var(--font-accent);
      font-size: 1.1rem;
      font-weight: 700;
      width: 100%;
      height: 100%;
      background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(14, 165, 233, 0.2));
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary);
    }

    /* ========== ADMIN ========== */
    .admin-login {
      font-family: var(--font-body);
      max-width: 420px;
      margin: 2rem auto;
      background: var(--lightbox);
      backdrop-filter: blur(14px);
      -webkit-backdrop-filter: blur(14px);
      border: 1px solid var(--lightbox-border);
      padding: 2.25rem;
      border-radius: var(--radius);
      box-shadow: var(--shadow-lightbox);
      animation: bounceIn 0.6s var(--ease-out);
      transition: box-shadow var(--duration) var(--ease-out);
    }
    .admin-login:hover { box-shadow: var(--shadow-hover); }
    .admin-panel { display: none; }
    .admin-panel.visible { display: block; animation: fadeIn 0.45s var(--ease-out); }
    .admin-login.hidden { display: none; }
    .admin-actions { margin-bottom: 1.5rem; display: flex; gap: 0.75rem; flex-wrap: wrap; }
    .btn-logout {
      font-family: var(--font-accent);
      font-size: 1rem;
      font-weight: 700;
      background: linear-gradient(135deg, #dc2626, #b91c1c);
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: var(--radius-sm);
      cursor: pointer;
      transition: all var(--duration) var(--ease-out);
    }
    .btn-logout:hover { transform: translateY(-2px); box-shadow: 0 6px 20px rgba(220, 38, 38, 0.4); }
    .btn-logout:active { transform: scale(0.98); }
    .btn-aksi {
      font-family: var(--font-accent);
      font-size: 0.9rem;
      font-weight: 700;
      border: none;
      padding: 0.5rem 0.85rem;
      border-radius: 10px;
      cursor: pointer;
      transition: all 0.25s var(--ease-out);
    }
    .btn-aksi:hover { transform: scale(1.08); box-shadow: 0 4px 12px rgba(0,0,0,0.12); }
    .btn-aksi:active { transform: scale(0.98); }
    .btn-aksi.hapus { background: rgba(225, 29, 72, 0.2); color: #b91c1c; }
    .btn-aksi.hapus:hover { background: rgba(225, 29, 72, 0.35); }
    .btn-aksi.tolak { background: rgba(245, 158, 11, 0.25); color: #b45309; }
    .btn-aksi.tolak:hover { background: rgba(245, 158, 11, 0.4); }
    .btn-aksi.diterima { background: rgba(16, 185, 129, 0.25); color: #047857; }
    .btn-aksi.diterima:hover { background: rgba(16, 185, 129, 0.4); }
    .aksi-wrap { display: flex; flex-wrap: wrap; gap: 0.4rem; }

    .hidden { display: none !important; }

    /* ========== RESPONSIVE ========== */
    @media (max-width: 768px) {
      .header { padding: 1rem 1.25rem; }
      .header h1 { font-size: 1.15rem; }
      .back-btn { padding: 0.5rem 1rem; font-size: 0.95rem; }
      .container { padding: 1.25rem 1rem; }
      .menu-grid { grid-template-columns: 1fr 1fr; gap: 1.25rem; }
      .menu-btn { padding: 1.5rem 1.25rem; }
      .menu-btn .icon { width: 56px; height: 56px; font-size: 1.75rem; }
      .menu-btn span { font-size: 1.1rem; }
      .form-card { padding: 1.5rem; border-radius: 16px; }
      .section-title { font-size: 1.4rem; margin-bottom: 1.5rem; }
      .stats-grid { grid-template-columns: 1fr; gap: 1.25rem; margin-bottom: 1.75rem; }
      .stat-card { padding: 1.4rem; }
      .stat-card .value { font-size: 1.9rem; }
      .table-wrap { border-radius: 16px; }
      .data-table th, .data-table td { padding: 0.85rem 0.75rem; font-size: 0.95rem; }
      .data-table { min-width: 500px; }
      .gallery-grid { grid-template-columns: 1fr; }
      .admin-login { margin: 1.25rem auto; padding: 1.75rem; }
      .btn-aksi { padding: 0.5rem 0.7rem; font-size: 0.85rem; }
    }

    @media (max-width: 480px) {
      .menu-grid { grid-template-columns: 1fr; }
      .beranda-title { font-size: 1.85rem; }
      .beranda-subtitle { font-size: 1.1rem; margin-bottom: 2rem; }
      body { font-size: 1rem; }
      .form-group input, .form-group textarea, .form-group select { font-size: 16px; }
      .data-table { min-width: 380px; }
      .data-table th { font-size: 0.9rem; }
      .data-table td { font-size: 0.9rem; }
    }

    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
    }
  </style>
</head>
<body>
  <header class="header">
    <h1>üèòÔ∏è Pengabdian Masyarakat (Abdimas)</h1>
    <button type="button" class="back-btn" id="backBtn" aria-label="Kembali">‚Üê Kembali ke Beranda</button>
  </header>

  <main>
    <!-- BERANDA -->
    <section id="beranda">
      <h2 class="beranda-title">Selamat Datang</h2>
      <p class="beranda-subtitle">Sistem Informasi Pengabdian Masyarakat</p>
      <div class="menu-grid">
        <button type="button" class="menu-btn formulir" data-page="formulir">
          <span class="icon">üìã</span>
          <span>Formulir</span>
          <small style="color:var(--text-muted);font-weight:400;">Isi data kegiatan</small>
        </button>
        <button type="button" class="menu-btn dashboard" data-page="dashboard">
          <span class="icon">üìä</span>
          <span>Dashboard</span>
          <small style="color:var(--text-muted);font-weight:400;">Lihat statistik</small>
        </button>
        <button type="button" class="menu-btn galeri" data-page="galeri">
          <span class="icon">üñºÔ∏è</span>
          <span>Galeri</span>
          <small style="color:var(--text-muted);font-weight:400;">Foto dokumentasi</small>
        </button>
        <button type="button" class="menu-btn admin" data-page="admin">
          <span class="icon">‚öôÔ∏è</span>
          <span>Admin</span>
          <small style="color:var(--text-muted);font-weight:400;">Kelola data</small>
        </button>
      </div>
    </section>

    <!-- FORMULIR -->
    <section id="formulir" class="section">
      <div class="container">
        <h2 class="section-title">Formulir Kegiatan Pengabdian Masyarakat</h2>
        <div class="form-card">
          <form id="formAbdimas">
            <div class="form-group">
              <label for="tanggal_daftar">Tanggal Daftar *</label>
              <input type="date" id="tanggal_daftar" name="tanggal_daftar" required>
            </div>
            <div class="form-group">
              <label for="nama_kegiatan">Nama Kegiatan *</label>
              <input type="text" id="nama_kegiatan" name="nama_kegiatan" required placeholder="Contoh: Bakti Sosial Hari Kesehatan Nasional ke 62 Kutai Kartanegara">
            </div>
            <div class="form-group">
              <label for="tanggal_pelaksanaan">Tanggal Pelaksanaan *</label>
              <input type="date" id="tanggal_pelaksanaan" name="tanggal_pelaksanaan" required>
            </div>
            <div class="form-group">
              <label for="lokasi">Lokasi *</label>
              <input type="text" id="lokasi" name="lokasi" required placeholder="Contoh: Area Car Free Day Tenggarong">
            </div>
            <div class="form-group">
              <label for="jumlah_peserta">Jumlah Peserta</label>
              <input type="number" id="jumlah_peserta" name="jumlah_peserta" min="0" placeholder="Contoh: 300">
            </div>
            <div class="form-group">
              <label for="deskripsi_kegiatan">Deskripsi Kegiatan *</label>
              <textarea id="deskripsi_kegiatan" name="deskripsi_kegiatan" required placeholder="Jelaskan ringkasan kegiatan yang akan dilakukan..."></textarea>
            </div>
            <div class="form-group">
              <label for="penanggung_jawab">Penanggung Jawab *</label>
              <input type="text" id="penanggung_jawab" name="penanggung_jawab" required placeholder="Nama penanggung jawab (PIC)">
            </div>
            <div class="form-group">
              <label for="kontak">Kontak *</label>
              <input type="text" id="kontak" name="kontak" required placeholder="No. HP / Email">
            </div>
            <div class="form-group">
              <label for="surat_pemberitahuan">Upload Dokumen Surat Pemberitahuan Kegiatan (PDF)</label>
              <input type="file" id="surat_pemberitahuan" name="surat_pemberitahuan" accept=".pdf" aria-describedby="surat-hint">
              <span id="surat-hint" class="form-hint">Format: PDF. Diunggah ke Google Drive saat terhubung.</span>
            </div>
            <input type="hidden" name="file_url" id="form_file_url" value="">
            <input type="hidden" name="file_base64" id="form_file_base64" value="">
            <input type="hidden" name="file_name" id="form_file_name" value="">
            <input type="hidden" name="status" value="Pending">
            <button type="submit" class="btn-submit" id="btnSubmit">Kirim Pemberitahuan</button>
            <div id="formStatus" class="form-status"></div>
          </form>
        </div>
      </div>
    </section>

    <!-- DASHBOARD -->
    <section id="dashboard" class="section">
      <div class="container">
        <h2 class="section-title">Dashboard</h2>
        <div class="stats-grid">
          <div class="stat-card">
            <div class="value" id="totalKegiatan">0</div>
            <div class="label">Total Kegiatan</div>
          </div>
          <div class="stat-card">
            <div class="value" id="totalBulan">0</div>
            <div class="label">Bulan Ini</div>
          </div>
        </div>
        <div class="table-wrap">
          <table class="data-table">
            <thead>
              <tr>
                <th>Tanggal Daftar</th>
                <th>Nama Kegiatan</th>
                <th>Tanggal Pelaksanaan</th>
                <th>Lokasi</th>
                <th>Jumlah Peserta</th>
                <th>Penanggung Jawab</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="dashboardTableBody">
              <tr><td colspan="7" class="empty-state">Memuat data dari Google Sheet...</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <!-- GALERI -->
    <section id="galeri" class="section">
      <div class="container">
        <h2 class="section-title">Galeri Dokumentasi</h2>
        <div class="gallery-grid" id="galleryGrid">
          <div class="gallery-item">
            <div class="gallery-placeholder">Galeri dari Google Drive</div>
            <span class="caption">Data gambar dari Drive akan tampil di sini</span>
          </div>
        </div>
      </div>
    </section>

    <!-- ADMIN -->
    <section id="admin" class="section">
      <div class="container">
        <h2 class="section-title">Panel Admin</h2>
        <div id="adminLogin" class="admin-login">
          <div class="form-group">
            <label for="adminPass">Password Admin</label>
            <input type="password" id="adminPass" placeholder="Masukkan password">
          </div>
          <button type="button" class="btn-submit" id="btnAdminLogin">Masuk</button>
        </div>
        <div id="adminPanel" class="admin-panel">
          <div class="admin-actions">
            <button type="button" class="btn-logout" id="btnLogout">Keluar</button>
          </div>
          <div class="table-wrap">
            <table class="data-table">
              <thead>
                <tr>
                  <th>Timestamp</th>
                  <th>Tanggal Daftar</th>
                  <th>ID</th>
                  <th>Nama Kegiatan</th>
                  <th>Tanggal Pelaksanaan</th>
                  <th>Lokasi</th>
                  <th>Jumlah Peserta</th>
                  <th>Penanggung Jawab</th>
                  <th>Kontak</th>
                  <th>Surat PDF</th>
                  <th>Status</th>
                  <th>Aksi</th>
                </tr>
              </thead>
              <tbody id="adminTableBody">
                <tr><td colspan="12" class="empty-state">Login untuk melihat data.</td></tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </section>
  </main>

  <script>
    // ========== KONFIGURASI GOOGLE SHEET & DRIVE ==========
    // Ganti dengan URL Web App Google Apps Script Anda setelah deploy
    const CONFIG = {
      webAppUrl: 'https://script.google.com/macros/s/AKfycbyPRksqB7X0sWiUXRC-NBlY7LED0mIxpFf0mb4-Fd1jWeg_eBg6c5m5ahDji3eqDw4ptQ/exec', // Contoh: https://script.google.com/macros/s/xxx/exec
      adminPassword: 'abdimas2025' // Ganti dengan password aman
    };

    // ========== NAVIGASI ==========
    const beranda = document.getElementById('beranda');
    const sections = document.querySelectorAll('.section');
    const backBtn = document.getElementById('backBtn');

    function showPage(pageId) {
      beranda.classList.add('hidden');
      sections.forEach(s => {
        s.classList.toggle('active', s.id === pageId);
      });
      backBtn.classList.add('visible');
      if (pageId === 'dashboard') loadDashboard();
      if (pageId === 'galeri') loadGaleri();
      if (pageId === 'admin') loadAdminState();
    }

    function showBeranda() {
      beranda.classList.remove('hidden');
      sections.forEach(s => s.classList.remove('active'));
      backBtn.classList.remove('visible');
    }

    document.querySelectorAll('.menu-btn').forEach(btn => {
      btn.addEventListener('click', () => showPage(btn.dataset.page));
    });
    backBtn.addEventListener('click', showBeranda);

    // Isi otomatis Tanggal Daftar = hari ini
    (function setDefaultTanggalDaftar() {
      const input = document.getElementById('tanggal_daftar');
      if (input && !input.value) {
        const today = new Date().toISOString().slice(0, 10);
        input.value = today;
      }
    })();

    // ========== FORMULIR ‚Üí GOOGLE SHEET & DRIVE ==========
    const form = document.getElementById('formAbdimas');
    const formStatus = document.getElementById('formStatus');
    const btnSubmit = document.getElementById('btnSubmit');

    form.addEventListener('submit', async (e) => {
      e.preventDefault();
      btnSubmit.disabled = true;
      formStatus.className = 'form-status';
      formStatus.textContent = 'Mengirim...';

      const formData = new FormData(form);
      const payload = {
        tanggal_daftar: formData.get('tanggal_daftar'),
        nama_kegiatan: formData.get('nama_kegiatan'),
        tanggal_pelaksanaan: formData.get('tanggal_pelaksanaan'),
        lokasi: formData.get('lokasi'),
        jumlah_peserta: formData.get('jumlah_peserta') || '',
        deskripsi_kegiatan: formData.get('deskripsi_kegiatan'),
        penanggung_jawab: formData.get('penanggung_jawab'),
        kontak: formData.get('kontak'),
        file_url: formData.get('file_url') || '',
        status: formData.get('status') || 'Pending'
      };

      // Jika Web App URL belum diisi, simpan ke localStorage (demo)
      if (!CONFIG.webAppUrl || CONFIG.webAppUrl.startsWith('GANTI')) {
        const simpanan = JSON.parse(localStorage.getItem('abdimas_data') || '[]');
        const id = 'ABD-' + Date.now();
        const timestamp = new Date().toISOString();
        simpanan.push({ ...payload, id, timestamp });
        localStorage.setItem('abdimas_data', JSON.stringify(simpanan));
        formStatus.className = 'form-status success';
        formStatus.textContent = 'Data tersimpan secara lokal. Pasang URL Google Apps Script di CONFIG.webAppUrl untuk kirim ke Sheet & Drive.';
        form.reset();
        btnSubmit.disabled = false;
        return;
      }

      // Jika ada file PDF, baca sebagai base64 dan kirim lewat form (satu request ke GAS ‚Üí simpan ke Drive)
      const fileInput = document.getElementById('surat_pemberitahuan');
      const formFileBase64 = document.getElementById('form_file_base64');
      const formFileName = document.getElementById('form_file_name');
      if (fileInput.files.length && fileInput.files[0]) {
        formStatus.textContent = 'Menyiapkan PDF...';
        try {
          const file = fileInput.files[0];
          const base64 = await new Promise((resolve, reject) => {
            const r = new FileReader();
            r.onload = () => {
              const s = r.result;
              resolve(s.indexOf('base64,') >= 0 ? s.split('base64,')[1] : s);
            };
            r.onerror = reject;
            r.readAsDataURL(file);
          });
          // Encode agar aman di form POST: + dan / diganti supaya tidak rusak oleh URL encoding
          const base64Safe = base64.replace(/\+/g, '.').replace(/\//g, '-');
          formFileBase64.value = base64Safe;
          formFileName.value = file.name || 'surat_pemberitahuan.pdf';
        } catch (err) {
          formStatus.className = 'form-status error';
          formStatus.textContent = 'Gagal membaca file PDF.';
          btnSubmit.disabled = false;
          return;
        }
      } else {
        formFileBase64.value = '';
        formFileName.value = '';
      }

      formStatus.textContent = 'Mengirim data dan PDF ke Google Sheet & Drive...';
      form.setAttribute('action', CONFIG.webAppUrl);
      form.setAttribute('method', 'post');
      const iframe = document.createElement('iframe');
      iframe.name = 'abdimas-iframe';
      iframe.style.display = 'none';
      document.body.appendChild(iframe);
      form.setAttribute('target', 'abdimas-iframe');
      form.submit();
      setTimeout(() => {
        form.removeAttribute('action');
        form.removeAttribute('method');
        form.removeAttribute('target');
        iframe.remove();
        formStatus.className = 'form-status success';
        formStatus.textContent = 'Data dan dokumen PDF berhasil dikirim ke Google Sheet & Drive.';
        form.reset();
        formFileBase64.value = '';
        formFileName.value = '';
        document.getElementById('form_file_url').value = '';
        btnSubmit.disabled = false;
      }, 2000);
    });

    // ========== DASHBOARD (baca dari Sheet / localStorage) ==========
    function loadDashboard() {
      const tbody = document.getElementById('dashboardTableBody');
      if (CONFIG.webAppUrl && !CONFIG.webAppUrl.startsWith('GANTI')) {
        fetch(CONFIG.webAppUrl + '?action=getData')
          .then(r => r.json())
          .then(data => {
            const rows = (data.rows || []).filter(r => r.status !== 'Dihapus');
            renderDashboardTable(tbody, rows);
            document.getElementById('totalKegiatan').textContent = rows.length;
            const thisMonth = new Date().getMonth();
            const bulanIni = rows.filter(r => new Date(r.tanggal_daftar || r.tanggal_pelaksanaan).getMonth() === thisMonth).length;
            document.getElementById('totalBulan').textContent = bulanIni;
          })
          .catch(() => {
            const local = (JSON.parse(localStorage.getItem('abdimas_data') || '[]')).filter(r => r.status !== 'Dihapus');
            renderDashboardTable(tbody, local);
            document.getElementById('totalKegiatan').textContent = local.length;
            const thisMonth = new Date().getMonth();
            const bulanIni = local.filter(r => new Date(r.tanggal_daftar || r.tanggal_pelaksanaan).getMonth() === thisMonth).length;
            document.getElementById('totalBulan').textContent = bulanIni;
          });
      } else {
        const local = (JSON.parse(localStorage.getItem('abdimas_data') || '[]')).filter(r => r.status !== 'Dihapus');
        renderDashboardTable(tbody, local);
        document.getElementById('totalKegiatan').textContent = local.length;
        const thisMonth = new Date().getMonth();
        const bulanIni = local.filter(r => new Date(r.tanggal_daftar || r.tanggal_pelaksanaan).getMonth() === thisMonth).length;
        document.getElementById('totalBulan').textContent = bulanIni;
      }
    }

    function renderDashboardTable(tbody, rows) {
      if (!rows.length) {
        tbody.innerHTML = '<tr><td colspan="7" class="empty-state">Belum ada data.</td></tr>';
        return;
      }
      tbody.innerHTML = rows.map(r => `
        <tr>
          <td>${formatDate(r.tanggal_daftar)}</td>
          <td>${escapeHtml(r.nama_kegiatan)}</td>
          <td>${formatDate(r.tanggal_pelaksanaan)}</td>
          <td>${escapeHtml(r.lokasi)}</td>
          <td>${escapeHtml(r.jumlah_peserta)}</td>
          <td>${escapeHtml(r.penanggung_jawab)}</td>
          <td>${escapeHtml(r.status)}</td>
        </tr>
      `).join('');
    }

    // ========== GALERI (dari Drive / placeholder) ==========
    function loadGaleri() {
      const grid = document.getElementById('galleryGrid');
      if (CONFIG.webAppUrl && !CONFIG.webAppUrl.startsWith('GANTI')) {
        fetch(CONFIG.webAppUrl + '?action=getGallery')
          .then(r => r.json())
          .then(data => {
            renderGaleri(grid, data.items || []);
          })
          .catch(() => renderGaleri(grid, []));
      } else {
        renderGaleri(grid, []);
      }
    }

    function renderGaleri(grid, items) {
      if (!items.length) {
        grid.innerHTML = `
          <div class="gallery-item">
            <div class="gallery-placeholder">Galeri dari Google Drive</div>
            <span class="caption">Sambungkan Web App untuk menampilkan foto dari Drive</span>
          </div>`;
        return;
      }
      grid.innerHTML = items.map(item => `
        <div class="gallery-item">
          <img src="${escapeHtml(item.url)}" alt="${escapeHtml(item.caption || '')}" loading="lazy">
          <span class="caption">${escapeHtml(item.caption || 'Dokumentasi')}</span>
        </div>
      `).join('');
    }

    // ========== ADMIN ==========
    const adminLogin = document.getElementById('adminLogin');
    const adminPanel = document.getElementById('adminPanel');
    const adminTableBody = document.getElementById('adminTableBody');

    function loadAdminState() {
      if (sessionStorage.getItem('abdimas_admin') === '1') {
        adminLogin.classList.add('hidden');
        adminPanel.classList.add('visible');
        loadAdminTable();
      } else {
        adminLogin.classList.remove('hidden');
        adminPanel.classList.remove('visible');
      }
    }

    document.getElementById('btnAdminLogin').addEventListener('click', () => {
      if (document.getElementById('adminPass').value === CONFIG.adminPassword) {
        sessionStorage.setItem('abdimas_admin', '1');
        loadAdminState();
      } else {
        alert('Password salah.');
      }
    });

    document.getElementById('btnLogout').addEventListener('click', () => {
      sessionStorage.removeItem('abdimas_admin');
      loadAdminState();
    });

    function renderAdminTable(rows) {
      if (!rows.length) {
        adminTableBody.innerHTML = '<tr><td colspan="12" class="empty-state">Belum ada data.</td></tr>';
        return;
      }
      adminTableBody.innerHTML = rows.map(r => `
        <tr data-id="${escapeHtml(r.id || '')}">
          <td>${escapeHtml(r.timestamp != null ? (typeof r.timestamp === 'string' ? r.timestamp : formatDate(r.timestamp)) : '-')}</td>
          <td>${formatDate(r.tanggal_daftar)}</td>
          <td>${escapeHtml(r.id || '-')}</td>
          <td>${escapeHtml(r.nama_kegiatan)}</td>
          <td>${formatDate(r.tanggal_pelaksanaan)}</td>
          <td>${escapeHtml(r.lokasi)}</td>
          <td>${escapeHtml(r.jumlah_peserta)}</td>
          <td>${escapeHtml(r.penanggung_jawab)}</td>
          <td>${escapeHtml(r.kontak)}</td>
          <td>${r.file_url ? '<a href="' + escapeHtml(r.file_url) + '" target="_blank" rel="noopener">PDF</a>' : '-'}</td>
          <td>${escapeHtml(r.status)}</td>
          <td class="aksi-wrap">
            <button type="button" class="btn-aksi hapus" data-action="delete" title="Hapus">Hapus</button>
            <button type="button" class="btn-aksi tolak" data-action="Ditolak" title="Tolak">Tolak</button>
            <button type="button" class="btn-aksi diterima" data-action="Diterima" title="Diterima">Diterima</button>
          </td>
        </tr>
      `).join('');
      adminTableBody.querySelectorAll('.btn-aksi').forEach(btn => {
        btn.addEventListener('click', () => {
          const tr = btn.closest('tr');
          const id = tr.getAttribute('data-id');
          const action = btn.getAttribute('data-action');
          if (!id) return;
          if (action === 'delete') adminAksiDelete(id);
          else adminAksiUpdateStatus(id, action);
        });
      });
    }

    function adminAksiDelete(id) {
      if (!confirm('Yakin ingin menghapus data ini?')) return;
      if (CONFIG.webAppUrl && !CONFIG.webAppUrl.startsWith('GANTI')) {
        fetch(CONFIG.webAppUrl + '?action=delete&id=' + encodeURIComponent(id))
          .then(r => r.json())
          .then(() => loadAdminTable())
          .catch(() => {});
      } else {
        const local = JSON.parse(localStorage.getItem('abdimas_data') || '[]').filter(r => r.id !== id);
        localStorage.setItem('abdimas_data', JSON.stringify(local));
        loadAdminTable();
      }
    }

    function adminAksiUpdateStatus(id, status) {
      if (CONFIG.webAppUrl && !CONFIG.webAppUrl.startsWith('GANTI')) {
        fetch(CONFIG.webAppUrl + '?action=updateStatus&id=' + encodeURIComponent(id) + '&status=' + encodeURIComponent(status))
          .then(r => r.json())
          .then(() => loadAdminTable())
          .catch(() => {});
      } else {
        const local = JSON.parse(localStorage.getItem('abdimas_data') || '[]');
        const row = local.find(r => r.id === id);
        if (row) { row.status = status; localStorage.setItem('abdimas_data', JSON.stringify(local)); }
        loadAdminTable();
      }
    }

    function loadAdminTable() {
      if (CONFIG.webAppUrl && !CONFIG.webAppUrl.startsWith('GANTI')) {
        fetch(CONFIG.webAppUrl + '?action=getData')
          .then(r => r.json())
          .then(data => renderAdminTable(data.rows || []))
          .catch(() => {
            const local = JSON.parse(localStorage.getItem('abdimas_data') || '[]');
            renderAdminTable(local);
          });
      } else {
        const local = JSON.parse(localStorage.getItem('abdimas_data') || '[]');
        renderAdminTable(local);
      }
    }

    function formatDate(str) {
      if (!str) return '-';
      const d = new Date(str);
      return isNaN(d.getTime()) ? str : d.toLocaleDateString('id-ID');
    }
    function escapeHtml(s) {
      if (s == null) return '';
      const div = document.createElement('div');
      div.textContent = s;
      return div.innerHTML;
    }
  </script>
</body>
</html>
